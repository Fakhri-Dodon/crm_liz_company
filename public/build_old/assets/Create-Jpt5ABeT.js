import{r as m,j as t}from"./app--V8YQuQk.js";import{_ as H}from"./grapes-custom-Cs4ESRgt.js";const R=["H1","H2","H3","H4","H5","H6","P","SPAN","LI","LABEL","DIV","STRONG","B","EM","I","SMALL"],p={text:["color","font-size","background-color","font-family","font-weight"],btn:["font-weight","font-size","background-color","color"],link:["font-weight","font-size","text-transform","color","text-decoration"],img:["border-top-left-radius","border-top-right-radius","border-bottom-left-radius","border-bottom-right-radius","border-color","border-style","border-width"],icon:["color","font-size"]};function O({id:P,template:u}){const[U,x]=m.useState(!1),g=m.useRef(null),b=m.useRef("elements"),[k,L]=m.useState([]),[E,B]=m.useState("All Blocks"),[w,N]=m.useState(!1),[A,h]=m.useState(!1),[j,M]=m.useState("elements"),_=e=>{const n=e.getEl();if(!n)return{styles:[],traits:[]};const a=e.get("tagName")?.toUpperCase(),r=e.getClasses();e.get("type");const s=n.closest("nav")!==null||n.closest(".navbar")!==null,l=n.closest("footer")!==null,o=r.includes("btn")||r.includes("btn-nav"),i=a==="I"||r.some(c=>c.startsWith("fa-")||c==="fa");return a==="IMG"&&s?{title:"Image Navigation",styles:p.img,traits:[{type:"text",name:"src",label:"Image Source"},{type:"text",name:"href",label:"Link URL"},{type:"select",name:"target",label:"Target",options:[{value:"",name:"Same Tab"},{value:"_blank",name:"New Tab"}]}]}:a==="A"&&!o&&s?{title:"Nav Link",styles:p.link,traits:[{type:"text",name:"href",label:"Link URL"},{type:"text",name:"content",label:"Text"}]}:a==="A"&&o&&s?{title:"Nav Button",styles:p.btn,traits:[{type:"text",name:"href",label:"Link URL"},{type:"text",name:"class",label:"Classes"}]}:["H1","H2","H3","H4","H5","H6","P","SPAN","STRONG","B","EM","SMALL","DIV","LI"].includes(a)&&!o&&!i&&!e.find("*").some(d=>d.get("type")==="default"||d.get("tagName")==="DIV")?{title:"Typography",styles:p.text,traits:[]}:o&&!s?{title:"Button Component",styles:p.btn,traits:[{type:"text",name:"href",label:"Link URL"},{type:"select",name:"target",label:"Target",options:[{value:"",name:"Same Tab"},{value:"_blank",name:"New Tab"}]}]}:a==="IMG"&&!s?{title:"Image Component",styles:p.img,traits:[{type:"text",name:"src",label:"Image Source"},{type:"text",name:"alt",label:"Alt Text"}]}:i?{title:l?"Footer Icon":"Icon Component",styles:p.icon,traits:[{type:"text",name:"href",label:"Link URL"},{type:"text",name:"class",label:"Icon Class (fa fa-xxx)"}]}:{title:"Element Settings",styles:["padding","margin","background-color","height"],traits:[]}};m.useEffect(()=>{x(!0);const e=H.init({container:"#gjs",height:"100%",width:"100%",storageManager:!1,allowScripts:1,avoidInlineStyle:!0,forceClass:!1,selectable:!0,blockManager:{appendTo:"#second-side"},traitManager:{appendTo:"#trait-editor-container"},styleManager:{appendTo:"#style-manager-container",clearProperties:!0,sectors:[{name:"Typography",open:!1,buildProps:["font-family","font-size","font-weight","color","text-align","text-transform","line-height","letter-spacing"]},{name:"Decorations",open:!1,buildProps:["background-color","border-radius","border-top-left-radius","border-top-right-radius","border-bottom-left-radius","border-bottom-right-radius","box-shadow","background-image"]},{name:"Dimensions",open:!1,buildProps:["width","height","min-height","padding","margin","padding-top","padding-bottom","padding-left","padding-right"]},{name:"Borders",open:!1,buildProps:["border-width","border-style","border-color"]}]},panels:{defaults:[]},canvas:{styles:["/templates/css/plugins/bootstrap.min.css","/templates/css/style.css"]}});return e.DomComponents.getType("default").model,e.DomComponents.addType("image",{model:{defaults:{traits:[]}}}),g.current=e,e.on("load",()=>{const a=e.Canvas.getDocument().head,r="mode-content-style";if(!a.querySelector(`#${r}`)){const s=document.createElement("style");s.id=r,s.innerHTML=`
                    .mode-content-active * { pointer-events: none !important; cursor: default !important; }
                    .mode-content-active [contenteditable="true"], 
                    .mode-content-active [data-gjs-type="text"],
                    .mode-content-active h1, .mode-content-active h2, .mode-content-active h3, 
                    .mode-content-active h4, .mode-content-active h5, .mode-content-active h6, 
                    .mode-content-active p, .mode-content-active span, .mode-content-active a, 
                    .mode-content-active li, .mode-content-active b, .mode-content-active strong, 
                    .mode-content-active i, .mode-content-active small { 
                        pointer-events: auto !important; cursor: text !important; outline: 2px dashed #4cd137 !important; 
                    }
                    .gjs-rte-toolbar, .gjs-rte-toolbar * { pointer-events: auto !important; }
                `,a.appendChild(s)}fetch("/api/proposal/templates").then(s=>s.json()).then(s=>{const l=["All Blocks",...new Set(s.map(o=>o.category))];L(l),s.forEach((o,i)=>{e.BlockManager.add(`template-${i}`,{category:o.category||"Templates",media:`<img src="${o.preview}" style="width: 100%;" />`,content:{content:o.html,style:o.css}})})}).finally(()=>x(!1)),u&&(u.html_output&&e.setComponents(u.html_output),u.css_output&&e.setStyle(u.css_output)),setTimeout(()=>C("elements"),500)}),e.on("component:selected",a=>{if(!a)return;if(b.current==="details"){const s=document.getElementById("style-editor-container"),l=document.getElementById("sidebar-title-text");s&&s.classList.add("open");const o=_(a);l&&(l.innerText=o.title),a.set("traits",o.traits),e.StyleManager.getSectors().forEach(c=>{let d=!1;c.get("properties").forEach(S=>{const y=S.get("property"),I=o.styles.some(v=>!!(v===y||v==="padding"&&y.startsWith("padding")||v==="margin"&&y.startsWith("margin")));S.set("visible",I),I&&(d=!0)}),c.set("visible",d),c.set("open",d)})}}),e.on("component:deselected",()=>{const a=document.getElementById("style-editor-container");a&&a.classList.remove("open")}),e.on("component:add",a=>{setTimeout(()=>T(a,b.current),10)}),()=>e.destroy()},[]);const T=(e,n)=>{if(!e||typeof e.get!="function")return;const a=e.get("tagName")?.toUpperCase(),r=e.get("type"),s=r==="wrapper",l=R.includes(a)||r==="text"||r==="textnode",o=e.find("*").some(d=>d.get("type")==="default"||d.get("tagName")==="DIV"),i=l&&!o;let f={};const c=e.getView();c?.el&&c.el.removeAttribute("contenteditable"),n==="elements"?f={draggable:!s,droppable:!0,selectable:!0,hoverable:!0,editable:!0,highlightable:!0,toolbar:void 0}:n==="content"?f={draggable:!1,droppable:!1,removable:!1,copyable:!1,selectable:i,hoverable:i,editable:i,highlightable:i,toolbar:[]}:n==="details"&&(f={draggable:!1,droppable:!1,removable:!1,copyable:!1,selectable:!0,hoverable:!0,editable:!1,highlightable:!0,toolbar:[],stylable:!0}),e.set(f)},C=e=>{M(e),b.current=e;const n=g.current;if(!n)return;const a=document.getElementById("style-editor-container");a&&a.classList.remove("open"),n.select(null);const r=n.Canvas.getBody();r&&(e==="content"?(r.classList.add("mode-content-active"),n.stopCommand("core:component-outline")):(r.classList.remove("mode-content-active"),e==="elements"&&n.runCommand("core:component-outline")));const s=n.getWrapper();if(s){const l=o=>{T(o,e);const i=o.get("components");i&&i.forEach(f=>l(f))};e==="content"?s.set({selectable:!1,hoverable:!1,droppable:!1}):s.set({droppable:!0}),s.get("components").forEach(o=>l(o))}n.refresh()},D=e=>{h(!0),B(e),setTimeout(()=>{if(!g.current)return;const n=g.current.BlockManager,a=n.getAll();e==="All Blocks"?n.render(a.models):n.render(a.filter(r=>{const s=r.get("category");return(s.id||s)===e}))},50)};return t.jsxs("div",{className:`builder-body ${w?"sidebar-expanded":"sidebar-collapsed"}`,children:[t.jsxs("div",{className:"menu-left",onMouseEnter:()=>N(!0),onMouseLeave:()=>{N(!1),h(!1)},style:{zIndex:1e3},children:[t.jsx("div",{className:"icon-trigger-area",children:t.jsx("i",{className:"fa fa-th-large fa-lg"})}),t.jsxs("div",{className:"main-nav",children:[t.jsxs("h3",{children:[t.jsx("i",{className:"fa fa-th-large"})," BLOCKS"]}),t.jsx("ul",{className:"elements-list",children:k.map(e=>t.jsx("li",{className:E===e?"active":"",children:t.jsx("a",{href:"#",onClick:n=>{n.preventDefault(),D(e)},children:e})},e))})]}),t.jsx("div",{className:`second-side ${A?"show":""}`,id:"second-side",children:t.jsxs("div",{className:"second-side-header",onClick:()=>h(!1),children:[t.jsx("i",{className:"fa fa-chevron-left"})," HIDE"]})})]}),t.jsxs("div",{className:"container-main",children:[t.jsx("header",{className:"builder-header",children:t.jsxs("div",{className:"modes",children:[t.jsx("span",{className:"mode-label",children:"BUILDING MODE:"}),["elements","content","details"].map(e=>t.jsxs("button",{className:`mode-btn ${j===e?"active":""}`,onClick:()=>C(e),children:[t.jsx("i",{className:j===e?"far fa-dot-circle":"far fa-circle"})," ",e.charAt(0).toUpperCase()+e.slice(1)]},e))]})}),t.jsx("div",{className:"screen-area",children:t.jsxs("div",{className:"screen",id:"screen",children:[t.jsxs("div",{className:"toolbar",children:[t.jsxs("div",{className:"buttons clearfix",children:[t.jsx("span",{className:"left red"}),t.jsx("span",{className:"left yellow"}),t.jsx("span",{className:"left green"})]}),t.jsx("div",{className:"title",children:t.jsx("span",{children:"index.html"})})]}),t.jsxs("div",{id:"frameWrapper",className:"frameWrapper empty",children:[t.jsxs("div",{id:"style-editor-container",className:"style-sidebar-left",children:[t.jsxs("div",{className:"sidebar-header-custom",children:[t.jsx("span",{id:"sidebar-title-text",children:"SETTINGS"}),t.jsx("button",{onClick:()=>document.getElementById("style-editor-container").classList.remove("open"),style:{background:"none",border:"none",color:"white"},children:t.jsx("i",{className:"fa fa-times"})})]}),t.jsx("div",{id:"trait-editor-container",className:"sidebar-section"}),t.jsx("div",{id:"style-manager-container",className:"sidebar-section"})]}),t.jsx("div",{id:"gjs",style:{position:"relative",zIndex:10}}),t.jsx("div",{className:"start",id:"start",children:t.jsx("span",{children:"Build your page by dragging elements onto the canvas"})})]})]})})]})]})}export{O as default};
