import{r as u,u as L,b as $,j as e,c as N}from"./app-BTbkV42h.js";import{F as b}from"./file-text-DZzzDjT5.js";import{X as z}from"./x-bUU7PHNQ.js";import{L as F}from"./loader-circle-DvkhTUhf.js";import{B as A}from"./building-CPZWQ5XQ.js";import{C as _}from"./chevron-down-BBjuMcoq.js";import{C as B}from"./calendar-BTlTyD--.js";import{C as M}from"./clock-DbhAJd2o.js";import{c as O}from"./createLucideIcon-DHxmSlVR.js";const U=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],H=O("message-square",U),Y=({show:i,onClose:g,projectId:c,companies:j,quotations:f,statusOptions:w,isEdit:l=!1,title:C="Add Project"})=>{const[d,y]=u.useState(!1),[Q,v]=u.useState(null),{data:o,setData:n,post:S,put:k,processing:a,errors:s,reset:m}=L({quotation_id:"",company_id:"",project_description:"",start_date:"",deadline:"",note:"",status:"in_progress"});u.useEffect(()=>{i&&l&&c&&q()},[i,l,c]),u.useEffect(()=>{i&&!l&&x()},[i,l]);const q=async()=>{y(!0);try{const t=(await $.get(`/projects/${c}/edit`)).data;v(t);const p={quotation_id:t.quotation_id||"",company_id:t.company_id||"",project_description:t.project_description||"",start_date:t.start_date||"",deadline:t.deadline||"",note:t.note||"",status:t.status||"in_progress"};n(p)}catch(r){console.error("Error fetching project data:",r),r.response?.status===404&&(alert("Project not found. It may have been deleted."),h())}finally{y(!1)}},x=()=>{m({quotation_id:"",company_id:"",project_description:"",start_date:"",deadline:"",note:"",status:"in_progress"}),v(null)},D=w?.filter(r=>["in_progress","completed","pending","cancelled"].includes(r.value))||[],P=r=>{r.preventDefault(),l&&c?k(route("projects.update",c),{preserveScroll:!0,preserveState:!0,onSuccess:()=>{m(),x(),g(),N.reload({only:["projects","summary","filters"],preserveScroll:!0})},onError:t=>{console.error("Update errors:",t)}}):S(route("projects.store"),{preserveScroll:!0,preserveState:!0,onSuccess:()=>{x(),m(),g(),N.reload({only:["projects","summary","filters"],preserveScroll:!0})},onError:t=>{console.error("Store errors:",t)}})},h=()=>{x(),m(),g()};return i?e.jsx("div",{className:"fixed inset-0 bg-gray-900/50 backdrop-blur-sm overflow-y-auto h-full w-full z-50",children:e.jsx("div",{className:"relative min-h-screen flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-[#005954]/10 rounded-lg",children:e.jsx(b,{className:"w-6 h-6 text-[#005954]"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:C}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:l?"Update project details":"Create a new project"})]})]}),e.jsx("button",{onClick:h,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",disabled:a||d,children:e.jsx(z,{className:"w-5 h-5"})})]}),d&&l?e.jsxs("div",{className:"p-12 flex flex-col items-center justify-center",children:[e.jsx(F,{className:"w-8 h-8 text-[#005954] animate-spin mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading project data..."})]}):e.jsxs("form",{onSubmit:P,className:"p-6 space-y-6 max-h-[70vh] overflow-y-auto",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center gap-2",children:[e.jsx(b,{className:"w-4 h-4"}),"Project Description *"]}),e.jsxs("div",{className:"relative",children:[e.jsx("textarea",{value:o.project_description,onChange:r=>n("project_description",r.target.value),className:`w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-[#005954] focus:border-transparent min-h-[100px] resize-none transition-colors ${s.project_description?"border-red-300":"border-gray-300"}`,maxLength:250,required:!0,placeholder:"Describe the project scope and objectives...",disabled:a}),e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[s.project_description?e.jsx("p",{className:"text-sm text-red-600",children:s.project_description}):e.jsx("div",{className:"text-xs text-gray-400",children:"Brief and descriptive (max 250 characters)"}),e.jsxs("div",{className:"text-xs text-gray-500",children:[o.project_description?.length||0,"/250"]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center gap-2",children:[e.jsx(A,{className:"w-4 h-4"}),"Company *"]}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:o.company_id,onChange:r=>n("company_id",r.target.value),className:`w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-[#005954] focus:border-transparent appearance-none transition-colors ${s.company_id?"border-red-300":"border-gray-300"}`,required:!0,disabled:a,children:[e.jsx("option",{value:"",className:"text-gray-400",children:"Select a company"}),j&&j.map(r=>e.jsx("option",{value:r.id,children:r.name},r.id))]}),e.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700",children:e.jsx(_,{className:"w-4 h-4"})})]}),s.company_id&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:s.company_id})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center gap-2",children:[e.jsx(b,{className:"w-4 h-4"}),"Quotation (Optional)"]}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:o.quotation_id,onChange:r=>n("quotation_id",r.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-[#005954] focus:border-transparent appearance-none transition-colors",disabled:a,children:[e.jsx("option",{value:"",className:"text-gray-400",children:"Select a quotation"}),f&&f.map(r=>e.jsx("option",{value:r.id,children:r.name},r.id))]}),e.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700",children:e.jsx(_,{className:"w-4 h-4"})})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center gap-2",children:[e.jsx(B,{className:"w-4 h-4"}),"Start Date *"]}),e.jsx("input",{type:"date",value:o.start_date,onChange:r=>n("start_date",r.target.value),className:`w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-[#005954] focus:border-transparent transition-colors ${s.start_date?"border-red-300":"border-gray-300"}`,required:!0,disabled:a}),s.start_date&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:s.start_date})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center gap-2",children:[e.jsx(M,{className:"w-4 h-4"}),"Deadline *"]}),e.jsx("input",{type:"date",value:o.deadline,onChange:r=>n("deadline",r.target.value),min:o.start_date,className:`w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-[#005954] focus:border-transparent transition-colors ${s.deadline?"border-red-300":"border-gray-300"}`,required:!0,disabled:a}),s.deadline&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:s.deadline})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status *"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:D.map(r=>{const p={in_progress:"bg-blue-50 text-blue-700 border-blue-200",completed:"bg-green-50 text-green-700 border-green-200",pending:"bg-yellow-50 text-yellow-700 border-yellow-200",cancelled:"bg-red-50 text-red-700 border-red-200"}[r.value]||"bg-gray-50 text-gray-700 border-gray-200";return e.jsx("button",{type:"button",onClick:()=>n("status",r.value),className:`p-3 border rounded-lg text-sm font-medium transition-all ${o.status===r.value?`${p} ring-2 ring-offset-1 ring-[#005954]`:`${p} hover:opacity-90`}`,disabled:a,children:r.label},r.value)})}),s.status&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:s.status})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center gap-2",children:[e.jsx(H,{className:"w-4 h-4"}),"Note (Optional)"]}),e.jsx("textarea",{value:o.note,onChange:r=>n("note",r.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-[#005954] focus:border-transparent min-h-[100px] resize-none transition-colors",maxLength:250,placeholder:"Additional notes or requirements...",disabled:a}),e.jsxs("div",{className:"text-right text-xs text-gray-500 mt-2",children:[o.note?.length||0,"/250 characters"]})]})]}),e.jsxs("div",{className:"flex flex-col-reverse sm:flex-row gap-3 pt-6 border-t border-gray-100",children:[e.jsx("button",{type:"button",onClick:h,className:"px-6 py-3 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50 transition-colors font-medium flex-1",disabled:a||d,children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-6 py-3 bg-[#005954] text-white rounded-xl hover:bg-[#004d47] transition-colors font-medium flex-1 disabled:opacity-50 disabled:cursor-not-allowed shadow-sm hover:shadow-md",disabled:a||d,children:a||d?e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),d?"Loading...":"Processing..."]}):l?"Update Project":"Create Project"})]})]})]})})}):null};export{Y as P};
