import{r as N,j as e}from"./app-Dyd-VK-i.js";import{u as k}from"./useTranslation-C1duoCZq.js";import{B as P}from"./building-2-BjbEIYrJ.js";import{M}from"./map-pin-CstW7RZX.js";import{G as C}from"./globe-36e_mGF8.js";import{M as L}from"./mail-BkQVmhWp.js";import{P as T}from"./phone-BFp8ONkp.js";import{I as $}from"./info-DDaJRL86.js";import"./createLucideIcon-CMta4jpe.js";const Y=({company:a,activeTab:h,data:t,statistics:o})=>{const[i,m]=N.useState(null),{t:s}=k(),g=(()=>{switch(h){case"profile":return[{label:s("companies_header.total_contacts"),value:t.contacts?.length||0,color:"bg-blue-500"},{label:s("companies_header.active_years"),value:a.client_since?new Date().getFullYear()-new Date(a.client_since).getFullYear():0,color:"bg-green-500"},{label:s("companies_header.status"),value:a.is_active?s("companies_header.active_status"):s("companies_header.inactive_status"),color:a.is_active?"bg-yellow-500":"bg-gray-500"},{label:s("companies_header.client_type"),value:a.client_type?.name||"N/A",color:"bg-red-500"}];case"quotation":return[{label:s("companies_header.total_quotations"),value:o.total_quotations||0,color:"bg-blue-500"},{label:s("companies_header.accepted"),value:o.accepted_quotations||0,color:"bg-green-500"},{label:s("companies_header.expired"),value:o.expired_quotations||0,color:"bg-yellow-500"},{label:s("companies_header.cancelled"),value:o.cancelled_quotations||0,color:"bg-red-500"}];case"invoice":return[{label:s("companies_header.total_invoices"),value:o.total_invoices||0,color:"bg-blue-500"},{label:s("companies_header.paid"),value:o.paid_invoices||0,color:"bg-green-500"},{label:s("companies_header.pending"),value:o.pending_invoices||0,color:"bg-yellow-500"},{label:s("companies_header.overdue"),value:o.overdue_invoices||0,color:"bg-red-500"}];case"payment":const l=t.payments?.length||0,n=t.payments?.filter(r=>r.method==="bank_transfer").length||0,c=t.payments?.filter(r=>r.method==="cash").length||0,p=t.payments?.filter(r=>r.method==="check").length||0;return[{label:s("companies_header.total_payments"),value:l,color:"bg-blue-500"},{label:s("companies_header.bank_transfer"),value:n,color:"bg-green-500"},{label:s("companies_header.cash"),value:c,color:"bg-yellow-500"},{label:s("companies_header.check"),value:p,color:"bg-red-500"}];case"project":const b=t.projects?.length||0,v=t.projects?.filter(r=>r.status==="completed").length||0,_=t.projects?.filter(r=>r.status==="in_progress").length||0,f=t.projects?.filter(r=>r.status==="delayed").length||0;return[{label:s("companies_header.total_projects"),value:b,color:"bg-blue-500"},{label:s("companies_header.completed"),value:v,color:"bg-green-500"},{label:s("companies_header.in_progress"),value:_,color:"bg-yellow-500"},{label:s("companies_header.delayed"),value:f,color:"bg-red-500"}];case"contact":const j=t.contacts?.filter(r=>r.is_primary).length||0,y=t.contacts?.length||0,w=t.contacts?.filter(r=>r.is_active).length||0;return[{label:s("companies_header.total_contacts"),value:y,color:"bg-blue-500"},{label:s("companies_header.primary_contacts"),value:j,color:"bg-green-500"},{label:s("companies_header.active"),value:w,color:"bg-yellow-500"},{label:s("companies_header.management"),value:t.contacts?.filter(r=>r.position?.toLowerCase().includes("manager")).length||0,color:"bg-red-500"}];default:return[{label:"Total",value:"0",color:"bg-blue-500"},{label:s("companies_header.active"),value:"0",color:"bg-green-500"},{label:s("companies_header.pending"),value:"0",color:"bg-yellow-500"},{label:s("companies_header.inactive_status"),value:"0",color:"bg-red-500"}]}})(),u=l=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(l),x=t.invoices?.filter(l=>l.status!=="paid").reduce((l,n)=>l+(n.amount_due||0),0)||0,d=({text:l,maxLength:n=20,className:c=""})=>l?l.length<=n?e.jsx("span",{className:c,children:l}):e.jsx("div",{className:"relative inline-block",children:e.jsxs("span",{className:`${c} truncate max-w-[150px] sm:max-w-[200px] cursor-help`,onMouseEnter:()=>m(l),onMouseLeave:()=>m(null),children:[l.substring(0,n),"..."]})}):null;return e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-4 lg:p-6",children:[i&&e.jsx("div",{className:"fixed z-50 px-3 py-2 text-sm text-white bg-gray-900 rounded-lg shadow-lg",children:i}),e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-start lg:justify-between mb-6 lg:mb-8 gap-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start gap-4",children:[a.logo_url?e.jsx("img",{src:a.logo_url,alt:a.client_code,className:"w-16 h-16 sm:w-20 sm:h-20 rounded-xl object-cover shadow-md mx-auto sm:mx-0"}):e.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 bg-gradient-to-br from-[#054748] to-[#0a5d5e] rounded-xl flex items-center justify-center shadow-md mx-auto sm:mx-0",children:e.jsx(P,{className:"w-8 h-8 sm:w-10 sm:h-10 text-white"})}),e.jsxs("div",{className:"flex-1 text-center sm:text-left",children:[e.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:e.jsx(d,{text:a.lead?.company_name||a.company_name||"-",maxLength:25})}),e.jsxs("div",{className:"mt-2 flex flex-col sm:flex-row sm:flex-wrap gap-2 sm:gap-3 text-sm text-gray-600",children:[(a.city||a.province)&&e.jsxs("div",{className:"flex items-center justify-center sm:justify-start space-x-1",children:[e.jsx(M,{className:"w-4 h-4 flex-shrink-0"}),e.jsxs("span",{className:"sr-only",children:[s("companies_header.location"),": "]}),e.jsx(d,{text:`${a.city||""}${a.province?`, ${a.province}`:""}${a.country?`, ${a.country}`:""}`,maxLength:30})]}),a.website&&e.jsxs("div",{className:"flex items-center justify-center sm:justify-start space-x-1",children:[e.jsx(C,{className:"w-4 h-4 flex-shrink-0"}),e.jsxs("span",{className:"sr-only",children:[s("companies_header.website"),": "]}),e.jsx(d,{text:a.website,maxLength:25})]}),a.primary_contact?.email&&e.jsxs("div",{className:"flex items-center justify-center sm:justify-start space-x-1",children:[e.jsx(L,{className:"w-4 h-4 flex-shrink-0"}),e.jsxs("span",{className:"sr-only",children:[s("companies_header.email"),": "]}),e.jsx(d,{text:a.primary_contact.email,maxLength:25})]}),a.primary_contact?.phone&&e.jsxs("div",{className:"flex items-center justify-center sm:justify-start space-x-1",children:[e.jsx(T,{className:"w-4 h-4 flex-shrink-0"}),e.jsxs("span",{className:"sr-only",children:[s("companies_header.phone"),": "]}),e.jsx(d,{text:a.primary_contact.phone,maxLength:20})]})]})]})]}),e.jsxs("div",{className:"text-center sm:text-right",children:[e.jsx("p",{className:"text-sm text-gray-500",children:s("companies_header.total_outstanding")}),e.jsxs("div",{className:"relative inline-block",children:[e.jsxs("button",{className:"text-2xl sm:text-3xl font-bold text-red-600 cursor-pointer transition-all duration-200 hover:bg-gray-100 rounded px-2 py-1 flex items-center gap-2",onClick:()=>m(i==="piutang"?null:"piutang"),title:u(x),children:[u(x),e.jsx("span",{className:"ml-1 text-xs text-gray-400",children:i==="piutang"?"▲":"▼"})]}),i==="piutang"&&e.jsxs("div",{className:"absolute right-0 mt-2 w-64 bg-white border border-gray-200 rounded-lg shadow-lg z-50 p-4 text-left",children:[e.jsx("div",{className:"mb-2 font-semibold text-gray-800",children:s("companies_header.outstanding_details")}),t.invoices?.filter(l=>l.status!=="paid").length>0?e.jsx("ul",{className:"text-sm text-gray-700 max-h-40 overflow-y-auto",children:t.invoices.filter(l=>l.status!=="paid").map((l,n)=>e.jsxs("li",{className:"mb-1 flex justify-between",children:[e.jsx("span",{children:l.invoice_number||"-"}),e.jsx("span",{children:u(l.amount_due||0)})]},l.id||n))}):e.jsx("div",{className:"text-xs text-gray-500",children:s("companies_header.no_outstanding_invoices")})]})]}),e.jsxs("p",{className:"text-xs sm:text-sm text-gray-500 mt-1",children:[t.invoices?.filter(l=>l.status!=="paid").length||0," ",s("companies_header.unpaid_invoices")]})]})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4",children:g.map((l,n)=>e.jsx("div",{className:"bg-gray-50 rounded-lg p-3 sm:p-4 border border-gray-200 hover:shadow-sm transition-shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`w-1 h-8 sm:h-10 ${l.color} rounded-full mr-3 flex-shrink-0`}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-lg sm:text-xl lg:text-2xl font-bold text-gray-900 truncate",children:l.value}),typeof l.value=="string"&&l.value.includes("Rp")&&e.jsx($,{className:"w-4 h-4 text-gray-400 ml-2 cursor-help flex-shrink-0",onMouseEnter:()=>{if(l.value.includes("Rp")){const c=l.value.match(/\d+/)?.[0];c&&m(u(parseFloat(c)))}},onMouseLeave:()=>m(null)})]}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-600 mt-1 truncate",children:l.label})]})]})},n))})]})};export{Y as default};
