import{r as i,j as e,b as $}from"./app--V8YQuQk.js";import{C as E,S as c}from"./ContactModal-BToqa-KD.js";import{u as R}from"./useTranslation-DGCn9e9S.js";import{C as h}from"./check-BtXJC3Kt.js";import{X as b}from"./x-DGqtnagE.js";import{P as g}from"./plus-D5prKAx_.js";import{U as d}from"./user-D9rdox91.js";import{c as X}from"./createLucideIcon-D7A-7CJ7.js";import{T as N}from"./trash-2-D2TdDDoH.js";import{M as T}from"./mail-D6ZCm5oy.js";import{P as L}from"./phone-CEvMLKm6.js";import"./briefcase-BWAq_THx.js";const q=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],w=X("pen",q),le=({contacts:r=[],companyId:x,onUpdate:n,isLoading:v=!1})=>{const{t}=R(),[B,H]=i.useState(null),[p,k]=i.useState("grid"),[O,o]=i.useState(!1),[P,C]=i.useState(!1),[D,F]=i.useState(null),[V,m]=i.useState(!1),[M,j]=i.useState(""),a=v||V,u=s=>{j(s),setTimeout(()=>{j("")},3e3)},f=s=>{console.log("Editing contact:",s),F(s),C(!0)},y=async s=>{if(confirm(t("contact_table.confirm_delete"))){m(!0);try{console.log("Deleting contact:",s);const l=await $.delete(`/companies/${x}/contacts/${s}`);if(console.log("Delete response:",l.data),l.data.success)n&&n(),u(t("contact_table.contact_deleted_success"));else throw new Error(l.data.message||t("contact_table.delete_failed"))}catch(l){console.error("Error deleting contact:",l),alert(l.response?.data?.message||t("contact_table.delete_error"))}finally{m(!1)}}},_=async s=>{m(!0);try{console.log("Toggling primary for contact:",s);const l=await $.post(`/companies/${x}/contacts/${s}/toggle-primary`);if(console.log("Toggle primary response:",l.data),l.data.success)n&&n(),u(t("contact_table.primary_contact_updated"));else throw new Error(l.data.message||t("contact_table.toggle_primary_failed"))}catch(l){console.error("Error toggling primary:",l),alert(l.response?.data?.message||t("contact_table.toggle_primary_error"))}finally{m(!1)}},S=(s,l)=>{console.log("Modal success:",l,s),n&&n(),u(t(l==="edit"?"contact_table.contact_updated_success":"contact_table.contact_added_success"))},A=()=>e.jsx("div",{className:"space-y-3",children:r.length===0?e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-8 text-center",children:[e.jsx(d,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:t("contact_table.no_contacts_found")}),e.jsx("p",{className:"text-gray-600 mb-4",children:t("contact_table.add_first_contact")}),e.jsxs("button",{onClick:()=>o(!0),className:"inline-flex items-center px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition-colors",disabled:a,children:[e.jsx(g,{className:"w-4 h-4 mr-2"}),t("contact_table.add_first_contact_button")]})]}):r.map(s=>e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 hover:shadow-sm transition-shadow",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${s.is_primary?"bg-gradient-to-br from-yellow-400 to-yellow-600":"bg-gradient-to-br from-teal-500 to-teal-700"}`,children:e.jsx(d,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-bold text-gray-900 text-sm",children:[s.name,s.is_primary&&e.jsx(c,{className:"w-3 h-3 text-yellow-500 inline-block ml-1"})]}),e.jsx("p",{className:"text-xs text-gray-600",children:s.position||t("contact_table.no_position")})]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:()=>_(s.id),className:`p-1.5 rounded-lg ${s.is_primary?"bg-yellow-100 text-yellow-600 hover:bg-yellow-200":"bg-gray-100 text-gray-400 hover:bg-gray-200"}`,title:s.is_primary?t("contact_table.primary_contact"):t("contact_table.set_as_primary"),disabled:a,children:e.jsx(c,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>f(s),className:"p-1.5 bg-blue-100 text-blue-600 rounded-lg hover:bg-blue-200",title:t("contact_table.edit_contact"),disabled:a,children:e.jsx(w,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>y(s.id),className:"p-1.5 bg-red-100 text-red-600 rounded-lg hover:bg-red-200",title:t("contact_table.delete_contact"),disabled:a,children:e.jsx(N,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(T,{className:"w-4 h-4 text-gray-400 mr-2"}),e.jsx("span",{className:"text-xs text-gray-900 truncate",children:s.email||t("contact_table.no_email")})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(L,{className:"w-4 h-4 text-gray-400 mr-2"}),e.jsx("span",{className:"text-xs text-gray-900",children:s.phone||t("contact_table.no_phone")})]})]}),e.jsx("div",{className:"mt-3 flex items-center justify-between",children:e.jsxs("div",{className:"flex space-x-2",children:[s.is_primary&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:[e.jsx(h,{className:"w-3 h-3 mr-1"}),t("contact_table.primary")]}),s.is_active===!1&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800",children:[e.jsx(b,{className:"w-3 h-3 mr-1"}),t("contact_table.inactive")]})]})})]},s.id))}),z=()=>e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r.length===0?e.jsxs("div",{className:"col-span-full bg-white border border-gray-200 rounded-xl p-12 text-center",children:[e.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-teal-100 to-teal-200 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(d,{className:"w-10 h-10 text-teal-600"})}),e.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-3",children:t("contact_table.no_contacts_yet")}),e.jsx("p",{className:"text-gray-600 mb-8 max-w-md mx-auto",children:t("contact_table.add_contacts_description")}),e.jsxs("button",{onClick:()=>o(!0),className:"inline-flex items-center px-6 py-3 bg-gradient-to-r from-teal-600 to-teal-700 text-white rounded-lg hover:from-teal-700 hover:to-teal-800 transition-all duration-300 font-medium shadow-md hover:shadow-lg",disabled:a,children:[e.jsx(g,{className:"w-5 h-5 mr-2"}),t("contact_table.add_first_contact_button_long")]})]}):r.map(s=>e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 hover:shadow-lg transition-all duration-300",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`w-14 h-14 rounded-full flex items-center justify-center ${s.is_primary?"bg-gradient-to-br from-yellow-400 to-yellow-600":"bg-gradient-to-br from-teal-500 to-teal-700"}`,children:e.jsx(d,{className:"w-7 h-7 text-white"})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900",children:[s.name,s.is_primary&&e.jsx(c,{className:"w-4 h-4 text-yellow-500 inline-block ml-2"})]}),e.jsx("p",{className:"text-sm text-gray-600 truncate max-w-[150px]",children:s.position||t("contact_table.no_position_specified")})]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:()=>_(s.id),className:`p-1.5 rounded-lg ${s.is_primary?"bg-yellow-100 text-yellow-600 hover:bg-yellow-200":"bg-gray-100 text-gray-400 hover:bg-gray-200"}`,title:s.is_primary?t("contact_table.primary_contact"):t("contact_table.set_as_primary"),disabled:a,children:e.jsx(c,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>f(s),className:"p-1.5 bg-blue-100 text-blue-600 rounded-lg hover:bg-blue-200",title:t("contact_table.edit_contact"),disabled:a,children:e.jsx(w,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>y(s.id),className:"p-1.5 bg-red-100 text-red-600 rounded-lg hover:bg-red-200",title:t("contact_table.delete_contact"),disabled:a,children:e.jsx(N,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-blue-50 rounded-lg",children:e.jsx(T,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:t("contact_table.email_label")}),e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:s.email||t("contact_table.no_email_provided")})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-green-50 rounded-lg",children:e.jsx(L,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:t("contact_table.phone_label")}),e.jsx("p",{className:"text-sm font-medium text-gray-900",children:s.phone||t("contact_table.no_phone_provided")})]})]})]}),e.jsx("div",{className:"flex items-center justify-between pt-4 border-t border-gray-100",children:e.jsxs("div",{className:"flex space-x-2",children:[s.is_primary&&e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:[e.jsx(h,{className:"w-3 h-3 mr-1"}),t("contact_table.primary_contact_label")]}),s.is_active===!1&&e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800",children:[e.jsx(b,{className:"w-3 h-3 mr-1"}),t("contact_table.inactive_label")]})]})})]},s.id))}),G=()=>e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden",children:r.length===0?e.jsxs("div",{className:"p-12 text-center",children:[e.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-teal-100 to-teal-200 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(d,{className:"w-10 h-10 text-teal-600"})}),e.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-3",children:t("contact_table.no_contacts_available")}),e.jsx("p",{className:"text-gray-600 mb-8 max-w-md mx-auto",children:t("contact_table.add_contacts_description_short")}),e.jsxs("button",{onClick:()=>o(!0),className:"inline-flex items-center px-6 py-3 bg-gradient-to-r from-teal-600 to-teal-700 text-white rounded-lg hover:from-teal-700 hover:to-teal-800 transition-all duration-300 font-medium shadow-md hover:shadow-lg",disabled:a,children:[e.jsx(g,{className:"w-5 h-5 mr-2"}),t("contact_table.add_first_contact_button")]})]}):e.jsx(e.Fragment,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:t("contact_table.contact")}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:t("contact_table.position")}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:t("contact_table.email")}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:t("contact_table.phone")}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:t("contact_table.status")}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:t("contact_table.actions")})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-100",children:r.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${s.is_primary?"bg-gradient-to-br from-yellow-400 to-yellow-600":"bg-gradient-to-br from-teal-500 to-teal-700"}`,children:e.jsx(d,{className:"w-5 h-5 text-white"})}),e.jsx("div",{className:"ml-3",children:e.jsxs("div",{className:"text-sm font-semibold text-gray-900",children:[s.name,s.is_primary&&e.jsx(c,{className:"w-3 h-3 text-yellow-500 inline-block ml-1"})]})})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-900",children:s.position||"-"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-900 truncate max-w-xs",children:s.email||t("contact_table.no_email")})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-900",children:s.phone||t("contact_table.no_phone")})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.is_primary?e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:[e.jsx(h,{className:"w-3 h-3 mr-1"}),t("contact_table.primary")]}):e.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:t("contact_table.secondary")}),s.is_active===!1&&e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800",children:[e.jsx(b,{className:"w-3 h-3 mr-1"}),t("contact_table.inactive")]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>_(s.id),className:`p-1.5 rounded-lg ${s.is_primary?"bg-yellow-100 text-yellow-600 hover:bg-yellow-200":"bg-gray-100 text-gray-400 hover:bg-gray-200"}`,title:s.is_primary?t("contact_table.primary_contact"):t("contact_table.set_as_primary"),disabled:a,children:e.jsx(c,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>f(s),className:"p-1.5 bg-blue-100 text-blue-600 rounded-lg hover:bg-blue-200",title:t("contact_table.edit_contact"),disabled:a,children:e.jsx(w,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>y(s.id),className:"p-1.5 bg-red-100 text-red-600 rounded-lg hover:bg-red-200",title:t("contact_table.delete_contact"),disabled:a,children:e.jsx(N,{className:"w-4 h-4"})})]})})]},s.id))})]})})})});return e.jsxs("div",{className:"relative",children:[M&&e.jsx("div",{className:"mb-6 animate-fade-in-down",children:e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(h,{className:"w-5 h-5 text-green-600"})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm font-medium text-green-800",children:M})}),e.jsx("div",{className:"ml-auto pl-3",children:e.jsx("button",{onClick:()=>j(""),className:"text-green-600 hover:text-green-800",children:e.jsx(b,{className:"w-4 h-4"})})})]})})}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between mb-8 gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:t("contact_table.contact_persons")}),e.jsx("p",{className:"text-gray-600 mt-1",children:t("contact_table.manage_contacts_description")})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[r.length>0&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"text-sm text-gray-600 hidden sm:block",children:[t("contact_table.view"),":"]}),e.jsxs("div",{className:"flex bg-gray-100 p-1 rounded-lg",children:[e.jsx("button",{onClick:()=>k("grid"),className:`px-3 py-1.5 text-sm rounded-md transition-all ${p==="grid"?"bg-white text-teal-600 shadow-sm":"text-gray-600 hover:text-gray-900"}`,disabled:a,children:t("contact_table.grid_view")}),e.jsx("button",{onClick:()=>k("list"),className:`px-3 py-1.5 text-sm rounded-md transition-all ${p==="list"?"bg-white text-teal-600 shadow-sm":"text-gray-600 hover:text-gray-900"}`,disabled:a,children:t("contact_table.list_view")})]})]}),e.jsx("button",{onClick:()=>o(!0),className:"flex items-center space-x-2 px-5 py-2.5 bg-gradient-to-r from-teal-600 to-teal-700 text-white rounded-lg hover:from-teal-700 hover:to-teal-800 transition-all duration-300 font-medium shadow-md hover:shadow-lg",disabled:a,children:a?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),e.jsx("span",{children:t("contact_table.adding")})]}):e.jsxs(e.Fragment,{children:[e.jsx(g,{className:"w-5 h-5"}),e.jsx("span",{children:t("contact_table.add_contact")})]})})]})]}),v&&r.length===0?e.jsxs("div",{className:"flex flex-col justify-center items-center py-16",children:[e.jsx("div",{className:"animate-spin rounded-full h-14 w-14 border-b-2 border-teal-600 mb-4"}),e.jsx("span",{className:"text-gray-600",children:t("contact_table.loading_contacts")})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"sm:hidden",children:e.jsx(A,{})}),e.jsx("div",{className:"hidden sm:block",children:p==="grid"?e.jsx(z,{}):e.jsx(G,{})}),r.length>0&&e.jsx("div",{className:"mt-8 pt-8 border-t border-gray-200",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 border border-blue-200 p-5 rounded-xl",children:[e.jsx("p",{className:"text-sm font-medium text-blue-700 mb-2",children:t("contact_table.total_contacts")}),e.jsx("p",{className:"text-3xl font-bold text-blue-900",children:r.length})]}),e.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 border border-green-200 p-5 rounded-xl",children:[e.jsx("p",{className:"text-sm font-medium text-green-700 mb-2",children:t("contact_table.primary_contacts")}),e.jsx("p",{className:"text-3xl font-bold text-green-900",children:r.filter(s=>s.is_primary).length})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 border border-purple-200 p-5 rounded-xl",children:[e.jsx("p",{className:"text-sm font-medium text-purple-700 mb-2",children:t("contact_table.active_contacts")}),e.jsx("p",{className:"text-3xl font-bold text-purple-900",children:r.filter(s=>s.is_active!==!1).length})]})]})})]}),e.jsx(E,{isOpen:O,onClose:()=>o(!1),companyId:x,mode:"add",onSuccess:S}),e.jsx(E,{isOpen:P,onClose:()=>C(!1),companyId:x,contact:D,mode:"edit",onSuccess:S})]})};export{le as default};
