import{a as B,r as v,u as V,j as t,c as u}from"./app-DSAstNJH.js";import{S as y,H as J}from"./HeaderLayout-PFXXfuQf.js";import{T as M}from"./TableLayout-DeF2PwM4.js";import{P as H}from"./PrimaryButton-DPuvMFR6.js";import{u as Y}from"./useTranslation-BTkknNM_.js";import{S as q}from"./search-DZZ_GgUd.js";import{C as z}from"./calendar-G4u4f0fT.js";import{F as G}from"./funnel-BOCY2HbZ.js";import{R as K}from"./refresh-cw-m21x-Xyc.js";import"./transition-CHb-6Grs.js";import"./settings-BO8HVa9i.js";import"./createLucideIcon-B1SYFIyP.js";import"./send-CNJV6gwc.js";import"./globe-DUEaYrgg.js";import"./chevron-down-CC24HzTf.js";import"./check-ZSv3oBxE.js";import"./user-QIOkK541.js";const P=(c,a="success")=>{y.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:x=>{x.onmouseenter=y.stopTimer,x.onmouseleave=y.resumeTimer}}).fire({icon:a,title:c})};function Q({auth_permissions:c}){const{t:a}=Y(),{props:m}=B();c.can_read;const x=c.can_create===1,j=c.can_update===1,N=c.can_delete===1;v.useEffect(()=>{m.flash?.success&&console.log("Flash message:",m.flash.success)},[m.flash]);const d=m.invoices??[{id:1,number:"INV-00001",date:"21-10-2024",company:"PT. Pumigas Indonesia",amount:12e6,total:1278e4,paid_amount:6e6,tax:{ppn:66e4,pph:12e4},due_amount:654e4,status:"Draft"},{id:2,number:"INV-00002",date:"28-10-2024",company:"PT. Pumigas Indonesia",amount:12e6,total:12468e3,paid_amount:36e5,tax:{ppn:396e3,pph:72e3},due_amount:3924e3,status:"Paid"},{id:3,number:"INV-00003",date:"11-11-2024",company:"China Communication Engineering Construction",amount:12e6,total:12312e3,paid_amount:24e5,tax:{ppn:264e3,pph:48e3},due_amount:2616e3,status:"Unpaid"}];d.reduce((e,s)=>e+(s.total??s.amount??0),0),d.reduce((e,s)=>e+(s.paid_amount||0),0),d.filter(e=>e.status==="Paid").length,d.filter(e=>e.status==="Unpaid").length,d.filter(e=>e.status==="Cancelled").length;const S=new Date().getFullYear(),w=[];for(let e=S;e>=2020;e--)w.push(e);const g=e=>e.toLocaleString("id-ID",{style:"currency",currency:"IDR",maximumFractionDigits:0}),_=[{value:"",label:a("invoices.filters.all_months")||"All Months"},{value:"1",label:"Jan"},{value:"2",label:"Feb"},{value:"3",label:"Mar"},{value:"4",label:"Apr"},{value:"5",label:"May"},{value:"6",label:"Jun"},{value:"7",label:"Jul"},{value:"8",label:"Aug"},{value:"9",label:"Sep"},{value:"10",label:"Oct"},{value:"11",label:"Nov"},{value:"12",label:"Dec"}],{data:l,setData:C,get:D}=V({search:"",status:"all",month:"",year:""}),[i,h]=v.useState({search:l.search||"",status:l.status||"all",month:l.month||"",year:l.year||""});v.useEffect(()=>{h({search:l.search||"",status:l.status||"all",month:l.month||"",year:l.year||""})},[l.search,l.status,l.month,l.year]);const b=(e,s)=>{h(n=>({...n,[e]:s})),C(e,s)},k=()=>{D(route("invoice.index"),{preserveState:!0,preserveScroll:!0,replace:!0,data:{search:i.search,status:i.status!=="all"?i.status:"",month:i.month,year:i.year}})},I=()=>{const e={search:"",status:"all",month:"",year:""};h(e),C(e),u.get(route("invoice.index"),{},{replace:!0,preserveState:!1,preserveScroll:!0})},p={Paid:{bg:"bg-green-100",text:"text-green-800",border:"border-green-200"},Unpaid:{bg:"bg-orange-100",text:"text-orange-800",border:"border-orange-200"},Draft:{bg:"bg-gray-100",text:"text-gray-800",border:"border-gray-200"},Cancelled:{bg:"bg-red-100",text:"text-red-800",border:"border-red-200"},Partial:{bg:"bg-yellow-100",text:"text-yellow-800",border:"border-yellow-200"}},F=[{key:"no",label:a("invoices.table.no_date")||"Invoice",render:(e,s,n)=>t.jsxs("div",{children:[t.jsx("div",{className:"text-teal-700 font-semibold hover:text-teal-900 cursor-pointer",onClick:()=>T(s.original),children:e}),t.jsx("div",{className:"text-xs text-gray-500",children:s.date})]})},{key:"company_name",label:a("invoices.table.company_name")||"Company Name"},{key:"amount",label:a("invoices.table.amount")||"Invoice Amount"},{key:"payment",label:a("invoices.table.payment")||"Payment"},{key:"tax",label:a("invoices.table.tax")||"Tax"},{key:"due_amount",label:a("invoices.table.due_amount")||"Amount Due"},{key:"status",label:a("invoices.table.status")||"Status",render:(e,s)=>{if(["Cancelled"].includes(e)){const r=`text-xs font-bold py-1 px-2 rounded-lg border-2 ${p[e]?p[e].border:"border-gray-300"}`;return t.jsx("span",{className:r,children:e})}return t.jsxs("select",{value:e,onChange:r=>L(s.id,r.target.value),className:`appearance-none text-xs font-bold py-1 px-2 rounded-lg border-2 focus:ring-0 cursor-pointer transition-all ${p[e]?p[e].border+" "+p[e].text:"border-gray-300"}`,children:[t.jsx("option",{value:"Draft",children:a("invoices.stats.draft")||"Draft"}),t.jsx("option",{value:"Unpaid",children:a("invoices.stats.unpaid")||"Unpaid"}),t.jsx("option",{value:"Paid",children:a("invoices.stats.paid")||"Paid"}),t.jsx("option",{value:"Cancelled",children:a("invoices.stats.cancelled")||"Cancelled"})]})}}],E=d.map(e=>({id:e.id,no:e.number,date:e.date,company_name:e.company,amount:g(e.amount),payment:g(e.paid_amount||0),tax:`PPN ${e.tax?.ppn?e.tax.ppn.toLocaleString():0} / PPh ${e.tax?.pph?e.tax.pph.toLocaleString():0}`,due_amount:g(e.due_amount),status:e.status,original:e})),T=e=>{u.visit(route("invoice.show",e.id))},U=()=>{u.visit(route("invoice.create"))},$=e=>{u.visit(route("invoice.edit",e))},A=(e,s)=>{confirm(`Are you sure you want to delete invoice ${s}?`)&&u.delete(route("invoice.destroy",e),{onSuccess:()=>{},onError:n=>{console.error("Delete failed:",n),alert("Failed to delete invoice")}})},L=(e,s)=>{u.patch(route("invoice.update-status",e),{status:s},{preserveScroll:!0,onStart:()=>{},onSuccess:n=>{P("Status updated to "+s.toUpperCase())},onError:n=>{console.error("Update failed:",n),P("Failed to update status","error")}})};return t.jsxs("div",{className:"p-6",children:[t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between mb-6 gap-3",children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-700",children:a("invoices.title")||"INVOICE"}),x&&t.jsx(H,{onClick:U,className:"w-full sm:w-auto px-5 py-2.5 text-white text-sm font-medium rounded-lg",children:t.jsx("span",{children:a("invoices.button_add")||"Add Invoice"})})]}),t.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 md:gap-6 my-7",children:(()=>{const e={Paid:{bg:"bg-green-100",text:"text-green-800",border:"border-green-200",icon:"âœ…"},Unpaid:{bg:"bg-orange-100",text:"text-orange-800",border:"border-orange-200",icon:"â³"},Draft:{bg:"bg-gray-100",text:"text-gray-800",border:"border-gray-200",icon:"ðŸ“"},Cancelled:{bg:"bg-red-100",text:"text-red-800",border:"border-red-200",icon:"âŒ"}},s=d.reduce((r,o)=>(r[o.status]=(r[o.status]||0)+1,r),{}),n=d.reduce((r,o)=>{const f=o.total??o.amount??0;return r[o.status]=(r[o.status]||0)+f,r},{});return Object.keys(e).map(r=>{const o=e[r],f=s[r]||0,R=n[r]||0,O=a(`invoices.stats.${r.toLowerCase()}`)||r;return t.jsx("div",{className:`rounded-xl p-5 shadow-sm border ${o.border} ${o.bg} transition-transform hover:scale-[1.02] hover:shadow-md`,children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:`text-sm font-medium ${o.text} uppercase tracking-wide`,children:O}),t.jsx("p",{className:"text-2xl md:text-3xl font-bold text-gray-900 mt-2",children:f}),t.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Rp ",g(R).replace(/^Rp\s?/,"")]})]}),t.jsx("div",{className:`p-3 rounded-full ${o.bg}`,children:t.jsx("span",{className:"text-lg",children:o.icon})})]})},r)})})()}),t.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4 md:p-6",children:t.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-end gap-4",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:a("invoices.filters.search_placeholder")}),t.jsxs("div",{className:"relative",children:[t.jsx(q,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),t.jsx("input",{type:"text",placeholder:a("invoices.filters.search_placeholder"),value:i.search,onChange:e=>b("search",e.target.value),className:"w-full pl-10 pr-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#005954] focus:border-transparent transition-colors"})]})]}),t.jsxs("div",{className:"grid grid-cols-2 lg:flex lg:space-x-4 gap-4",children:[t.jsxs("div",{className:"lg:w-40",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:a("invoices.filters.status")}),t.jsxs("select",{value:i.status,onChange:e=>b("status",e.target.value),className:"w-full px-3 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#005954] focus:border-transparent bg-white text-sm",children:[t.jsx("option",{value:"all",children:a("invoices.filters.all_status")}),t.jsx("option",{value:"Paid",children:a("invoices.stats.paid")}),t.jsx("option",{value:"Unpaid",children:a("invoices.stats.unpaid")}),t.jsx("option",{value:"Draft",children:a("invoices.stats.draft")}),t.jsx("option",{value:"Partial",children:a("invoices.stats.partial")}),t.jsx("option",{value:"Cancelled",children:a("invoices.stats.cancelled")})]})]}),t.jsxs("div",{className:"lg:w-40",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:a("invoices.filters.month")}),t.jsxs("div",{className:"relative",children:[t.jsx(z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),t.jsx("select",{value:i.month,onChange:e=>b("month",e.target.value),className:"w-full pl-9 pr-3 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#005954] focus:border-transparent bg-white text-sm",children:_.map(e=>t.jsx("option",{value:e.value,children:e.label},e.value))})]})]}),t.jsxs("div",{className:"lg:w-32",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:a("invoices.filters.year")}),t.jsxs("select",{value:i.year,onChange:e=>b("year",e.target.value),className:"w-full px-3 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#005954] focus:border-transparent bg-white text-sm",children:[t.jsx("option",{value:"",children:a("invoices.filters.all_years")}),w.map(e=>t.jsx("option",{value:e,children:e},e))]})]})]}),t.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 pt-2",children:[t.jsxs("button",{onClick:k,className:"px-4 py-2.5 bg-[#005954] text-white rounded-lg hover:bg-[#004d47] flex items-center gap-2 transition-colors justify-center text-sm font-medium",children:[t.jsx(G,{className:"w-4 h-4"}),a("invoices.filters.apply")]}),t.jsxs("button",{onClick:I,className:"px-4 py-2.5 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors flex items-center gap-2 justify-center text-sm font-medium",children:[t.jsx(K,{className:"w-4 h-4"}),a("invoices.filters.reset")]})]})]})}),t.jsx("div",{className:"py-8",children:t.jsx("div",{className:"overflow-x-auto -mx-4 px-4",children:t.jsx(M,{data:E,columns:F,onEdit:j?$:null,onDelete:N?A:null,showAction:j||N})})})]})}Q.layout=c=>t.jsx(J,{children:c});export{Q as default,P as toast};
