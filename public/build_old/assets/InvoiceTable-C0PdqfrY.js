import{r as u,j as e,c as k,R as ae}from"./app--V8YQuQk.js";import{u as ne}from"./useTranslation-DGCn9e9S.js";import{F as C}from"./file-text-BkpdNTL0.js";import{C as P}from"./circle-alert-CxrL5ccl.js";import{c as J}from"./createLucideIcon-D7A-7CJ7.js";import{X as re}from"./x-DGqtnagE.js";import{S as le}from"./save-ChX0yG6a.js";import{S as oe}from"./search-D65wTQHs.js";import{C as ie}from"./chevron-down-DnOCgVxl.js";import{C as U}from"./circle-check-big-CeV7987U.js";import{C as L}from"./check-BtXJC3Kt.js";import{T as q}from"./trash-2-D2TdDDoH.js";import{S as z}from"./square-pen-HBgHTwPe.js";import{P as ce}from"./percent-CepjKhjp.js";import{U as de}from"./user-D9rdox91.js";import{C as ue}from"./clock-mQHhekFu.js";const me=[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]],H=J("loader",me);const xe=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],pe=J("trending-up",xe),Le=({data:o,companyId:d})=>{const{t:a}=ne(),[R,c]=u.useState(null),[g,W]=u.useState(""),[_,K]=u.useState("all"),[F,be]=u.useState("date"),[j,he]=u.useState("desc"),[m,D]=u.useState([]),[ge,A]=u.useState(!1),[E,S]=u.useState(null),[T,N]=u.useState(null),[f,h]=u.useState(!1),[i,v]=u.useState({invoice_number:"",date:"",invoice_amount:"",amount_due:"",status:"draft",payment_terms:"",payment_type:"",note:"",ppn:"",pph:"",total:""}),[fe,V]=u.useState([]);console.log("InvoiceTable data received:",o);const x=t=>!t&&t!==0?a("invoice_table.currency_format",{amount:0}):new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(t),$=({amount:t,maxLength:s=15})=>{const[n,r]=ae.useState(!1),l=x(t);return l.length<=s?e.jsx("span",{children:l}):e.jsx("span",{className:"relative",children:e.jsxs("span",{className:"cursor-pointer",onClick:()=>r(!n),children:[n?l:l.slice(0,s)+"...",e.jsx("span",{className:"ml-1 text-xs text-blue-500 underline",children:n?"Sembunyikan":"Lihat"})]})})};u.useEffect(()=>{fetch("/payment-types").then(t=>t.json()).then(t=>V(t)).catch(t=>console.error("Failed to load payment types",t))},[]);const w=o.filter(t=>{const s=g===""||t.invoice_number&&t.invoice_number.toLowerCase().includes(g.toLowerCase())||t.contact_person?.name&&t.contact_person.name.toLowerCase().includes(g.toLowerCase())||t.quotation?.quotation_number&&t.quotation.quotation_number.toLowerCase().includes(g.toLowerCase())||t.contact_person?.email&&t.contact_person.email.toLowerCase().includes(g.toLowerCase())||t.note&&t.note.toLowerCase().includes(g.toLowerCase());let n=t.status?t.status.toLowerCase():"";const r={paid:["paid","lunas","terbayar"],unpaid:["unpaid","belum bayar","outstanding"],draft:["draft","draf"],cancelled:["cancelled","canceled","batal","dibatalkan"],invoice:["invoice","sent","terkirim"],partial:["partial","sebagian"]};let l=!1;return _==="all"?l=!0:r[_]?l=r[_].includes(n):l=n===_,s&&l}).sort((t,s)=>{try{if(F==="date"){const l=t.date?new Date(t.date):new Date(0),b=s.date?new Date(s.date):new Date(0);return isNaN(l.getTime())&&isNaN(b.getTime())?0:isNaN(l.getTime())?j==="desc"?1:-1:isNaN(b.getTime())?j==="desc"?-1:1:j==="desc"?b-l:l-b}if(F==="amount"){const l=parseFloat(t.invoice_amount)||0,b=parseFloat(s.invoice_amount)||0;return j==="desc"?b-l:l-b}if(F==="due"){const l=parseFloat(t.amount_due)||0,b=parseFloat(s.amount_due)||0;return j==="desc"?b-l:l-b}const n=t.date?new Date(t.date):new Date(0);return(s.date?new Date(s.date):new Date(0))-n}catch(n){return console.error("Sorting error:",n),0}}),y=t=>{if(!t)return a("invoice_table.status_unknown");const s={paid:a("invoice_table.status_paid"),unpaid:a("invoice_table.status_unpaid"),draft:a("invoice_table.status_draft"),cancelled:a("invoice_table.status_cancelled"),invoice:a("invoice_table.status_invoice_sent"),partial:a("invoice_table.status_partial"),lunas:a("invoice_table.status_paid"),"belum bayar":a("invoice_table.status_unpaid"),draf:a("invoice_table.status_draft"),batal:a("invoice_table.status_cancelled"),terkirim:a("invoice_table.status_invoice_sent"),sebagian:a("invoice_table.status_partial")},n=t.toLowerCase();return s[n]||t},X=t=>{const s="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium";if(!t)return e.jsx("span",{className:`${s} bg-gray-100 text-gray-800`,children:a("invoice_table.status_unknown")});const n=t.toLowerCase();return n.includes("paid")||n.includes("lunas")||n.includes("terbayar")?e.jsxs("span",{className:`${s} bg-green-100 text-green-800`,children:[e.jsx(U,{className:"w-3 h-3 mr-1"}),e.jsx("span",{children:y(t)})]}):n.includes("unpaid")||n.includes("belum")||n.includes("outstanding")?e.jsxs("span",{className:`${s} bg-yellow-100 text-yellow-800`,children:[e.jsx(ue,{className:"w-3 h-3 mr-1"}),e.jsx("span",{children:y(t)})]}):n.includes("invoice")||n.includes("sent")||n.includes("terkirim")?e.jsxs("span",{className:`${s} bg-blue-100 text-blue-800`,children:[e.jsx(C,{className:"w-3 h-3 mr-1"}),e.jsx("span",{children:y(t)})]}):n.includes("cancel")||n.includes("batal")?e.jsxs("span",{className:`${s} bg-red-100 text-red-800`,children:[e.jsx(P,{className:"w-3 h-3 mr-1"}),e.jsx("span",{children:y(t)})]}):n.includes("draft")||n.includes("draf")?e.jsxs("span",{className:`${s} bg-gray-100 text-gray-800`,children:[e.jsx(C,{className:"w-3 h-3 mr-1"}),e.jsx("span",{children:y(t)})]}):n.includes("partial")||n.includes("sebagian")?e.jsxs("span",{className:`${s} bg-purple-100 text-purple-800`,children:[e.jsx(pe,{className:"w-3 h-3 mr-1"}),e.jsx("span",{children:y(t)})]}):e.jsx("span",{className:`${s} bg-gray-100 text-gray-800`,children:y(t)})},G=t=>{if(!t)return a("invoice_table.not_available");try{const s=new Date(t);return isNaN(s.getTime())?a("invoice_table.invalid_date"):s.toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric"})}catch{return a("invoice_table.invalid_date")}},Q=t=>{if(!t)return{display:a("invoice_table.not_available"),tooltip:""};try{const s=new Date(t);if(isNaN(s.getTime()))return{display:a("invoice_table.invalid_date"),tooltip:""};const n=G(t),r=s.toLocaleDateString("id-ID",{weekday:"long",day:"numeric",month:"long",year:"numeric"});return{display:n,tooltip:r}}catch{return{display:a("invoice_table.invalid_date"),tooltip:""}}},O=t=>{D(s=>s.includes(t)?s.filter(n=>n!==t):[...s,t])},I=async t=>{try{A(!0);const s=await fetch(`/companies/${d}/invoices/${t.id}/get`);if(s.ok){const n=await s.json();if(n.success){const r=n.data;N(r),v({invoice_number:r.invoice_number||"",date:r.date?r.date.split("T")[0]:"",invoice_amount:r.invoice_amount||"",amount_due:r.amount_due||"",status:r.status||"draft",payment_terms:r.payment_terms||"",payment_type:r.payment_type||"",note:r.note||"",ppn:r.ppn||"",pph:r.pph||"",total:r.total||""})}else N(t),v({invoice_number:t.invoice_number||"",date:t.date?t.date.split("T")[0]:"",invoice_amount:t.invoice_amount||"",amount_due:t.amount_due||"",status:t.status||"draft",payment_terms:t.payment_terms||"",payment_type:t.payment_type||"",note:t.note||"",ppn:t.ppn||"",pph:t.pph||"",total:t.total||""})}else N(t),v({invoice_number:t.invoice_number||"",date:t.date?t.date.split("T")[0]:"",invoice_amount:t.invoice_amount||"",amount_due:t.amount_due||"",status:t.status||"draft",payment_terms:t.payment_terms||"",payment_type:t.payment_type||"",note:t.note||"",ppn:t.ppn||"",pph:t.pph||"",total:t.total||""})}catch(s){console.error("Error fetching invoice data:",s),N(t),v({invoice_number:t.invoice_number||"",date:t.date?t.date.split("T")[0]:"",invoice_amount:t.invoice_amount||"",amount_due:t.amount_due||"",status:t.status||"draft",payment_terms:t.payment_terms||"",payment_type:t.payment_type||"",note:t.note||"",ppn:t.ppn||"",pph:t.pph||"",total:t.total||""})}finally{A(!1)}},M=()=>{N(null),v({invoice_number:"",date:"",invoice_amount:"",amount_due:"",status:"draft",payment_terms:"",payment_type:"",note:"",ppn:"",pph:"",total:""})},p=t=>{const{name:s,value:n}=t.target;v(r=>({...r,[s]:n}))},Y=async()=>{if(!(!T||!d))try{if(!i.invoice_number.trim()){alert("Invoice number is required");return}if(!i.date){alert("Date is required");return}if(!i.invoice_amount||i.invoice_amount<=0){alert("Invoice amount must be greater than 0");return}if(i.amount_due<0){alert("Amount due cannot be negative");return}if(parseFloat(i.amount_due)>999999999999){alert("Amount due is too large");return}h(!0);const t=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||"";console.log("Sending update data:",i);const s=await fetch(`/companies/${d}/invoices/${T.id}`,{method:"PUT",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":t,"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(i)}),n=await s.text();console.log("Raw response:",n);let r;try{r=JSON.parse(n)}catch(l){throw console.error("Failed to parse JSON response:",l),new Error(`Invalid JSON response: ${n.substring(0,200)}`)}if(!s.ok)throw new Error(`Failed to update invoice: ${s.status} ${s.statusText}. ${r.message||"Unknown error"}`);r.success?(alert("Invoice updated successfully!"),console.log("Update successful:",r),k.reload({only:["invoices"]})):(alert("Failed to update invoice: "+r.message),console.error("Update failed:",r))}catch(t){console.error("Error updating invoice:",t),alert("Failed to update invoice: "+t.message)}finally{h(!1),M()}},B=async t=>{if(!(!t||!d))try{if(!window.confirm(a("invoice_table.confirm_mark_paid")))return;h(!0);const n=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||"",r=await fetch(`/companies/${d}/invoices/${t}/mark-paid`,{method:"PUT",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":n,"X-Requested-With":"XMLHttpRequest"}});if(!r.ok){const b=await r.text();throw new Error(`Failed to mark invoice as paid: ${r.status} ${r.statusText}. ${b}`)}const l=await r.json();l.success?(alert("Invoice marked as paid successfully!"),k.reload({only:["invoices"]})):alert("Failed to mark invoice as paid: "+l.message)}catch(s){console.error("Error marking invoice as paid:",s),alert("Failed to mark invoice as paid: "+s.message)}finally{h(!1)}},Z=async t=>{if(!(!t||!d))try{h(!0),console.log("Attempting to delete invoice:",{invoiceId:t,companyId:d,url:`/companies/${d}/invoices/${t}`});const s=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||"";console.log("CSRF Token:",s?"Found":"Not found");const n=await fetch(`/companies/${d}/invoices/${t}`,{method:"DELETE",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":s,"X-Requested-With":"XMLHttpRequest"}});if(console.log("Response status:",n.status,n.statusText),!n.ok){const l=await n.text();throw console.error("Error response:",l),new Error(`Failed to delete invoice: ${n.status} ${n.statusText}. ${l}`)}const r=await n.json();console.log("Success result:",r),r.success?(alert("Invoice deleted successfully!"),k.reload({only:["invoices"]})):alert("Failed to delete invoice: "+r.message)}catch(s){console.error("Error deleting invoice:",s),alert("Failed to delete invoice: "+s.message)}finally{h(!1),S(null)}},ee=async()=>{if(!(m.length===0||!d||!window.confirm(a("invoice_table.confirm_bulk_delete",{count:m.length}))))try{h(!0);const s=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||"",n=await fetch(`/companies/${d}/invoices/bulk-delete`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":s,"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({invoice_ids:m})});if(!n.ok){const l=await n.text();throw new Error(`Failed to delete invoices: ${n.status} ${n.statusText}. ${l}`)}const r=await n.json();r.success?(alert(`Successfully deleted ${r.deleted_count} invoice(s)!`),D([]),k.reload({only:["invoices"]})):alert("Failed to delete invoices: "+r.message)}catch(s){console.error("Error deleting invoices:",s),alert("Failed to delete invoices: "+s.message)}finally{h(!1)}},te=async()=>{if(!(m.length===0||!d||!window.confirm(a("invoice_table.confirm_bulk_mark_paid",{count:m.length}))))try{h(!0);const s=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||"",n=await fetch(`/companies/${d}/invoices/bulk-mark-paid`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":s,"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({invoice_ids:m})});if(!n.ok){const l=await n.text();throw new Error(`Failed to mark invoices as paid: ${n.status} ${n.statusText}. ${l}`)}const r=await n.json();r.success?(alert(`Successfully marked ${r.updated_count} invoice(s) as paid!`),D([]),k.reload({only:["invoices"]})):alert("Failed to mark invoices as paid: "+r.message)}catch(s){console.error("Error marking invoices as paid:",s),alert("Failed to mark invoices as paid: "+s.message)}finally{h(!1)}},se=({invoice:t})=>{const s=Q(t.date);return e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 mb-3 hover:shadow-sm transition-shadow",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:m.includes(t.id),onChange:()=>O(t.id),className:"h-4 w-4 text-blue-600 rounded"}),e.jsx(C,{className:"w-5 h-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 text-sm",children:t.invoice_number||a("invoice_table.no_number")}),e.jsx("p",{className:"text-xs text-gray-500 cursor-help",onMouseEnter:()=>s.tooltip&&c(s.tooltip),onMouseLeave:()=>c(null),children:s.display})]})]}),X(t.status)]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(de,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-xs text-gray-600",children:t.contact_person?.name||a("invoice_table.no_contact_person")})]}),t.quotation&&e.jsxs("div",{className:"text-xs text-gray-500",children:[a("invoice_table.quotation_label"),": ",t.quotation.quotation_number]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:a("invoice_table.amount")}),e.jsx("p",{className:"text-sm font-bold text-gray-900 cursor-help",onMouseEnter:()=>c(x(t.invoice_amount)),onMouseLeave:()=>c(null),children:e.jsx($,{amount:t.invoice_amount})})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:a("invoice_table.due")}),e.jsx("p",{className:"text-sm font-bold text-red-600 cursor-help",onMouseEnter:()=>c(x(t.amount_due)),onMouseLeave:()=>c(null),children:e.jsx($,{amount:t.amount_due})})]})]}),e.jsxs("div",{className:"flex justify-between space-x-2",children:[e.jsxs("button",{className:"flex items-center space-x-1 px-3 py-1 bg-blue-50 text-blue-700 rounded text-xs hover:bg-blue-100",onClick:()=>I(t),children:[e.jsx(z,{className:"w-3 h-3"}),e.jsx("span",{children:a("invoice_table.edit")})]}),e.jsxs("button",{className:`flex items-center space-x-1 px-3 py-1 rounded text-xs ${t.status!=="paid"?"bg-green-50 text-green-700 hover:bg-green-100":"bg-gray-100 text-gray-500 cursor-not-allowed"}`,disabled:t.status==="paid",onClick:()=>t.status!=="paid"&&B(t.id),children:[e.jsx(L,{className:"w-3 h-3"}),e.jsx("span",{children:t.status!=="paid"?a("invoice_table.mark_paid"):a("invoice_table.paid")})]}),e.jsxs("button",{className:"flex items-center space-x-1 px-3 py-1 bg-red-50 text-red-700 rounded text-xs hover:bg-red-100",onClick:()=>S(t),children:[e.jsx(q,{className:"w-3 h-3"}),e.jsx("span",{children:a("invoice_table.delete")})]})]})]})};return!o||o.length===0?e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 text-center text-gray-500",children:[e.jsx("div",{className:"mb-2",children:e.jsx(C,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:a("invoice_table.no_invoices_found")}),e.jsx("p",{className:"text-gray-500 max-w-md mx-auto mb-6",children:a("invoice_table.no_invoices_message")})]}):e.jsxs("div",{className:"relative",children:[E&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-xl max-w-md w-full mx-4",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(P,{className:"w-8 h-8 text-red-600 mr-3"}),e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:a("invoice_table.confirm_delete_title")})]}),e.jsx("p",{className:"text-gray-600 mb-6",children:a("invoice_table.confirm_delete_message",{invoice_number:E.invoice_number||a("invoice_table.no_number")})}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>S(null),className:"px-4 py-2 border border-gray-300 text-gray-700 rounded hover:bg-gray-50",children:a("invoice_table.cancel")}),e.jsx("button",{onClick:()=>Z(E.id),className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",disabled:f,children:f?e.jsx(H,{className:"w-4 h-4 animate-spin"}):a("invoice_table.delete")})]})]})}),T&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900",children:[a("invoice_table.edit_invoice")," - ",T.invoice_number]}),e.jsx("button",{onClick:M,className:"p-1 hover:bg-gray-100 rounded-full",children:e.jsx(re,{className:"w-5 h-5"})})]}),e.jsx("form",{onSubmit:t=>{t.preventDefault(),Y()},children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Invoice Number *"}),e.jsx("input",{type:"text",name:"invoice_number",value:i.invoice_number,onChange:p,className:"w-full px-3 py-2 border border-gray-300 rounded focus:ring-blue-500 focus:border-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date *"}),e.jsx("input",{type:"date",name:"date",value:i.date,onChange:p,className:"w-full px-3 py-2 border border-gray-300 rounded focus:ring-blue-500 focus:border-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Invoice Amount *"}),e.jsx("input",{type:"number",name:"invoice_amount",value:i.invoice_amount,onChange:p,className:"w-full px-3 py-2 border border-gray-300 rounded focus:ring-blue-500 focus:border-blue-500",required:!0,min:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount Due *"}),e.jsx("input",{type:"number",name:"amount_due",value:i.amount_due,onChange:p,className:"w-full px-3 py-2 border border-gray-300 rounded focus:ring-blue-500 focus:border-blue-500",required:!0,min:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Terms"}),e.jsx("input",{type:"text",name:"payment_terms",value:i.payment_terms,onChange:p,className:"w-full px-3 py-2 border border-gray-300 rounded focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Type"}),e.jsx("input",{type:"text",name:"payment_type",value:i.payment_type,onChange:p,className:"w-full px-3 py-2 border border-gray-300 rounded focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Percentage"}),e.jsx("input",{type:"number",name:"payment_percentage",value:i.payment_percentage||"",onChange:p,className:"w-full px-3 py-2 border border-gray-300 rounded focus:ring-blue-500 focus:border-blue-500",min:"0",max:"100",step:"0.01"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Note"}),e.jsx("input",{type:"text",name:"note",value:i.note,onChange:p,className:"w-full px-3 py-2 border border-gray-300 rounded focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"PPN"}),e.jsx("input",{type:"number",name:"ppn",value:i.ppn||"",onChange:p,className:"w-full px-3 py-2 border border-gray-300 rounded focus:ring-blue-500 focus:border-blue-500",min:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"PPH"}),e.jsx("input",{type:"number",name:"pph",value:i.pph||"",onChange:p,className:"w-full px-3 py-2 border border-gray-300 rounded focus:ring-blue-500 focus:border-blue-500",min:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Total"}),e.jsx("input",{type:"number",name:"total",value:i.total||"",onChange:p,className:"w-full px-3 py-2 border border-gray-300 rounded focus:ring-blue-500 focus:border-blue-500",min:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{name:"status",value:i.status,onChange:p,className:"w-full px-3 py-2 border border-gray-300 rounded focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"Draft",children:"Draft"}),e.jsx("option",{value:"Paid",children:"Paid"}),e.jsx("option",{value:"Invoice",children:"Invoice"}),e.jsx("option",{value:"Unpaid",children:"Unpaid"}),e.jsx("option",{value:"Partial",children:"Partial"}),e.jsx("option",{value:"Cancelled",children:"Cancelled"})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[e.jsx("button",{type:"button",onClick:M,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded hover:bg-gray-50",children:a("invoice_table.cancel")}),e.jsxs("button",{type:"submit",className:"px-4 py-2 bg-[#054748] text-white rounded-lg hover:bg-[#0a5d5e] transition-colors flex items-center disabled:opacity-50 disabled:cursor-not-allowed",disabled:f,children:[f?e.jsx(H,{className:"w-4 h-4 animate-spin mr-2"}):e.jsx(le,{className:"w-4 h-4 mr-2"}),a("invoice_table.save")]})]})]})})]})}),R&&e.jsx("div",{className:"fixed z-50 px-3 py-2 text-sm text-white bg-gray-900 rounded-lg shadow-lg pointer-events-none",children:R}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-lg md:text-xl font-bold text-gray-900",children:a("invoice_table.invoice_list")}),e.jsx("p",{className:"text-sm md:text-base text-gray-600",children:a("invoice_table.invoice_count",{count:o.length,plural:o.length!==1?"s":"",filteredCount:w.length,pluralFiltered:w.length!==1?"es":""})})]}),e.jsxs("div",{className:"mb-6 space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(oe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:a("invoice_table.search_placeholder"),value:g,onChange:t=>W(t.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})}),e.jsx("div",{className:"w-full sm:w-48",children:e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:_,onChange:t=>K(t.target.value),className:"w-full pl-3 pr-10 py-2 border border-gray-300 rounded-lg appearance-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"all",children:a("invoice_table.all_status")}),e.jsx("option",{value:"paid",children:a("invoice_table.status_paid")}),e.jsx("option",{value:"unpaid",children:a("invoice_table.status_unpaid")}),e.jsx("option",{value:"invoice",children:a("invoice_table.status_invoice_sent")}),e.jsx("option",{value:"draft",children:a("invoice_table.status_draft")}),e.jsx("option",{value:"cancelled",children:a("invoice_table.status_cancelled")})]}),e.jsx(ie,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5 pointer-events-none"})]})})]}),m.length>0&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(U,{className:"w-5 h-5 text-blue-600 mr-2"}),e.jsx("span",{className:"font-medium text-blue-800",children:a("invoice_table.selected_count",{count:m.length,plural:m.length!==1?"s":""})})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{className:"px-3 py-1 bg-green-600 text-white rounded text-sm hover:bg-green-700 flex items-center",onClick:te,disabled:f,children:[e.jsx(L,{className:"w-4 h-4 inline mr-1"}),a("invoice_table.mark_as_paid")]}),e.jsxs("button",{className:"px-3 py-1 bg-red-600 text-white rounded text-sm hover:bg-red-700 flex items-center",onClick:ee,disabled:f,children:[e.jsx(q,{className:"w-4 h-4 inline mr-1"}),a("invoice_table.delete_selected")]})]})]})})]}),e.jsx("div",{className:"sm:hidden space-y-3",children:w.map(t=>e.jsx(se,{invoice:t},t.id))}),e.jsx("div",{className:"hidden sm:block",children:e.jsx("div",{className:"overflow-x-auto border border-gray-200 rounded-lg",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-[#eaf6f6]",children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase border-r border-gray-200",children:"No"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase border-r border-gray-200",children:"Invoice"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase border-r border-gray-200",children:"Invoice Amount"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase border-r border-gray-200",children:"Payment Term"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase border-r border-gray-200",children:"PPN & PPh"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase border-r border-gray-200",children:"Ammount Due"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase border-r border-gray-200",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase",children:"Action"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:w.map((t,s)=>e.jsxs("tr",{className:`hover:bg-gray-50 ${m.includes(t.id)?"bg-blue-50":""}`,children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx("input",{type:"checkbox",checked:m.includes(t.id),onChange:()=>O(t.id),className:"h-4 w-4 text-blue-600 rounded"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"font-medium text-gray-900",children:t.invoice_number||a("invoice_table.not_available")})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"font-semibold text-gray-900",children:e.jsx($,{amount:t.invoice_amount})})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"text-gray-900",children:t.payment_terms||a("invoice_table.not_available")})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"text-gray-900",children:[a("invoice_table.ppn"),": ",t.ppn||0," ",e.jsx("br",{}),a("invoice_table.pph"),": ",t.pph||0]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"font-bold text-red-600",children:e.jsx($,{amount:t.amount_due})})}),e.jsx("td",{className:"px-4 py-3",children:X(t.status)}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{title:a("invoice_table.edit_invoice"),className:"p-1 text-blue-600 hover:text-blue-900 hover:bg-blue-50 rounded",onClick:()=>I(t),children:e.jsx(z,{className:"w-4 h-4"})}),e.jsx("button",{title:a("invoice_table.mark_as_paid"),className:`p-1 rounded ${t.status!=="paid"?"text-green-600 hover:text-green-900 hover:bg-green-50":"text-gray-400 cursor-not-allowed"}`,disabled:t.status==="paid"||f,onClick:()=>t.status!=="paid"&&B(t.id),children:e.jsx(L,{className:"w-4 h-4"})}),e.jsx("button",{title:a("invoice_table.delete_invoice"),className:"p-1 text-red-600 hover:text-red-900 hover:bg-red-50 rounded",onClick:()=>S(t),children:e.jsx(q,{className:"w-4 h-4"})})]})})]},t.id))})]})})}),e.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:a("invoice_table.invoice_summary")}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(C,{className:"w-5 h-5 text-blue-600 mr-2"}),e.jsx("p",{className:"text-sm text-gray-600",children:a("invoice_table.total_invoices")})]}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-2 cursor-help",children:o.length}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:a("invoice_table.match_filter",{count:w.length})})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[e.jsx("div",{className:"flex items-center",children:e.jsx("p",{className:"text-sm text-gray-600",children:a("invoice_table.total_amount")})}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-2 cursor-help",onMouseEnter:()=>c(x(o.reduce((t,s)=>t+(s.invoice_amount||0),0))),onMouseLeave:()=>c(null),children:x(o.reduce((t,s)=>t+(s.invoice_amount||0),0))}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:a("invoice_table.all_invoices")})]}),e.jsxs("div",{className:"bg-red-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(P,{className:"w-5 h-5 text-red-600 mr-2"}),e.jsx("p",{className:"text-sm text-gray-600",children:a("invoice_table.total_due")})]}),e.jsx("p",{className:"text-2xl font-bold text-red-600 mt-2 cursor-help",onMouseEnter:()=>c(x(o.reduce((t,s)=>t+(s.amount_due||0),0))),onMouseLeave:()=>c(null),children:x(o.reduce((t,s)=>t+(s.amount_due||0),0))}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:a("invoice_table.unpaid_balance")})]}),e.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(ce,{className:"w-5 h-5 text-purple-600 mr-2"}),e.jsx("p",{className:"text-sm text-gray-600",children:a("invoice_table.tax_summary")})]}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-2 cursor-help",onMouseEnter:()=>{const t=o.reduce((n,r)=>n+(r.ppn||0),0),s=o.reduce((n,r)=>n+(r.pph||0),0);c(`${a("invoice_table.ppn")}: ${x(t)}
${a("invoice_table.pph")}: ${x(s)}`)},onMouseLeave:()=>c(null),children:x(o.reduce((t,s)=>t+(s.ppn||0),0))}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:a("invoice_table.total_ppn")})]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600",children:a("invoice_table.paid_invoices")}),e.jsx("p",{className:"text-xl font-bold text-green-600",children:o.filter(t=>t.status==="paid").length})]}),e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600",children:a("invoice_table.unpaid_invoices")}),e.jsx("p",{className:"text-xl font-bold text-yellow-600",children:o.filter(t=>t.status==="unpaid").length})]}),e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600",children:a("invoice_table.average_invoice")}),e.jsx("p",{className:"text-xl font-bold text-blue-600 cursor-help",onMouseEnter:()=>{const t=o.length>0?o.reduce((s,n)=>s+(n.invoice_amount||0),0)/o.length:0;c(x(t))},onMouseLeave:()=>c(null),children:x(o.length>0?o.reduce((t,s)=>t+(s.invoice_amount||0),0)/o.length:0)})]})]})]}),!1]})};export{Le as default};
