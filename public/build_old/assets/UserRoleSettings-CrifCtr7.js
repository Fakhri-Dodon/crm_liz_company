import{a as S,r as u,j as e,c as f}from"./app--V8YQuQk.js";import{B as b,t as d}from"./index-Dt_dz-fy.js";import{T as z,a as P,b as v,c as k,d as E,e as w}from"./Table-D-7eSfaE.js";const T=({permission:r,onSave:h,onCancel:g})=>{const[x,m]=u.useState({can_create:r.can_create||0,can_read:r.can_read||0,can_update:r.can_update||0,can_delete:r.can_delete||0}),a=[{key:"can_create",char:"C",label:"Create"},{key:"can_read",char:"R",label:"Read"},{key:"can_update",char:"U",label:"Update"},{key:"can_delete",char:"D",label:"Delete"}];return e.jsxs("div",{className:"bg-white border border-gray-300 shadow-2xl rounded-md p-4 w-56 animate-in fade-in zoom-in-95 duration-150",children:[e.jsx("div",{className:"mb-2 pb-2 border-b",children:e.jsx("span",{className:"text-[10px] font-black uppercase text-teal-600 tracking-tighter",children:r.id?"Edit Permission":"Setup New Permission"})}),e.jsx("div",{className:"space-y-2 mb-4",children:a.map(t=>e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer p-1 hover:bg-gray-50 rounded",children:[e.jsx("input",{type:"checkbox",checked:x[t.key]===1,onChange:()=>m(l=>({...l,[t.key]:l[t.key]===1?0:1})),className:"rounded text-teal-600 focus:ring-teal-500"}),e.jsx("span",{className:"text-sm font-bold text-gray-700",children:t.label})]},t.key))}),e.jsxs("div",{className:"flex justify-end gap-2 border-t pt-2",children:[e.jsx(b,{size:"sm",variant:"outline",onClick:g,children:"Batal"}),e.jsx(b,{size:"sm",onClick:()=>h({...r,...x}),className:"bg-teal-700 hover:bg-teal-800 text-white",children:r.id?"Update":"Create"})]})]})};function B(){const{props:r}=S(),h=r.rawPermissions||[],g=r.menus||[],x=r.roles||[],[m,a]=u.useState(null),[t,l]=u.useState(!1),[p,j]=u.useState(""),[y,N]=u.useState(""),C=s=>{if(s.preventDefault(),!p.trim()){d.error("Nama role tidak boleh kosong");return}f.post("/setting/user-roles/role-store",{name:p,description:y},{onSuccess:()=>{l(!1),j(""),N(""),d.success("Role berhasil ditambahkan")},onError:()=>d.error("Gagal menambahkan role")})},_=s=>{s.id?f.put(`/setting/user-roles/${s.id}`,s,{preserveScroll:!0,onSuccess:()=>{a(null),d.success("Izin berhasil diperbarui")}}):f.post("/setting/user-roles/store",s,{preserveScroll:!0,onSuccess:()=>{a(null),d.success("Izin baru berhasil dibuat")},onError:n=>{console.error(n),d.error("Gagal membuat izin baru")}})},R=s=>{if(!s||!s.id)return e.jsx("div",{className:"flex justify-center italic text-gray-300 text-[10px]",children:"No Access (Click to Create)"});const c=[s.can_create,s.can_read,s.can_update,s.can_delete].filter(o=>o===1).length;if(c===4)return e.jsx("div",{className:"flex justify-center",children:e.jsx("span",{className:"text-[10px] font-black text-teal-700 bg-teal-50 px-2 py-1 rounded border border-teal-200 uppercase tracking-tighter shadow-sm",children:"Full Access"})});if(c===0)return e.jsx("div",{className:"flex justify-center",children:e.jsx("span",{className:"text-[10px] font-bold text-red-400 bg-gray-50 px-2 py-1 rounded border border-gray-200 uppercase tracking-tighter opacity-70",children:"No Access"})});const i=[{k:"can_create",c:"C",color:"text-green-600 bg-green-50 border-green-200"},{k:"can_read",c:"R",color:"text-orange-600 bg-orange-50 border-orange-200"},{k:"can_update",c:"U",color:"text-blue-600 bg-blue-50 border-blue-200"},{k:"can_delete",c:"D",color:"text-red-600 bg-red-50 border-red-200"}];return e.jsx("div",{className:"flex gap-1 justify-center",children:i.map(o=>e.jsx("span",{className:`w-6 h-6 flex items-center justify-center border text-[10px] font-bold rounded shadow-sm transition-all ${s[o.k]===1?o.color:"text-gray-200 bg-gray-50/50 border-gray-100"}`,children:o.c},o.c))})};return e.jsxs("div",{className:"p-6 relative",children:[e.jsxs("div",{className:"mb-6 flex justify-between items-center",children:[e.jsx("h1",{className:"text-xl font-bold text-red-700 mb-6 uppercase tracking-wider",children:"Role Permissions Mapping"}),e.jsxs(b,{onClick:()=>{l(!0)},className:"bg-gray-900 hover:bg-gray-800 text-white flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:"+"}),"Add Role"]})]}),e.jsx("div",{className:"-mx-4 sm:mx-0 px-4 sm:px-0 overflow-x-auto",children:e.jsx("div",{className:"min-w-[720px]",children:e.jsx("div",{className:"border border-gray-300 rounded-lg bg-white overflow-hidden shadow-md",children:e.jsxs(z,{children:[e.jsx(P,{children:e.jsxs(v,{className:"bg-gray-900 hover:bg-gray-900",children:[e.jsx(k,{className:"w-56 font-bold border-r border-gray-700 text-white uppercase text-xs tracking-wider",children:"Menu / Module"}),x.map(s=>e.jsx(k,{className:"text-center font-bold uppercase text-xs text-white tracking-wider border-r border-gray-800 last:border-r-0",children:s.name},s.id))]})}),e.jsx(E,{children:g.map(s=>e.jsxs(v,{className:"hover:bg-gray-50/80 transition-colors h-14",children:[e.jsx(w,{className:"font-bold border-r bg-gray-50/50 text-gray-700 text-xs uppercase",children:s.name}),x.map(n=>{const c=h.find(i=>i.menu_id===s.id&&i.role_id===n.id);return e.jsx(w,{className:"p-0 text-center relative border-r last:border-r-0",children:e.jsx("div",{onClick:i=>{i.currentTarget.getBoundingClientRect(),a(c||{role_id:n.id,menu_id:s.id})},className:"h-14 w-full flex items-center justify-center cursor-pointer transition-all hover:bg-teal-50/30 active:scale-95",children:R(c)})},n.id)})]},s.id))})]})})})}),m&&e.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/40 backdrop-blur-sm animate-in fade-in duration-200",children:[e.jsx("div",{className:"fixed inset-0",onClick:()=>a(null)}),e.jsx("div",{className:"relative z-10 w-full flex justify-center p-4",children:e.jsx(T,{permission:m,onCancel:()=>a(null),onSave:_})})]}),t&&e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/50 backdrop-blur-sm animate-in fade-in duration-200",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md p-6 animate-in zoom-in-95 duration-200",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 border-b pb-2",children:[e.jsx("h2",{className:"text-lg font-black uppercase tracking-tight text-gray-800",children:"Create New Role"}),e.jsx("button",{onClick:()=>l(!1),className:"text-gray-400 hover:text-gray-600",children:"âœ•"})]}),e.jsxs("form",{onSubmit:C,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-bold uppercase text-gray-500 mb-1",children:["Role Name"," ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{autoFocus:!0,type:"text",value:p,onChange:s=>j(s.target.value),placeholder:"e.g. SUPERVISOR",className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent transition-all"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-gray-500 mb-1",children:"Description"}),e.jsx("span",{className:"text-[10px] text-gray-400 italic",children:"Optional"})]}),e.jsx("textarea",{value:y,onChange:s=>N(s.target.value),placeholder:"Describe the responsibilities of this role...",rows:3,className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent transition-all resize-none"})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx(b,{type:"button",variant:"outline",onClick:()=>l(!1),children:"Cancel"}),e.jsx(b,{type:"submit",className:"bg-teal-700 hover:bg-teal-800 text-white",children:"Save Role"})]})]})]})})]})}export{B as U};
