import{r as p,j as e,c as C}from"./app-DSAstNJH.js";import{u as se}from"./useTranslation-BTkknNM_.js";import{F as S}from"./file-text-DfBuK0ep.js";import{C as L}from"./circle-alert-DQBZZU21.js";import{c as J}from"./createLucideIcon-B1SYFIyP.js";import{X as ae}from"./x-D-I7aP1o.js";import{S as re}from"./save-D_TZ1lm2.js";import{S as ne}from"./search-DZZ_GgUd.js";import{C as le}from"./chevron-down-CC24HzTf.js";import{C as U}from"./circle-check-big-yLdXT5kW.js";import{C as q}from"./check-ZSv3oBxE.js";import{T as P}from"./trash-2-CVjnwYw9.js";import{S as z}from"./square-pen-EjYThDv6.js";import{D as oe}from"./dollar-sign-OkMCjoJf.js";import{P as ie}from"./percent-DSb6f2_h.js";import{U as ce}from"./user-QIOkK541.js";import{C as de}from"./clock-RFUf-FY5.js";const ue=[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]],H=J("loader",ue);const me=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],xe=J("trending-up",me),Le=({data:o,companyId:d})=>{const{t:s}=se(),[R,c]=p.useState(null),[f,W]=p.useState(""),[j,K]=p.useState("all"),[F,pe]=p.useState("date"),[N,be]=p.useState("desc"),[u,M]=p.useState([]),[he,A]=p.useState(!1),[E,T]=p.useState(null),[$,w]=p.useState(null),[y,b]=p.useState(!1),[i,v]=p.useState({invoice_number:"",date:"",invoice_amount:"",amount_due:"",status:"draft",payment_terms:"",payment_type:"",note:"",ppn:"",pph:"",total:""});console.log("InvoiceTable data received:",o);const k=o.filter(t=>{const a=f===""||t.invoice_number&&t.invoice_number.toLowerCase().includes(f.toLowerCase())||t.contact_person?.name&&t.contact_person.name.toLowerCase().includes(f.toLowerCase())||t.quotation?.quotation_number&&t.quotation.quotation_number.toLowerCase().includes(f.toLowerCase())||t.contact_person?.email&&t.contact_person.email.toLowerCase().includes(f.toLowerCase())||t.note&&t.note.toLowerCase().includes(f.toLowerCase());let r=t.status?t.status.toLowerCase():"";const n={paid:["paid","lunas","terbayar"],unpaid:["unpaid","belum bayar","outstanding"],draft:["draft","draf"],cancelled:["cancelled","canceled","batal","dibatalkan"],invoice:["invoice","sent","terkirim"],partial:["partial","sebagian"]};let l=!1;return j==="all"?l=!0:n[j]?l=n[j].includes(r):l=r===j,a&&l}).sort((t,a)=>{try{if(F==="date"){const l=t.date?new Date(t.date):new Date(0),m=a.date?new Date(a.date):new Date(0);return isNaN(l.getTime())&&isNaN(m.getTime())?0:isNaN(l.getTime())?N==="desc"?1:-1:isNaN(m.getTime())?N==="desc"?-1:1:N==="desc"?m-l:l-m}if(F==="amount"){const l=parseFloat(t.invoice_amount)||0,m=parseFloat(a.invoice_amount)||0;return N==="desc"?m-l:l-m}if(F==="due"){const l=parseFloat(t.amount_due)||0,m=parseFloat(a.amount_due)||0;return N==="desc"?m-l:l-m}const r=t.date?new Date(t.date):new Date(0);return(a.date?new Date(a.date):new Date(0))-r}catch(r){return console.error("Sorting error:",r),0}}),_=t=>{if(!t)return s("invoice_table.status_unknown");const a={paid:s("invoice_table.status_paid"),unpaid:s("invoice_table.status_unpaid"),draft:s("invoice_table.status_draft"),cancelled:s("invoice_table.status_cancelled"),invoice:s("invoice_table.status_invoice_sent"),partial:s("invoice_table.status_partial"),lunas:s("invoice_table.status_paid"),"belum bayar":s("invoice_table.status_unpaid"),draf:s("invoice_table.status_draft"),batal:s("invoice_table.status_cancelled"),terkirim:s("invoice_table.status_invoice_sent"),sebagian:s("invoice_table.status_partial")},r=t.toLowerCase();return a[r]||t},X=t=>{const a="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium";if(!t)return e.jsx("span",{className:`${a} bg-gray-100 text-gray-800`,children:s("invoice_table.status_unknown")});const r=t.toLowerCase();return r.includes("paid")||r.includes("lunas")||r.includes("terbayar")?e.jsxs("span",{className:`${a} bg-green-100 text-green-800`,children:[e.jsx(U,{className:"w-3 h-3 mr-1"}),e.jsx("span",{children:_(t)})]}):r.includes("unpaid")||r.includes("belum")||r.includes("outstanding")?e.jsxs("span",{className:`${a} bg-yellow-100 text-yellow-800`,children:[e.jsx(de,{className:"w-3 h-3 mr-1"}),e.jsx("span",{children:_(t)})]}):r.includes("invoice")||r.includes("sent")||r.includes("terkirim")?e.jsxs("span",{className:`${a} bg-blue-100 text-blue-800`,children:[e.jsx(S,{className:"w-3 h-3 mr-1"}),e.jsx("span",{children:_(t)})]}):r.includes("cancel")||r.includes("batal")?e.jsxs("span",{className:`${a} bg-red-100 text-red-800`,children:[e.jsx(L,{className:"w-3 h-3 mr-1"}),e.jsx("span",{children:_(t)})]}):r.includes("draft")||r.includes("draf")?e.jsxs("span",{className:`${a} bg-gray-100 text-gray-800`,children:[e.jsx(S,{className:"w-3 h-3 mr-1"}),e.jsx("span",{children:_(t)})]}):r.includes("partial")||r.includes("sebagian")?e.jsxs("span",{className:`${a} bg-purple-100 text-purple-800`,children:[e.jsx(xe,{className:"w-3 h-3 mr-1"}),e.jsx("span",{children:_(t)})]}):e.jsx("span",{className:`${a} bg-gray-100 text-gray-800`,children:_(t)})},g=t=>!t&&t!==0?s("invoice_table.currency_format",{amount:0}):t>=1e9?s("invoice_table.currency_m",{amount:(t/1e9).toFixed(1)}):t>=1e6?s("invoice_table.currency_jt",{amount:(t/1e6).toFixed(1)}):t>=1e3?s("invoice_table.currency_rb",{amount:(t/1e3).toFixed(0)}):s("invoice_table.currency_format",{amount:t}),h=t=>!t&&t!==0?s("invoice_table.currency_format",{amount:0}):new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(t),V=t=>{if(!t)return s("invoice_table.not_available");try{const a=new Date(t);return isNaN(a.getTime())?s("invoice_table.invalid_date"):a.toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric"})}catch{return s("invoice_table.invalid_date")}},G=t=>{if(!t)return{display:s("invoice_table.not_available"),tooltip:""};try{const a=new Date(t);if(isNaN(a.getTime()))return{display:s("invoice_table.invalid_date"),tooltip:""};const r=V(t),n=a.toLocaleDateString("id-ID",{weekday:"long",day:"numeric",month:"long",year:"numeric"});return{display:r,tooltip:n}}catch{return{display:s("invoice_table.invalid_date"),tooltip:""}}},O=t=>{M(a=>a.includes(t)?a.filter(r=>r!==t):[...a,t])},B=async t=>{try{A(!0);const a=await fetch(`/companies/${d}/invoices/${t.id}/get`);if(a.ok){const r=await a.json();if(r.success){const n=r.data;w(n),v({invoice_number:n.invoice_number||"",date:n.date?n.date.split("T")[0]:"",invoice_amount:n.invoice_amount||"",amount_due:n.amount_due||"",status:n.status||"draft",payment_terms:n.payment_terms||"",payment_type:n.payment_type||"",note:n.note||"",ppn:n.ppn||"",pph:n.pph||"",total:n.total||""})}else w(t),v({invoice_number:t.invoice_number||"",date:t.date?t.date.split("T")[0]:"",invoice_amount:t.invoice_amount||"",amount_due:t.amount_due||"",status:t.status||"draft",payment_terms:t.payment_terms||"",payment_type:t.payment_type||"",note:t.note||"",ppn:t.ppn||"",pph:t.pph||"",total:t.total||""})}else w(t),v({invoice_number:t.invoice_number||"",date:t.date?t.date.split("T")[0]:"",invoice_amount:t.invoice_amount||"",amount_due:t.amount_due||"",status:t.status||"draft",payment_terms:t.payment_terms||"",payment_type:t.payment_type||"",note:t.note||"",ppn:t.ppn||"",pph:t.pph||"",total:t.total||""})}catch(a){console.error("Error fetching invoice data:",a),w(t),v({invoice_number:t.invoice_number||"",date:t.date?t.date.split("T")[0]:"",invoice_amount:t.invoice_amount||"",amount_due:t.amount_due||"",status:t.status||"draft",payment_terms:t.payment_terms||"",payment_type:t.payment_type||"",note:t.note||"",ppn:t.ppn||"",pph:t.pph||"",total:t.total||""})}finally{A(!1)}},D=()=>{w(null),v({invoice_number:"",date:"",invoice_amount:"",amount_due:"",status:"draft",payment_terms:"",payment_type:"",note:"",ppn:"",pph:"",total:""})},x=t=>{const{name:a,value:r}=t.target;v(n=>({...n,[a]:r}))},Q=async()=>{if(!(!$||!d))try{if(!i.invoice_number.trim()){alert("Invoice number is required");return}if(!i.date){alert("Date is required");return}if(!i.invoice_amount||i.invoice_amount<=0){alert("Invoice amount must be greater than 0");return}if(i.amount_due<0){alert("Amount due cannot be negative");return}if(parseFloat(i.amount_due)>999999999999){alert("Amount due is too large");return}b(!0);const t=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||"";console.log("Sending update data:",i);const a=await fetch(`/companies/${d}/invoices/${$.id}`,{method:"PUT",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":t,"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(i)}),r=await a.text();console.log("Raw response:",r);let n;try{n=JSON.parse(r)}catch(l){throw console.error("Failed to parse JSON response:",l),new Error(`Invalid JSON response: ${r.substring(0,200)}`)}if(!a.ok)throw new Error(`Failed to update invoice: ${a.status} ${a.statusText}. ${n.message||"Unknown error"}`);n.success?(alert("Invoice updated successfully!"),console.log("Update successful:",n),C.reload({only:["invoices"]})):(alert("Failed to update invoice: "+n.message),console.error("Update failed:",n))}catch(t){console.error("Error updating invoice:",t),alert("Failed to update invoice: "+t.message)}finally{b(!1),D()}},I=async t=>{if(!(!t||!d))try{if(!window.confirm(s("invoice_table.confirm_mark_paid")))return;b(!0);const r=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||"",n=await fetch(`/companies/${d}/invoices/${t}/mark-paid`,{method:"PUT",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":r,"X-Requested-With":"XMLHttpRequest"}});if(!n.ok){const m=await n.text();throw new Error(`Failed to mark invoice as paid: ${n.status} ${n.statusText}. ${m}`)}const l=await n.json();l.success?(alert("Invoice marked as paid successfully!"),C.reload({only:["invoices"]})):alert("Failed to mark invoice as paid: "+l.message)}catch(a){console.error("Error marking invoice as paid:",a),alert("Failed to mark invoice as paid: "+a.message)}finally{b(!1)}},Y=async t=>{if(!(!t||!d))try{b(!0),console.log("Attempting to delete invoice:",{invoiceId:t,companyId:d,url:`/companies/${d}/invoices/${t}`});const a=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||"";console.log("CSRF Token:",a?"Found":"Not found");const r=await fetch(`/companies/${d}/invoices/${t}`,{method:"DELETE",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":a,"X-Requested-With":"XMLHttpRequest"}});if(console.log("Response status:",r.status,r.statusText),!r.ok){const l=await r.text();throw console.error("Error response:",l),new Error(`Failed to delete invoice: ${r.status} ${r.statusText}. ${l}`)}const n=await r.json();console.log("Success result:",n),n.success?(alert("Invoice deleted successfully!"),C.reload({only:["invoices"]})):alert("Failed to delete invoice: "+n.message)}catch(a){console.error("Error deleting invoice:",a),alert("Failed to delete invoice: "+a.message)}finally{b(!1),T(null)}},Z=async()=>{if(!(u.length===0||!d||!window.confirm(s("invoice_table.confirm_bulk_delete",{count:u.length}))))try{b(!0);const a=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||"",r=await fetch(`/companies/${d}/invoices/bulk-delete`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":a,"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({invoice_ids:u})});if(!r.ok){const l=await r.text();throw new Error(`Failed to delete invoices: ${r.status} ${r.statusText}. ${l}`)}const n=await r.json();n.success?(alert(`Successfully deleted ${n.deleted_count} invoice(s)!`),M([]),C.reload({only:["invoices"]})):alert("Failed to delete invoices: "+n.message)}catch(a){console.error("Error deleting invoices:",a),alert("Failed to delete invoices: "+a.message)}finally{b(!1)}},ee=async()=>{if(!(u.length===0||!d||!window.confirm(s("invoice_table.confirm_bulk_mark_paid",{count:u.length}))))try{b(!0);const a=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||"",r=await fetch(`/companies/${d}/invoices/bulk-mark-paid`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":a,"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({invoice_ids:u})});if(!r.ok){const l=await r.text();throw new Error(`Failed to mark invoices as paid: ${r.status} ${r.statusText}. ${l}`)}const n=await r.json();n.success?(alert(`Successfully marked ${n.updated_count} invoice(s) as paid!`),M([]),C.reload({only:["invoices"]})):alert("Failed to mark invoices as paid: "+n.message)}catch(a){console.error("Error marking invoices as paid:",a),alert("Failed to mark invoices as paid: "+a.message)}finally{b(!1)}},te=({invoice:t})=>{const a=G(t.date);return e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 mb-3 hover:shadow-sm transition-shadow",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:u.includes(t.id),onChange:()=>O(t.id),className:"h-4 w-4 text-blue-600 rounded"}),e.jsx(S,{className:"w-5 h-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 text-sm",children:t.invoice_number||s("invoice_table.no_number")}),e.jsx("p",{className:"text-xs text-gray-500 cursor-help",onMouseEnter:()=>a.tooltip&&c(a.tooltip),onMouseLeave:()=>c(null),children:a.display})]})]}),X(t.status)]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(ce,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-xs text-gray-600",children:t.contact_person?.name||s("invoice_table.no_contact_person")})]}),t.quotation&&e.jsxs("div",{className:"text-xs text-gray-500",children:[s("invoice_table.quotation_label"),": ",t.quotation.quotation_number]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:s("invoice_table.amount")}),e.jsx("p",{className:"text-sm font-bold text-gray-900 cursor-help",onMouseEnter:()=>c(h(t.invoice_amount)),onMouseLeave:()=>c(null),children:g(t.invoice_amount)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:s("invoice_table.due")}),e.jsx("p",{className:"text-sm font-bold text-red-600 cursor-help",onMouseEnter:()=>c(h(t.amount_due)),onMouseLeave:()=>c(null),children:g(t.amount_due)})]})]}),e.jsxs("div",{className:"flex justify-between space-x-2",children:[e.jsxs("button",{className:"flex items-center space-x-1 px-3 py-1 bg-blue-50 text-blue-700 rounded text-xs hover:bg-blue-100",onClick:()=>B(t),children:[e.jsx(z,{className:"w-3 h-3"}),e.jsx("span",{children:s("invoice_table.edit")})]}),e.jsxs("button",{className:`flex items-center space-x-1 px-3 py-1 rounded text-xs ${t.status!=="paid"?"bg-green-50 text-green-700 hover:bg-green-100":"bg-gray-100 text-gray-500 cursor-not-allowed"}`,disabled:t.status==="paid",onClick:()=>t.status!=="paid"&&I(t.id),children:[e.jsx(q,{className:"w-3 h-3"}),e.jsx("span",{children:t.status!=="paid"?s("invoice_table.mark_paid"):s("invoice_table.paid")})]}),e.jsxs("button",{className:"flex items-center space-x-1 px-3 py-1 bg-red-50 text-red-700 rounded text-xs hover:bg-red-100",onClick:()=>T(t),children:[e.jsx(P,{className:"w-3 h-3"}),e.jsx("span",{children:s("invoice_table.delete")})]})]})]})};return!o||o.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(S,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:s("invoice_table.no_invoices_found")}),e.jsx("p",{className:"text-gray-500 max-w-md mx-auto mb-6",children:s("invoice_table.no_invoices_message")}),e.jsx("button",{className:"px-4 py-2 bg-[#054748] text-white rounded-lg hover:bg-[#0a5d5e] transition-colors",children:s("invoice_table.create_first_invoice")})]}):e.jsxs("div",{className:"relative",children:[E&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-xl max-w-md w-full mx-4",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(L,{className:"w-8 h-8 text-red-600 mr-3"}),e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:s("invoice_table.confirm_delete_title")})]}),e.jsx("p",{className:"text-gray-600 mb-6",children:s("invoice_table.confirm_delete_message",{invoice_number:E.invoice_number||s("invoice_table.no_number")})}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>T(null),className:"px-4 py-2 border border-gray-300 text-gray-700 rounded hover:bg-gray-50",children:s("invoice_table.cancel")}),e.jsx("button",{onClick:()=>Y(E.id),className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",disabled:y,children:y?e.jsx(H,{className:"w-4 h-4 animate-spin"}):s("invoice_table.delete")})]})]})}),$&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900",children:[s("invoice_table.edit_invoice")," - ",$.invoice_number]}),e.jsx("button",{onClick:D,className:"p-1 hover:bg-gray-100 rounded-full",children:e.jsx(ae,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s("invoice_table.invoice_number")," *"]}),e.jsx("input",{type:"text",name:"invoice_number",value:i.invoice_number,onChange:x,className:"w-full px-3 py-2 border border-gray-300 rounded focus:ring-blue-500 focus:border-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s("invoice_table.date")," *"]}),e.jsx("input",{type:"date",name:"date",value:i.date,onChange:x,className:"w-full px-3 py-2 border border-gray-300 rounded focus:ring-blue-500 focus:border-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s("invoice_table.invoice_amount")," *"]}),e.jsx("input",{type:"number",name:"invoice_amount",value:i.invoice_amount,onChange:x,className:"w-full px-3 py-2 border border-gray-300 rounded focus:ring-blue-500 focus:border-blue-500",required:!0,min:"0",max:"999999999999",step:"0.01"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s("invoice_table.amount_due")," *"]}),e.jsx("input",{type:"number",name:"amount_due",value:i.amount_due,onChange:x,className:"w-full px-3 py-2 border border-gray-300 rounded focus:ring-blue-500 focus:border-blue-500",required:!0,min:"0",max:"999999999999",step:"0.01"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s("invoice_table.status")," *"]}),e.jsxs("select",{name:"status",value:i.status,onChange:x,className:"w-full px-3 py-2 border border-gray-300 rounded focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"draft",children:s("invoice_table.status_draft")}),e.jsx("option",{value:"unpaid",children:s("invoice_table.status_unpaid")}),e.jsx("option",{value:"paid",children:s("invoice_table.status_paid")}),e.jsx("option",{value:"cancelled",children:s("invoice_table.status_cancelled")}),e.jsx("option",{value:"partial",children:s("invoice_table.status_partial")})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:s("invoice_table.payment_terms")}),e.jsx("input",{type:"text",name:"payment_terms",value:i.payment_terms,onChange:x,className:"w-full px-3 py-2 border border-gray-300 rounded focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:s("invoice_table.payment_type")}),e.jsxs("select",{name:"payment_type",value:i.payment_type,onChange:x,className:"w-full px-3 py-2 border border-gray-300 rounded focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:s("invoice_table.select_payment_type")}),e.jsx("option",{value:"cash",children:"Cash"}),e.jsx("option",{value:"transfer",children:"Transfer"}),e.jsx("option",{value:"check",children:"Check"}),e.jsx("option",{value:"credit_card",children:"Credit Card"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:s("invoice_table.total")}),e.jsx("input",{type:"number",name:"total",value:i.total,onChange:x,className:"w-full px-3 py-2 border border-gray-300 rounded focus:ring-blue-500 focus:border-blue-500"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"PPN"}),e.jsx("input",{type:"number",name:"ppn",value:i.ppn,onChange:x,className:"w-full px-3 py-2 border border-gray-300 rounded focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"PPH"}),e.jsx("input",{type:"number",name:"pph",value:i.pph,onChange:x,className:"w-full px-3 py-2 border border-gray-300 rounded focus:ring-blue-500 focus:border-blue-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:s("invoice_table.note")}),e.jsx("textarea",{name:"note",value:i.note,onChange:x,rows:"3",className:"w-full px-3 py-2 border border-gray-300 rounded focus:ring-blue-500 focus:border-blue-500"})]})]}),e.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[e.jsx("button",{onClick:D,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded hover:bg-gray-50",children:s("invoice_table.cancel")}),e.jsxs("button",{onClick:Q,className:"px-4 py-2 bg-[#054748] text-white rounded-lg hover:bg-[#0a5d5e] transition-colors flex items-center disabled:opacity-50 disabled:cursor-not-allowed",disabled:y,children:[y?e.jsx(H,{className:"w-4 h-4 animate-spin mr-2"}):e.jsx(re,{className:"w-4 h-4 mr-2"}),s("invoice_table.save")]})]})]})}),R&&e.jsx("div",{className:"fixed z-50 px-3 py-2 text-sm text-white bg-gray-900 rounded-lg shadow-lg pointer-events-none",children:R}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-lg md:text-xl font-bold text-gray-900",children:s("invoice_table.invoice_list")}),e.jsx("p",{className:"text-sm md:text-base text-gray-600",children:s("invoice_table.invoice_count",{count:o.length,plural:o.length!==1?"s":"",filteredCount:k.length,pluralFiltered:k.length!==1?"es":""})})]}),e.jsxs("div",{className:"mb-6 space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(ne,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:s("invoice_table.search_placeholder"),value:f,onChange:t=>W(t.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})}),e.jsx("div",{className:"w-full sm:w-48",children:e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:j,onChange:t=>K(t.target.value),className:"w-full pl-3 pr-10 py-2 border border-gray-300 rounded-lg appearance-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"all",children:s("invoice_table.all_status")}),e.jsx("option",{value:"paid",children:s("invoice_table.status_paid")}),e.jsx("option",{value:"unpaid",children:s("invoice_table.status_unpaid")}),e.jsx("option",{value:"invoice",children:s("invoice_table.status_invoice_sent")}),e.jsx("option",{value:"draft",children:s("invoice_table.status_draft")}),e.jsx("option",{value:"cancelled",children:s("invoice_table.status_cancelled")})]}),e.jsx(le,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5 pointer-events-none"})]})})]}),u.length>0&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(U,{className:"w-5 h-5 text-blue-600 mr-2"}),e.jsx("span",{className:"font-medium text-blue-800",children:s("invoice_table.selected_count",{count:u.length,plural:u.length!==1?"s":""})})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{className:"px-3 py-1 bg-green-600 text-white rounded text-sm hover:bg-green-700 flex items-center",onClick:ee,disabled:y,children:[e.jsx(q,{className:"w-4 h-4 inline mr-1"}),s("invoice_table.mark_as_paid")]}),e.jsxs("button",{className:"px-3 py-1 bg-red-600 text-white rounded text-sm hover:bg-red-700 flex items-center",onClick:Z,disabled:y,children:[e.jsx(P,{className:"w-4 h-4 inline mr-1"}),s("invoice_table.delete_selected")]})]})]})})]}),e.jsx("div",{className:"sm:hidden space-y-3",children:k.map(t=>e.jsx(te,{invoice:t},t.id))}),e.jsx("div",{className:"hidden sm:block",children:e.jsx("div",{className:"overflow-x-auto border border-gray-200 rounded-lg",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-[#eaf6f6]",children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase border-r border-gray-200",children:"No"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase border-r border-gray-200",children:"Invoice"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase border-r border-gray-200",children:"Invoice Amount"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase border-r border-gray-200",children:"Payment Term"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase border-r border-gray-200",children:"PPN & PPh"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase border-r border-gray-200",children:"Ammount Due"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase border-r border-gray-200",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase",children:"Action"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:k.map((t,a)=>e.jsxs("tr",{className:`hover:bg-gray-50 ${u.includes(t.id)?"bg-blue-50":""}`,children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx("input",{type:"checkbox",checked:u.includes(t.id),onChange:()=>O(t.id),className:"h-4 w-4 text-blue-600 rounded"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"font-medium text-gray-900",children:t.invoice_number||s("invoice_table.not_available")})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"font-semibold text-gray-900 cursor-help",onMouseEnter:()=>c(h(t.invoice_amount)),onMouseLeave:()=>c(null),children:g(t.invoice_amount)})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"text-gray-900",children:t.payment_terms||s("invoice_table.not_available")})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"text-gray-900",children:[s("invoice_table.ppn"),": ",t.ppn||0," ",e.jsx("br",{}),s("invoice_table.pph"),": ",t.pph||0]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"font-bold text-red-600 cursor-help",onMouseEnter:()=>c(h(t.amount_due)),onMouseLeave:()=>c(null),children:g(t.amount_due)})}),e.jsx("td",{className:"px-4 py-3",children:X(t.status)}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{title:s("invoice_table.edit_invoice"),className:"p-1 text-blue-600 hover:text-blue-900 hover:bg-blue-50 rounded",onClick:()=>B(t),children:e.jsx(z,{className:"w-4 h-4"})}),e.jsx("button",{title:s("invoice_table.mark_as_paid"),className:`p-1 rounded ${t.status!=="paid"?"text-green-600 hover:text-green-900 hover:bg-green-50":"text-gray-400 cursor-not-allowed"}`,disabled:t.status==="paid"||y,onClick:()=>t.status!=="paid"&&I(t.id),children:e.jsx(q,{className:"w-4 h-4"})}),e.jsx("button",{title:s("invoice_table.delete_invoice"),className:"p-1 text-red-600 hover:text-red-900 hover:bg-red-50 rounded",onClick:()=>T(t),children:e.jsx(P,{className:"w-4 h-4"})})]})})]},t.id))})]})})}),e.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:s("invoice_table.invoice_summary")}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(S,{className:"w-5 h-5 text-blue-600 mr-2"}),e.jsx("p",{className:"text-sm text-gray-600",children:s("invoice_table.total_invoices")})]}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-2",children:o.length}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:s("invoice_table.match_filter",{count:k.length})})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(oe,{className:"w-5 h-5 text-green-600 mr-2"}),e.jsx("p",{className:"text-sm text-gray-600",children:s("invoice_table.total_amount")})]}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-2 cursor-help",onMouseEnter:()=>c(h(o.reduce((t,a)=>t+(a.invoice_amount||0),0))),onMouseLeave:()=>c(null),children:g(o.reduce((t,a)=>t+(a.invoice_amount||0),0))}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:s("invoice_table.all_invoices")})]}),e.jsxs("div",{className:"bg-red-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(L,{className:"w-5 h-5 text-red-600 mr-2"}),e.jsx("p",{className:"text-sm text-gray-600",children:s("invoice_table.total_due")})]}),e.jsx("p",{className:"text-2xl font-bold text-red-600 mt-2 cursor-help",onMouseEnter:()=>c(h(o.reduce((t,a)=>t+(a.amount_due||0),0))),onMouseLeave:()=>c(null),children:g(o.reduce((t,a)=>t+(a.amount_due||0),0))}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:s("invoice_table.unpaid_balance")})]}),e.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(ie,{className:"w-5 h-5 text-purple-600 mr-2"}),e.jsx("p",{className:"text-sm text-gray-600",children:s("invoice_table.tax_summary")})]}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-2 cursor-help",onMouseEnter:()=>{const t=o.reduce((r,n)=>r+(n.ppn||0),0),a=o.reduce((r,n)=>r+(n.pph||0),0);c(`${s("invoice_table.ppn")}: ${h(t)}
${s("invoice_table.pph")}: ${h(a)}`)},onMouseLeave:()=>c(null),children:g(o.reduce((t,a)=>t+(a.ppn||0),0))}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:s("invoice_table.total_ppn")})]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600",children:s("invoice_table.paid_invoices")}),e.jsx("p",{className:"text-xl font-bold text-green-600",children:o.filter(t=>t.status==="paid").length})]}),e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600",children:s("invoice_table.unpaid_invoices")}),e.jsx("p",{className:"text-xl font-bold text-yellow-600",children:o.filter(t=>t.status==="unpaid").length})]}),e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600",children:s("invoice_table.average_invoice")}),e.jsx("p",{className:"text-xl font-bold text-blue-600 cursor-help",onMouseEnter:()=>{const t=o.length>0?o.reduce((a,r)=>a+(r.invoice_amount||0),0)/o.length:0;c(h(t))},onMouseLeave:()=>c(null),children:g(o.length>0?o.reduce((t,a)=>t+(a.invoice_amount||0),0)/o.length:0)})]})]})]}),!1]})};export{Le as default};
