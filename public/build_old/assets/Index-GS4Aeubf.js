import{a as re,r as d,b as D,j as e,c as z}from"./app-D-CXuYp-.js";import{H as ce}from"./HeaderLayout-DNM94YMu.js";import{T as ie}from"./TableLayout-DegOKxQR.js";import{u as te}from"./useTranslation-C5DOJpQ8.js";import{X as Y}from"./x-7oBENnvo.js";import{F as J}from"./file-text-cCH1Ukzd.js";import{T as G}from"./triangle-alert-CnUCNYNG.js";import{C as K}from"./circle-alert-DIyWWGnv.js";import{S as le}from"./search-BSE1nh5m.js";import{C as de}from"./chevron-down-D5S3ga3K.js";import{B as ee}from"./building-BasvS8Ni.js";import{U as ne}from"./user-FnYjhWZf.js";import{C as me}from"./check-BdhqU_fL.js";import{B as pe}from"./briefcase-MmDWfAjW.js";import{M as xe}from"./mail-CPS2hZM_.js";import{P as ue}from"./phone-CLSBwmXQ.js";import{c as se}from"./createLucideIcon-Da68c0mB.js";import{M as he}from"./map-pin-ugqY3VG7.js";import{T as oe}from"./trash-2-C428PtZi.js";import{I as ge}from"./info-C0m5B7C5.js";import{C as _e}from"./circle-check-big-DBPc4ZFd.js";import{C as be}from"./chevron-right-6qHYXvPl.js";import{P as fe}from"./plus-9mmXNL9j.js";import"./transition-Dd6dQS9p.js";import"./index-Dml3iHVq.js";import"./settings--wXcYxvN.js";import"./send-WSU91zWN.js";import"./globe-Ct8OYrI2.js";const je=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],ye=se("lock",je);const ve=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]],Ne=se("shield-alert",ve);const we=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],Ce=se("smartphone",we);const ke=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Se=se("upload",ke),Ee=({isOpen:w,onClose:U,clientTypes:a,quotationId:p,onSuccess:L})=>{const{flash:r}=re().props,{t}=te(),[l,c]=d.useState({company_name:"",client_type_id:"",contact_person:"",contact_email:"",contact_phone:"",contact_position:"",city:"",province:"",country:"",postal_code:"",vat_number:"",nib:"",website:"",logo:null,status:"active",quotation_id:p||"",lead_id:""}),[m,C]=d.useState({}),[A,k]=d.useState(!1),[F,S]=d.useState(null),[X,Q]=d.useState([]),[$,q]=d.useState(!1),[_,O]=d.useState(null),[P,b]=d.useState(""),[h,T]=d.useState(null),[V,f]=d.useState(!1),[i,x]=d.useState(null),g=()=>{const o=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content");return console.log("CSRF Token found:",o?"Yes":"No"),o};d.useEffect(()=>{const o=g();D.defaults.headers.common["X-Requested-With"]="XMLHttpRequest",D.defaults.withCredentials=!0,o?(D.defaults.headers.common["X-CSRF-TOKEN"]=o,console.log("CSRF Token set for axios")):console.warn("CSRF Token not found!"),D.defaults.headers.common.Accept="application/json"},[]),d.useEffect(()=>{w&&(console.log("Modal opened..."),c({company_name:"",client_type_id:"",contact_person:"",contact_email:"",contact_phone:"",contact_position:"",city:"",province:"",country:"",postal_code:"",vat_number:"",nib:"",website:"",logo:null,status:"active",quotation_id:p||"",lead_id:""}),O(null),T(null),b(""),S(null),C({}),x(null),p?M(p):E())},[w,p]);const E=async()=>{q(!0);try{const o=g(),u=await D.get("/companies/get-accepted-quotations",{headers:{"X-CSRF-TOKEN":o,Accept:"application/json"}});u&&u.data&&u.data.success?(Q(u.data.data||[]),u.data.data&&u.data.data.length===0&&x({type:"info",message:t("companies_create.no_available_quotations")})):Q([])}catch(o){console.error("Error fetching quotations:",o),Q([])}finally{q(!1)}},I=async o=>{x(null),O(o),T(null),c(u=>({...u,quotation_id:o.id,lead_id:o.lead?.id||"",company_name:o.lead?.company_name||u.company_name,contact_person:o.lead?.contact_person||u.contact_person,contact_email:o.lead?.email||u.contact_email,contact_phone:o.lead?.phone||u.contact_phone,contact_position:o.lead?.position||t("companies_create.contact_person"),vat_number:o.lead?.vat_number||"",nib:o.lead?.nib||"",website:o.lead?.website||""})),o.lead&&T(o.lead)},M=async o=>{if(o){f(!0),x(null);try{const u=g(),N=await D.get(`/companies/get-lead-from-quotation/${o}`,{headers:{"X-CSRF-TOKEN":u,Accept:"application/json"}});if(N&&N.data)if(N.data.success){const y=N.data.data;T(y),c(v=>({...v,quotation_id:o,lead_id:y.id||"",company_name:y.company_name||v.company_name,contact_person:y.contact_person||v.contact_person,contact_email:y.email||v.contact_email,contact_phone:y.phone||v.contact_phone,contact_position:y.position||t("companies_create.contact_person"),city:y.city||v.city,province:y.province||v.province,country:y.country||v.country,postal_code:y.postal_code||v.postal_code,vat_number:y.vat_number||"",nib:y.nib||"",website:y.website||""}))}else N.data.message&&(N.data.message.includes("sudah digunakan")||N.data.message.includes("already used"))?(x({type:"error",message:N.data.message,company_name:N.data.company_name,company_id:N.data.company_id}),c(y=>({...y,quotation_id:"",lead_id:""}))):alert(N.data.message||t("companies_create.error_fetching_lead"))}catch(u){console.error("Error fetching lead:",u),u.response?.status===400&&u.response?.data?.message?(u.response.data.message.includes("sudah digunakan")||u.response.data.message.includes("already used"))&&(x({type:"error",message:u.response.data.message,company_name:u.response.data.company_name,company_id:u.response.data.company_id}),c(N=>({...N,quotation_id:"",lead_id:""}))):alert(t("companies_create.error_fetching_lead"))}finally{f(!1)}}},B=()=>{O(null),T(null),x(null),c(o=>({...o,quotation_id:"",lead_id:"",company_name:"",contact_person:"",contact_email:"",contact_phone:"",vat_number:"",nib:"",website:"",city:"",province:"",country:"",postal_code:""})),b("")},H=X.filter(o=>{if(!P)return!0;const u=P.toLowerCase();return o.quotation_number?.toLowerCase().includes(u)||o.subject?.toLowerCase().includes(u)||o.lead?.company_name?.toLowerCase().includes(u)||o.lead?.contact_person?.toLowerCase().includes(u)}),R=o=>{const{name:u,value:N,type:y,files:v}=o.target;if(y==="file"){const s=v[0];if(c(n=>({...n,[u]:s})),s){const n=new FileReader;n.onloadend=()=>{S(n.result)},n.readAsDataURL(s)}else S(null)}else c(s=>({...s,[u]:N}));m[u]&&C(s=>({...s,[u]:null}))},ae=async o=>{o.preventDefault(),k(!0),C({}),console.log("=== FORM SUBMISSION STARTED ==="),console.log("Form data before submit:",l);const u=["company_name","client_type_id","contact_person","contact_email","contact_phone","status"];let N=!1;const y={};if(u.forEach(n=>{l[n]||(y[n]=t("companies_create.field_required",{field:n.replace("_"," ")}),N=!0)}),N){C(y),k(!1);return}const v=new FormData,s=g();s&&v.append("_token",s),Object.entries(l).forEach(([n,j])=>{j!=null&&j!==""&&(n==="logo"&&j instanceof File?v.append("logo",j):v.append(n,j.toString()))}),l.contact_person&&v.append("name",l.contact_person),p&&!l.quotation_id&&v.append("quotation_id",p);try{console.log("Sending form data..."),console.log("CSRF Token to send:",s);const n=await D.post("/companies",v,{headers:{"Content-Type":"multipart/form-data"}});console.log("Server response:",n),n&&n.data&&n.data.success?(alert(n.data.message||t("companies_create.client_created_successfully")),U(),c({company_name:"",client_type_id:"",contact_person:"",contact_email:"",contact_phone:"",contact_position:"",city:"",province:"",country:"",postal_code:"",vat_number:"",nib:"",website:"",logo:null,status:"active",quotation_id:"",lead_id:""}),O(null),T(null),x(null),S(null),L&&L(),z.reload({only:["companies","statistics"],preserveScroll:!0})):(C(n?.data?.errors||{}),alert(n?.data?.message||t("companies_create.failed_to_create_client")))}catch(n){if(console.error("Error creating client:",n),console.error("Error details:",n.response?.data),n.response?.status===419){const j=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content");console.log("Current CSRF token:",j),alert("CSRF token expired. Please refresh the page and try again."),window.location.reload()}else if(n.response?.status===422){C(n.response.data.errors||{});const j=Object.values(n.response.data.errors||{}).flat().join(`
`);j&&alert(t("companies_create.validation_errors")+`
`+j)}else n.response?.status===400&&n.response?.data?.message?n.response.data.message.includes("already used")||n.response.data.message.includes("sudah digunakan")?(x({type:"error",message:n.response.data.message,company_name:n.response.data.company_name,company_id:n.response.data.company_id}),alert(t("companies_create.quotation_already_used"))):alert(n.response.data.message||t("companies_create.error_creating_client")):alert(`${t("companies_create.error_creating_client")}: ${n.response?.data?.message||n.message}`)}finally{k(!1)}};return w?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-hidden",children:[e.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:t("companies_create.title")}),e.jsx("p",{className:"text-gray-600 mt-1",children:t("companies_create.subtitle")}),p&&e.jsxs("div",{className:"mt-1 text-sm text-blue-600",children:[t("companies_create.creating_from_quotation"),": ",e.jsx("strong",{children:p})]})]}),e.jsx("button",{onClick:U,className:"p-2 hover:bg-gray-100 rounded-lg transition",children:e.jsx(Y,{className:"w-6 h-6 text-gray-500"})})]}),e.jsxs("form",{onSubmit:ae,className:"overflow-y-auto max-h-[calc(90vh-200px)]",children:[e.jsxs("div",{className:"p-6 space-y-6",children:[!p&&e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsxs("h3",{className:"font-medium text-blue-900 mb-3 flex items-center gap-2",children:[e.jsx(J,{className:"w-5 h-5"}),t("companies_create.select_from_quotation")]}),i&&e.jsxs("div",{className:`mb-4 p-3 rounded-lg flex items-start gap-2 ${i.type==="error"?"bg-red-100 border border-red-300 text-red-800":"bg-yellow-100 border border-yellow-300 text-yellow-800"}`,children:[i.type==="error"?e.jsx(G,{className:"w-5 h-5 flex-shrink-0 mt-0.5"}):e.jsx(K,{className:"w-5 h-5 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium",children:i.message}),i.company_name&&e.jsxs("p",{className:"text-sm mt-1",children:[t("companies_create.already_has_company"),":",e.jsx("strong",{className:"ml-1",children:i.company_name}),i.company_id&&e.jsxs("span",{className:"ml-2 text-xs",children:["(ID: ",i.company_id,")"]})]})]})]}),$?e.jsxs("div",{className:"text-center py-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:t("companies_create.loading_quotations")})]}):e.jsx("div",{className:"space-y-3",children:_?e.jsx("div",{className:"bg-white border border-green-300 rounded-lg p-4",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-green-700",children:_.quotation_number}),e.jsx("span",{className:"px-2 py-1 text-xs bg-green-100 text-green-800 rounded",children:t("companies_create.accepted")}),e.jsx("span",{className:"px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded",children:t("companies_create.unused")})]}),e.jsx("div",{className:"text-sm text-gray-600 mt-1",children:_.subject}),_.lead&&e.jsx("div",{className:"mt-2 text-sm",children:e.jsx("div",{className:"font-medium text-gray-700",children:_.lead.company_name})})]}),e.jsx("button",{type:"button",onClick:B,className:"text-gray-400 hover:text-gray-600 p-1",children:e.jsx(Y,{className:"w-5 h-5"})})]})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative",children:[e.jsx(le,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:t("companies_create.search_quotations"),value:P,onChange:o=>b(o.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsx("div",{className:"max-h-60 overflow-y-auto border border-gray-200 rounded-lg",children:H.length>0?H.map(o=>e.jsx("div",{onClick:()=>I(o),className:"p-3 border-b border-gray-100 hover:bg-gray-50 cursor-pointer transition last:border-b-0",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-medium text-gray-900",children:o.quotation_number}),e.jsx("span",{className:"px-2 py-0.5 text-xs bg-green-100 text-green-800 rounded",children:t("companies_create.accepted")}),e.jsx("span",{className:"px-2 py-0.5 text-xs bg-blue-100 text-blue-800 rounded",children:t("companies_create.unused")})]}),e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:o.subject}),o.lead&&e.jsxs("div",{className:"text-xs text-gray-500",children:[o.lead.company_name," â€¢ ",o.lead.contact_person]})]}),e.jsx(de,{className:"w-5 h-5 text-gray-400"})]})},o.id)):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-12 h-12 rounded-full bg-gray-100 mb-3",children:e.jsx(J,{className:"w-6 h-6 text-gray-400"})}),e.jsx("p",{className:"text-sm text-gray-600 font-medium",children:t(P?"companies_create.no_quotations_found_search":"companies_create.no_available_quotations")}),!P&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:t("companies_create.all_quotations_used")})]})}),e.jsxs("div",{className:"mt-3 p-2 bg-gray-50 border border-gray-200 rounded text-xs text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500"}),e.jsx("span",{children:t("companies_create.available_quotations")})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-gray-400"}),e.jsx("span",{children:t("companies_create.used_quotations_hidden")})]})]}),e.jsx("p",{className:"mt-1",children:t("companies_create.only_unused_quotations_shown")})]})]})})]}),p&&i&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(G,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-red-800",children:t("companies_create.quotation_unavailable")}),e.jsx("p",{className:"text-sm text-red-700 mt-1",children:i.message}),i.company_name&&e.jsxs("div",{className:"mt-2 p-2 bg-red-100 rounded",children:[e.jsx("p",{className:"text-sm font-medium",children:t("companies_create.quotation_already_used_by")}),e.jsxs("p",{className:"text-sm",children:[i.company_name,i.company_id&&e.jsxs("span",{className:"ml-2 text-xs",children:["(ID: ",i.company_id,")"]})]})]})]})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(ee,{className:"w-5 h-5"}),t("companies_create.company_information")]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[t("companies_create.company_name")," ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{type:"text",name:"company_name",value:l.company_name,onChange:R,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 ${m.company_name?"border-red-300":"border-gray-300"}`,required:!0,placeholder:t("companies_create.company_name_placeholder"),disabled:!p&&!_}),m.company_name&&e.jsx("p",{className:"text-xs text-red-600 mt-1",children:m.company_name})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[t("companies_create.client_type")," ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsxs("select",{name:"client_type_id",value:l.client_type_id,onChange:R,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 ${m.client_type_id?"border-red-300":"border-gray-300"}`,required:!0,disabled:!p&&!_,children:[e.jsx("option",{value:"",children:t("companies_create.select_client_type")}),a&&a.map(o=>e.jsx("option",{value:o.id,children:o.name},o.id))]}),m.client_type_id&&e.jsx("p",{className:"text-xs text-red-600 mt-1",children:m.client_type_id})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[t("companies_create.city")," ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{type:"text",name:"city",value:l.city,onChange:R,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 ${m.city?"border-red-300":"border-gray-300"}`,required:!0,placeholder:t("companies_create.city_placeholder"),disabled:!p&&!_}),m.city&&e.jsx("p",{className:"text-xs text-red-600 mt-1",children:m.city})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[t("companies_create.province")," ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{type:"text",name:"province",value:l.province,onChange:R,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 ${m.province?"border-red-300":"border-gray-300"}`,required:!0,placeholder:t("companies_create.province_placeholder"),disabled:!p&&!_}),m.province&&e.jsx("p",{className:"text-xs text-red-600 mt-1",children:m.province})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[t("companies_create.country")," ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{type:"text",name:"country",value:l.country,onChange:R,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 ${m.country?"border-red-300":"border-gray-300"}`,required:!0,placeholder:t("companies_create.country_placeholder"),disabled:!p&&!_}),m.country&&e.jsx("p",{className:"text-xs text-red-600 mt-1",children:m.country})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[t("companies_create.postal_code")," ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{type:"text",name:"postal_code",value:l.postal_code,onChange:R,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 ${m.postal_code?"border-red-300":"border-gray-300"}`,required:!0,placeholder:t("companies_create.postal_code_placeholder"),disabled:!p&&!_}),m.postal_code&&e.jsx("p",{className:"text-xs text-red-600 mt-1",children:m.postal_code})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:t("companies_create.vat_number")}),e.jsx("input",{type:"text",name:"vat_number",value:l.vat_number,onChange:R,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500",placeholder:t("companies_create.vat_number_placeholder"),disabled:!p&&!_})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:t("companies_create.nib")}),e.jsx("input",{type:"text",name:"nib",value:l.nib,onChange:R,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500",placeholder:t("companies_create.nib_placeholder"),disabled:!p&&!_})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:t("companies_create.website")}),e.jsx("input",{type:"url",name:"website",value:l.website,onChange:R,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500",placeholder:t("companies_create.website_placeholder"),disabled:!p&&!_})]})]})]}),e.jsxs("div",{className:"border-t pt-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2 mb-4",children:[e.jsx(ne,{className:"w-5 h-5"}),t("companies_create.contact_information")]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[t("companies_create.contact_person")," ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{type:"text",name:"contact_person",value:l.contact_person,onChange:R,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 ${m.contact_person?"border-red-300":"border-gray-300"}`,required:!0,placeholder:t("companies_create.contact_person_placeholder"),disabled:!p&&!_}),m.contact_person&&e.jsx("p",{className:"text-xs text-red-600 mt-1",children:m.contact_person})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[t("companies_create.position")," ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{type:"text",name:"contact_position",value:l.contact_position,onChange:R,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 ${m.contact_position?"border-red-300":"border-gray-300"}`,required:!0,placeholder:t("companies_create.position_placeholder"),disabled:!p&&!_}),m.contact_position&&e.jsx("p",{className:"text-xs text-red-600 mt-1",children:m.contact_position})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[t("companies_create.email")," ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{type:"email",name:"contact_email",value:l.contact_email,onChange:R,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 ${m.contact_email?"border-red-300":"border-gray-300"}`,required:!0,placeholder:t("companies_create.email_placeholder"),disabled:!p&&!_}),m.contact_email&&e.jsx("p",{className:"text-xs text-red-600 mt-1",children:m.contact_email})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[t("companies_create.phone")," ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{type:"tel",name:"contact_phone",value:l.contact_phone,onChange:R,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 ${m.contact_phone?"border-red-300":"border-gray-300"}`,required:!0,placeholder:t("companies_create.phone_placeholder"),disabled:!p&&!_}),m.contact_phone&&e.jsx("p",{className:"text-xs text-red-600 mt-1",children:m.contact_phone})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 pt-6 border-t",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:t("companies_create.company_logo")}),e.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4 hover:border-teal-500 transition",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("input",{type:"file",name:"logo",onChange:R,accept:"image/*",className:"w-full border border-gray-300 rounded-lg px-3 py-2.5 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:!p&&!_}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:t("companies_create.file_requirements")})]}),F&&e.jsx("div",{className:"w-16 h-16",children:e.jsx("img",{src:F,alt:t("companies_create.logo_preview"),className:"w-full h-full object-cover rounded-lg border border-gray-300"})})]})})]})})]}),e.jsxs("div",{className:"bg-gray-50 px-6 py-4 border-t flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:U,disabled:A,className:"px-4 py-2 text-gray-700 hover:text-gray-900 font-medium",children:t("companies_create.cancel")}),e.jsx("button",{type:"submit",disabled:A||!p&&!_||i,className:`px-6 py-2 font-medium rounded-lg flex items-center gap-2 ${A||!p&&!_||i?"bg-gray-400 text-white cursor-not-allowed":"bg-teal-700 hover:bg-teal-800 text-white"}`,children:A?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),t("companies_create.creating")]}):t("companies_create.create_client")})]})]})]})}):null},Le=({isOpen:w,onClose:U,company:a,clientTypes:p,onUpdate:L})=>{const{t:r}=te(),[t,l]=d.useState({company_name:"",client_type_id:"",status:"active",city:"",province:"",country:"",postal_code:"",vat_number:"",nib:"",website:"",logo:null,logo_preview:"",delete_logo:!1,contact_person:"",contact_email:"",contact_phone:"",contact_position:""}),[c,m]=d.useState({}),[C,A]=d.useState(!1),[k,F]=d.useState(null),[S,X]=d.useState(!1),[Q,$]=d.useState(!1),[q,_]=d.useState(!1),O=d.useRef(!1);d.useEffect(()=>{D.defaults.headers.common["X-Requested-With"]="XMLHttpRequest",D.defaults.withCredentials=!0;const f=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content");f&&(D.defaults.headers.common["X-CSRF-TOKEN"]=f)},[]),d.useEffect(()=>((async()=>{if(!(!w||!a||p.length===0||O.current)){O.current=!0,_(!1),console.log("=== EDIT MODAL INITIALIZATION ==="),console.log("Full company data received:",a),console.log("Lead data:",a.lead),console.log("Primary contact:",a.primary_contact),console.log("Client Types available:",p);try{const i=a.company_name||a.lead?.company_name||a.client_code||a.name||"",x={contact_person:a.contact_person||a.primary_contact?.name||a.lead?.contact_person||"",contact_email:a.contact_email||a.email||a.primary_contact?.email||a.lead?.email||"",contact_phone:a.contact_phone||a.phone||a.primary_contact?.phone||a.lead?.phone||"",contact_position:a.contact_position||a.primary_contact?.position||a.lead?.position||""};console.log("Company Name resolved:",{fromProp:a.company_name,fromLead:a.lead?.company_name,fromClientCode:a.client_code,fromName:a.name,finalValue:i}),console.log("Contact data resolved:",x);const g={company_name:i,client_type_id:a.client_type_id||(p.length>0?p[0].id:""),status:a.is_active?"active":"inactive",city:a.city||"",province:a.province||"",country:a.country||"",postal_code:a.postal_code?.toString()||"",vat_number:a.vat_number?.toString()||"",nib:a.nib||"",website:a.website||"",logo:null,logo_preview:a.logo_url||"",delete_logo:!1,contact_person:x.contact_person,contact_email:x.contact_email,contact_phone:x.contact_phone,contact_position:x.contact_position};console.log("Form data to be set:",g),l(g);const E=x.contact_person||x.contact_email||x.contact_phone;$(!!E),!E&&a.id&&await P(a.id,g),console.log("=== FORM INITIALIZED SUCCESSFULLY ===")}catch(i){console.error("Error during form initialization:",i)}finally{_(!0),O.current=!1}}})(),()=>{t.logo_preview&&t.logo_preview.startsWith("blob:")&&URL.revokeObjectURL(t.logo_preview)}),[w,a,p]);const P=async(f,i)=>{X(!0);try{console.log("Fetching contact data from API for company:",f);const x=await D.get(`/api/companies/${f}/primary-contact`);if(x.data.success&&x.data.data){const g=x.data.data;console.log("Contact API data received:",g),l(E=>({...E,contact_person:g.name||"",contact_email:g.email||"",contact_phone:g.phone||"",contact_position:g.position||""})),$(!0)}else console.log("No contact data from API"),$(!1)}catch(x){console.error("Error fetching contact data:",x),$(!1)}finally{X(!1)}},b=f=>{const{name:i,value:x,type:g,checked:E,files:I}=f.target;if(i==="company_name"){console.log("Company name is read-only, ignoring change attempt");return}if(g==="radio")l(M=>({...M,[i]:x}));else if(g==="file"){const M=I[0];if(M){F(M);const B=URL.createObjectURL(M);l(H=>({...H,logo:M,logo_preview:B,delete_logo:!1}))}}else l(M=>({...M,[i]:x}));c[i]&&m(M=>({...M,[i]:null}))},h=()=>{t.logo_preview&&t.logo_preview.startsWith("blob:")&&URL.revokeObjectURL(t.logo_preview),l(f=>({...f,logo:null,logo_preview:"",delete_logo:!0})),F(null)},T=async f=>{f.preventDefault(),A(!0),m({});try{const i={company_name:t.company_name||"",client_type_id:t.client_type_id||"",status:t.status||"active",city:t.city||"",province:t.province||"",country:t.country||"",postal_code:t.postal_code&&parseInt(t.postal_code)||null,vat_number:t.vat_number&&parseInt(t.vat_number)||null,nib:t.nib||"",website:t.website||"",contact_person:t.contact_person||"",contact_email:t.contact_email||"",contact_phone:t.contact_phone||"",contact_position:t.contact_position||"",delete_logo:t.delete_logo?"1":"0"};console.log("=== SUBMITTING UPDATE DATA ==="),console.log("Company ID:",a.id),console.log("Company Name (read-only, for validation):",i.company_name),console.log("Client Code (will remain unchanged):",a.client_code),console.log("Full request data:",i);const x=new FormData;Object.keys(i).forEach(E=>{i[E]!==null&&i[E]!==void 0&&x.append(E,i[E])}),t.logo&&(x.append("logo",t.logo),console.log("Logo file appended:",t.logo.name));const g=await D.post(`/companies/${a.id}`,x,{headers:{"Content-Type":"multipart/form-data",Accept:"application/json"},params:{_method:"PUT"}});console.log("Server response:",g.data),g.data.success?(alert(g.data.message||r("companies_edit.client_updated_successfully")),t.logo_preview&&t.logo_preview.startsWith("blob:")&&URL.revokeObjectURL(t.logo_preview),L&&L(g.data.data||a.id),z.reload({only:["companies","statistics"],preserveScroll:!0}),U()):(console.error("Update failed:",g.data),m(g.data.errors||{}),alert(g.data.message||r("companies_edit.failed_to_update_client")))}catch(i){if(console.error("Error updating client:",i),i.response?.status===422){const x=i.response.data.errors||{};m(x),console.log("Validation errors:",x);const g=Object.entries(x).map(([E,I])=>Array.isArray(I)?`${E}: ${I.join(", ")}`:`${E}: ${I}`);g.length>0?alert(`${r("companies_edit.validation_errors")}:
${g.join(`
`)}`):alert(r("companies_edit.check_form_errors"))}else{const x=i.response?.data?.message||i.message||r("companies_edit.error_occurred");m(g=>({...g,submit:x})),alert(`${r("companies_edit.error_updating_client")}: ${x}`)}}finally{A(!1)}},V=()=>{t.logo_preview&&t.logo_preview.startsWith("blob:")&&URL.revokeObjectURL(t.logo_preview),U()};return!w||!a||!q?null:e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-6xl max-h-[95vh] overflow-hidden",children:[e.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:r("companies_edit.title")}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsxs("p",{className:"text-gray-600",children:[r("companies_edit.editing"),": ",e.jsx("span",{className:"font-medium",children:a.client_code})]}),a.id&&e.jsxs("span",{className:"text-xs bg-gray-100 px-2 py-1 rounded text-gray-500",children:["ID: ",a.id]})]}),e.jsxs("div",{className:"mt-1 text-sm",children:[e.jsx("span",{className:"text-gray-700 font-medium",children:"Company Name: "}),e.jsx("span",{className:"text-blue-600 font-semibold",children:t.company_name}),e.jsx("span",{className:"ml-2 text-xs text-gray-500",children:"(Read Only - from Leads)"})]}),S?e.jsxs("p",{className:"text-sm text-blue-600 mt-1 flex items-center gap-1",children:[e.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-blue-600"}),r("companies_edit.loading_contact_data")]}):Q?e.jsxs("p",{className:"text-sm text-green-600 mt-1 flex items-center gap-1",children:[e.jsx(me,{className:"w-3 h-3"}),r("companies_edit.contact_data_loaded")]}):e.jsxs("p",{className:"text-sm text-yellow-600 mt-1 flex items-center gap-1",children:[e.jsx(K,{className:"w-3 h-3"}),r("companies_edit.no_contact_data")]})]}),e.jsx("button",{onClick:V,className:"p-2 hover:bg-gray-100 rounded-lg transition",disabled:C,children:e.jsx(Y,{className:"w-6 h-6 text-gray-500"})})]}),e.jsxs("form",{onSubmit:T,className:"overflow-y-auto max-h-[calc(95vh-180px)]",children:[e.jsxs("div",{className:"p-6 space-y-8",children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-xl p-6",children:[e.jsxs("h3",{className:"text-xl font-bold text-blue-900 mb-4 flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(ne,{className:"w-6 h-6 text-blue-600"})}),r("companies_edit.contact_person_information")]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2",children:[e.jsx(ne,{className:"w-4 h-4 text-blue-500"}),r("companies_edit.contact_person_name")," *"]}),e.jsx("input",{type:"text",name:"contact_person",value:t.contact_person,onChange:b,className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition ${c.contact_person?"border-red-300 bg-red-50":"border-blue-200"}`,placeholder:r("companies_edit.contact_person_placeholder"),required:!0}),c.contact_person&&e.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[e.jsx(K,{className:"w-3 h-3"}),c.contact_person]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2",children:[e.jsx(pe,{className:"w-4 h-4 text-blue-500"}),r("companies_edit.position")]}),e.jsx("input",{type:"text",name:"contact_position",value:t.contact_position,onChange:b,className:"w-full px-4 py-3 border border-blue-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",placeholder:r("companies_edit.position_placeholder")})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2",children:[e.jsx(xe,{className:"w-4 h-4 text-blue-500"}),r("companies_edit.email_address")," *"]}),e.jsx("input",{type:"email",name:"contact_email",value:t.contact_email,onChange:b,className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition ${c.contact_email?"border-red-300 bg-red-50":"border-blue-200"}`,placeholder:r("companies_edit.email_placeholder"),required:!0}),c.contact_email&&e.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[e.jsx(K,{className:"w-3 h-3"}),c.contact_email]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2",children:[e.jsx(ue,{className:"w-4 h-4 text-blue-500"}),r("companies_edit.phone_number")," *"]}),e.jsx("input",{type:"tel",name:"contact_phone",value:t.contact_phone,onChange:b,className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition ${c.contact_phone?"border-red-300 bg-red-50":"border-blue-200"}`,placeholder:r("companies_edit.phone_placeholder"),required:!0}),c.contact_phone&&e.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[e.jsx(K,{className:"w-3 h-3"}),c.contact_phone]}),e.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[e.jsx(Ce,{className:"w-3 h-3"}),r("companies_edit.phone_format")]})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-teal-50 to-emerald-50 border border-teal-200 rounded-xl p-6",children:[e.jsxs("h3",{className:"text-xl font-bold text-teal-900 mb-4 flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-teal-100 rounded-lg",children:e.jsx(ee,{className:"w-6 h-6 text-teal-600"})}),r("companies_edit.company_information")]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2",children:[e.jsx(ee,{className:"w-4 h-4 text-teal-500"}),r("companies_edit.company_name")," ",e.jsx("span",{className:"text-red-600",children:"*"}),e.jsx("span",{className:"ml-2 text-xs text-blue-600 font-normal bg-blue-50 px-2 py-0.5 rounded",children:"Read Only"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"w-full px-4 py-3 border border-teal-200 rounded-lg bg-gray-50 text-gray-800 flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center",children:e.jsx("div",{className:"font-medium",children:t.company_name})}),e.jsxs("div",{className:"flex items-center text-gray-500",children:[e.jsx(ye,{className:"w-4 h-4 mr-1"}),e.jsx("span",{className:"text-xs",children:"Locked"})]})]}),e.jsx("input",{type:"hidden",name:"company_name",value:t.company_name,required:!0})]}),e.jsxs("div",{className:"mt-2 flex items-start text-xs text-gray-500",children:[e.jsx(K,{className:"w-3 h-3 mr-1 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Company name is retrieved from the associated Lead record and cannot be edited here. To change the company name, please update the corresponding Lead in the Leads section."})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:[r("companies_edit.client_type")," ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsxs("select",{name:"client_type_id",value:t.client_type_id,onChange:b,className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition ${c.client_type_id?"border-red-300 bg-red-50":"border-teal-200"}`,required:!0,children:[e.jsx("option",{value:"",children:r("companies_edit.select_client_type")}),p.map(f=>e.jsxs("option",{value:f.id,children:[f.name," ",f.information?`- ${f.information}`:""]},f.id))]}),c.client_type_id&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:c.client_type_id})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("h4",{className:"text-lg font-semibold text-gray-800 mb-3 flex items-center gap-2",children:[e.jsx(he,{className:"w-5 h-5 text-teal-600"}),r("companies_edit.location_information")]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r("companies_edit.city")," ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{type:"text",name:"city",value:t.city,onChange:b,className:"w-full px-3 py-2 border border-teal-200 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500",placeholder:r("companies_edit.city_placeholder"),required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r("companies_edit.province")," ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{type:"text",name:"province",value:t.province,onChange:b,className:"w-full px-3 py-2 border border-teal-200 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500",placeholder:r("companies_edit.province_placeholder"),required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r("companies_edit.country")," ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{type:"text",name:"country",value:t.country,onChange:b,className:"w-full px-3 py-2 border border-teal-200 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500",placeholder:r("companies_edit.country_placeholder"),required:!0})]})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("h4",{className:"text-lg font-semibold text-gray-800 mb-3 flex items-center gap-2",children:[e.jsx(J,{className:"w-5 h-5 text-teal-600"}),r("companies_edit.business_details")]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r("companies_edit.postal_code")," ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{type:"text",name:"postal_code",value:t.postal_code,onChange:b,className:"w-full px-3 py-2 border border-teal-200 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500",placeholder:r("companies_edit.postal_code_placeholder"),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:r("companies_edit.vat_number")}),e.jsx("input",{type:"text",name:"vat_number",value:t.vat_number,onChange:b,className:"w-full px-3 py-2 border border-teal-200 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500",placeholder:r("companies_edit.vat_number_placeholder")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:r("companies_edit.nib_number")}),e.jsx("input",{type:"text",name:"nib",value:t.nib,onChange:b,className:"w-full px-3 py-2 border border-teal-200 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500",placeholder:r("companies_edit.nib_placeholder")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:r("companies_edit.website")}),e.jsx("input",{type:"url",name:"website",value:t.website,onChange:b,className:"w-full px-3 py-2 border border-teal-200 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500",placeholder:r("companies_edit.website_placeholder")})]})]})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:r("companies_edit.company_logo")}),t.logo_preview?e.jsx("div",{className:"relative",children:e.jsx("div",{className:"border-2 border-dashed border-teal-300 rounded-xl p-4 bg-gradient-to-br from-teal-50 to-white",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("div",{className:"relative mb-4",children:[e.jsx("img",{src:t.logo_preview,alt:r("companies_edit.logo_preview"),className:"w-40 h-40 object-contain rounded-xl shadow-md"}),e.jsx("button",{type:"button",onClick:h,className:"absolute -top-2 -right-2 bg-red-500 text-white p-2 rounded-full hover:bg-red-600 transition shadow-lg",title:r("companies_edit.remove_logo"),children:e.jsx(oe,{className:"w-4 h-4"})})]}),e.jsx("p",{className:"text-sm text-gray-500 text-center",children:r("companies_edit.current_logo")})]})})}):e.jsxs("div",{className:"border-2 border-dashed border-teal-300 rounded-xl p-6 text-center bg-gradient-to-br from-teal-50 to-white hover:border-teal-400 transition cursor-pointer",children:[e.jsx("input",{type:"file",id:"logo-upload",name:"logo",onChange:b,className:"hidden",accept:"image/*"}),e.jsxs("label",{htmlFor:"logo-upload",className:"cursor-pointer",children:[e.jsx(Se,{className:"w-12 h-12 text-teal-400 mx-auto mb-3"}),e.jsx("div",{className:"font-medium text-teal-700 hover:text-teal-800",children:r("companies_edit.upload_new_logo")}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:r("companies_edit.file_requirements")}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:r("companies_edit.recommended_size")})]})]})]})})]}),e.jsxs("div",{className:"bg-gradient-to-r from-gray-50 to-gray-100 px-6 py-4 border-t flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm text-gray-600",children:[r("companies_edit.editing_client"),": ",e.jsx("span",{className:"font-semibold",children:a.client_code})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsxs("p",{className:"text-xs text-gray-500",children:["Company Name: ",e.jsx("span",{className:"font-medium text-blue-600",children:t.company_name})]}),e.jsx("span",{className:"text-xs bg-gray-200 text-gray-700 px-2 py-0.5 rounded",children:"Read Only"})]}),S&&e.jsx("p",{className:"text-xs text-blue-600 mt-1",children:r("companies_edit.loading_contact_information")})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"button",onClick:V,disabled:C,className:"px-5 py-2.5 text-gray-700 hover:text-gray-900 font-medium disabled:opacity-50 hover:bg-gray-200 rounded-lg transition",children:r("companies_edit.cancel")}),e.jsx("button",{type:"submit",disabled:C,className:"px-6 py-2.5 bg-gradient-to-r from-teal-600 to-teal-700 hover:from-teal-700 hover:to-teal-800 text-white font-medium rounded-lg disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 transition-all shadow-md hover:shadow-lg",children:C?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),r("companies_edit.updating")]}):r("companies_edit.update_client_contact")})]})]})]})]})})},De=({isOpen:w,onClose:U,company:a,onDelete:p,isBulk:L=!1,selectedCount:r=0,selectedIds:t=[]})=>{const{t:l}=te(),[c,m]=d.useState(!1),[C,A]=d.useState(""),[k,F]=d.useState(""),[S,X]=d.useState(!1);if(d.useEffect(()=>{D.defaults.headers.common["X-Requested-With"]="XMLHttpRequest",D.defaults.withCredentials=!0;const h=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content");h&&(D.defaults.headers.common["X-CSRF-TOKEN"]=h)},[]),d.useEffect(()=>{const h=()=>{X(window.innerWidth<640)};return h(),window.addEventListener("resize",h),()=>window.removeEventListener("resize",h)},[]),d.useEffect(()=>{const h=T=>{T.key==="Escape"&&w&&q()};return document.addEventListener("keydown",h),()=>document.removeEventListener("keydown",h)},[w]),!w)return null;const Q=async()=>{m(!0),F("");try{let h;if(L&&t.length>0){const T=t.map(i=>D.delete(`/companies/${i}`)),f=(await Promise.all(T)).filter(i=>i.data?.success).length;if(f>0)h={data:{success:!0,message:l("companies_delete.bulk_delete_success",{count:f})}};else throw new Error(l("companies_delete.bulk_delete_failed"))}else if(a)h=await D.delete(`/companies/${a.id}`);else throw new Error(l("companies_delete.no_company_selected"));h.data.success?(alert(h.data.message||l("companies_delete.delete_success")),p&&p(),z.reload({only:["companies","statistics"],preserveScroll:!0}),U(),$()):(F(h.data.message||l("companies_delete.delete_failed")),alert(h.data.message||l("companies_delete.delete_failed")))}catch(h){console.error("Delete error:",h);const T=h.response?.data?.message||h.message||l("companies_delete.delete_error_try_again");F(T),alert(`${l("companies_delete.error")}: ${T}`)}finally{m(!1)}},$=()=>{A(""),F("")},q=()=>{$(),U()},_=()=>L?l("companies_delete.bulk_delete_title",{count:r}):l("companies_delete.delete_client"),O=()=>L?l("companies_delete.bulk_delete_message",{count:r}):l("companies_delete.delete_message",{name:a?.client_code||a?.name}),P=()=>L?l("companies_delete.bulk_confirmation",{count:r}):l("companies_delete.confirmation",{name:a?.client_code||a?.name});return(L?t.length>0:a)?e.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[e.jsx("div",{className:"fixed inset-0 bg-black/50",onClick:q}),e.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-auto relative",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 sm:p-6 border-b",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:e.jsx(G,{className:"w-5 h-5 sm:w-6 sm:h-6 text-red-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg sm:text-xl font-bold text-gray-900",children:_()}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-600 mt-1",children:l("companies_delete.can_be_restored")})]})]}),e.jsx("button",{onClick:q,className:"p-2 hover:bg-gray-100 rounded-lg transition",disabled:c,children:e.jsx(Y,{className:"w-5 h-5 text-gray-500"})})]}),e.jsxs("div",{className:"p-4 sm:p-6 space-y-4 max-h-[70vh] overflow-y-auto",children:[k&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(G,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),e.jsx("div",{children:e.jsx("p",{className:"text-sm text-red-800 font-medium",children:k})})]})}),e.jsx("div",{className:"border rounded-lg p-4 bg-yellow-50 border-yellow-200",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Ne,{className:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-yellow-800",children:O()}),!L&&a&&e.jsxs("div",{className:"mt-2 space-y-1",children:[a.client_code&&e.jsxs("p",{className:"text-sm text-yellow-700",children:[e.jsxs("span",{className:"font-semibold",children:[l("companies_delete.client_code"),":"]})," ",e.jsx("span",{className:"font-mono bg-white px-1 py-0.5 rounded text-xs",children:a.client_code})]}),a.email&&e.jsxs("p",{className:"text-xs text-yellow-600",children:[e.jsxs("span",{className:"font-semibold",children:[l("companies_delete.email"),":"]})," ",a.email]})]}),L&&t.length>0&&e.jsxs("p",{className:"text-xs mt-2 text-yellow-600",children:["ðŸ“‹ ",t.length," ",l("companies_delete.clients_selected")]})]})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:[e.jsx(ge,{className:"w-4 h-4 text-red-500 flex-shrink-0"}),e.jsxs("span",{className:"font-medium",children:[l("companies_delete.type_to_confirm"),":"]})]}),e.jsx("input",{type:"text",value:C,onChange:h=>A(h.target.value.toUpperCase()),placeholder:l("companies_delete.type_placeholder").toUpperCase(),className:"w-full px-3 py-2 border border-red-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 font-mono text-center text-base sm:text-lg font-bold uppercase tracking-wider",disabled:c,autoComplete:"off"}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${C==="DELETE"?"bg-green-500":"bg-red-500"}`}),e.jsx("span",{children:l(C==="DELETE"?"companies_delete.confirmation_matches":"companies_delete.type_exactly")})]})]}),e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-gray-50 rounded-lg border border-gray-200",children:[e.jsx(_e,{className:"w-5 h-5 text-gray-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm text-gray-700 font-medium mb-1",children:P()}),e.jsx("p",{className:"text-xs text-gray-500",children:l("companies_delete.can_be_restored_later")})]})]})]}),e.jsxs("div",{className:"bg-gray-50 px-4 sm:px-6 py-4 border-t flex flex-col sm:flex-row gap-3",children:[e.jsx("button",{type:"button",onClick:q,disabled:c,className:"px-4 py-2.5 text-gray-700 hover:text-gray-900 font-medium disabled:opacity-50 transition-colors rounded-lg order-2 sm:order-1",children:l("companies_delete.cancel")}),e.jsx("button",{type:"button",onClick:Q,disabled:c||C!=="DELETE",className:"px-6 py-2.5 font-medium rounded-lg disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 transition-colors order-1 sm:order-2 bg-red-600 hover:bg-red-700 text-white",children:c?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),l("companies_delete.deleting")]}):e.jsxs(e.Fragment,{children:[e.jsx(oe,{className:"w-4 h-4"}),l("companies_delete.delete_button")]})})]})]})})]}):e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-auto",children:e.jsxs("div",{className:"p-6 text-center",children:[e.jsx(G,{className:"w-12 h-12 text-yellow-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:l("companies_delete.no_data_selected")}),e.jsx("p",{className:"text-gray-600",children:l("companies_delete.select_client_to_delete")}),e.jsx("button",{onClick:U,className:"mt-4 px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-800 rounded-lg transition-colors",children:l("companies_delete.close")})]})})})},rt=()=>{const{companies:w,statistics:U,types:a,filters:p,fromQuotation:L,quotationId:r,clientTypes:t,auth_permissions:l}=re().props,{t:c}=te();l.can_read;const m=l.can_create===1,C=l.can_update===1,A=l.can_delete===1;console.log("DEBUG: Props Received:",{companiesCount:w?.data?.length,clientTypesCount:t?.length||a?.length,typesCount:a?.length,companySample:w?.data?.[0]});const[k,F]=d.useState(p.search||""),[S,X]=d.useState(p.client_type_id||""),[Q,$]=d.useState(!1),[q,_]=d.useState(!1),[O,P]=d.useState(!1),[b,h]=d.useState(null),[T,V]=d.useState([]),[f,i]=d.useState(null),[x,g]=d.useState(null),E=d.useRef(null);d.useEffect(()=>{L&&r&&$(!0)},[L,r]),d.useEffect(()=>{const s=n=>{E.current&&!E.current.contains(n.target)&&i(null)};return document.addEventListener("mousedown",s),()=>document.removeEventListener("mousedown",s)},[]);const I=d.useCallback(s=>{z.get("/companies",{search:s,client_type_id:S},{preserveState:!0,replace:!0,only:["companies","filters","statistics"]})},[S]),M=d.useCallback(s=>{const n=s===S?"":s;X(n),z.get("/companies",{search:k,client_type_id:n},{preserveState:!0,replace:!0,only:["companies","filters","statistics"]})},[k,S]),B=()=>{F(""),X(""),z.get("/companies",{},{preserveState:!0,replace:!0,only:["companies","filters","statistics"]})},H=()=>{$(!1),z.reload({only:["companies","statistics"],preserveScroll:!0})},R=s=>{console.log("=== EDIT CLICKED ==="),console.log("Original company data:",s),console.log("Lead data:",s.lead),console.log("Primary contact:",s.primary_contact);const n={id:s.id,client_code:s.client_code||"",company_name:s.company_name||s.lead?.company_name||s.client_code||s.name||"",contact_person:s.contact_person||s.primary_contact?.name||s.lead?.contact_person||"",contact_email:s.email||s.primary_contact?.email||s.lead?.email||"",contact_phone:s.phone||s.primary_contact?.phone||s.lead?.phone||"",contact_position:s.contact_position||s.primary_contact?.position||s.lead?.position||"",client_type_id:s.client_type_id||"",city:s.city||"",province:s.province||"",country:s.country||"",postal_code:s.postal_code?.toString()||"",vat_number:s.vat_number?.toString()||"",nib:s.nib||"",website:s.website||"",logo_url:s.logo_url||"",is_active:s.is_active||!1,primary_contact:s.primary_contact,lead:s.lead,name:s.name};console.log("Prepared company data for edit:",n),console.log("Company Name source:",{fromCompanyProp:s.company_name,fromLead:s.lead?.company_name,fromClientCode:s.client_code,finalValue:n.company_name}),h(n),_(!0)},ae=s=>{console.log("Delete clicked for:",s.id),h(s),P(!0)},o=s=>{console.log("Update successful:",s),_(!1),h(null),z.reload({only:["companies","statistics"],preserveScroll:!0})},u=async s=>{if(b)try{const n=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content");let j=`/companies/${b.id}`;s==="permanent"&&(j=`/companies/force-delete/${b.id}`);const W=await fetch(j,{method:s==="permanent"?"DELETE":"POST",headers:{"X-CSRF-TOKEN":n,"X-Requested-With":"XMLHttpRequest",Accept:"application/json"}}),Z=await W.json();if(!W.ok)throw new Error(Z.message||c("companies.delete_failed"));alert(Z.message||c("companies.client_deleted_successfully")),P(!1),h(null),z.reload({only:["companies","statistics"],preserveScroll:!0})}catch(n){console.error("Delete error:",n),alert(c("companies.delete_failed_try_again"))}};d.useEffect(()=>{const s=setTimeout(()=>{k!==p.search&&I(k)},500);return()=>clearTimeout(s)},[k]);const N=[{key:"client_name",label:c("companies.table.client_name"),render:(s,n)=>{const j=n.company_name||n.lead?.company_name||n.name||"-";return e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("button",{onClick:W=>{W.stopPropagation(),v(n)},className:"font-medium text-blue-600 hover:text-blue-800 hover:underline flex items-center gap-1 transition-colors",children:[j,e.jsx(be,{className:"w-3 h-3 opacity-0 group-hover:opacity-100 transition-opacity"})]}),e.jsx("span",{className:"text-xs text-gray-500 mt-1",children:n.client_code})]})}},{key:"address",label:c("companies.table.address"),render:(s,n)=>{const j=n.is_active,W=[n.city,n.province,n.country].filter(Boolean),Z=W.length>0?W.join(", "):n.address||"-";return e.jsxs("div",{children:[e.jsx("span",{className:`font-medium ${j?"text-gray-900":"text-gray-500"}`,children:Z}),!j&&e.jsx("div",{className:"text-xs text-gray-400 mt-0.5",children:c("companies.inactive")})]})}},{key:"contact_person",label:c("companies.table.contact_person"),render:(s,n)=>e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium text-gray-900",children:s||"-"}),e.jsx("span",{className:"text-xs text-gray-500 font-normal",children:n.contact_position||"-"})]})},{key:"contact_info",label:c("companies.table.contact"),render:(s,n)=>e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-medium text-gray-900",children:n.email||"-"}),e.jsx("span",{className:"text-xs text-gray-500 font-normal",children:n.phone||"-"})]})},{key:"client_type_name",label:c("companies.table.status"),render:s=>e.jsx("span",{className:"font-semibold text-green-700 bg-green-50 rounded px-2 py-1 text-xs",children:s||"-"})},{key:"client_since",label:c("companies.table.client_since"),render:s=>e.jsx("div",{className:"text-sm text-gray-600",children:s?new Date(s).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric"}):"-"})}],y=w.data?.map((s,n)=>{const j=s.company_name||s.lead?.company_name||s.client_code||s.name||"-";return{id:s.id,client_name:j,company_name:j,address:s.address||"-",city:s.city||"",province:s.province||"",country:s.country||"",contact_person:s.contact_person||"-",email:s.email||"-",phone:s.phone||"-",contact_position:s.contact_position||"",client_code:s.client_code||"",client_type_name:s.client_type_name||c("companies.unknown"),client_type_id:s.client_type_id||"",is_active:s.is_active||!1,client_since:s.client_since||"-",created_at:s.created_at||"",postal_code:s.postal_code||"",vat_number:s.vat_number||"",nib:s.nib||"",website:s.website||"",logo_url:s.logo_url||"",primary_contact:s.primary_contact,lead:s.lead,name:s.name}})||[],v=s=>{z.visit(`/companies/${s.id}`)};return e.jsxs(e.Fragment,{children:[e.jsx(ce,{title:c("companies.title")}),e.jsxs("div",{className:"px-8 py-6",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row items-start lg:items-center justify-between gap-4 mb-6",children:[e.jsx("div",{children:e.jsx("h1",{className:"text-xl font-black uppercase tracking-widest text-gray-800",children:c("companies.title")})}),L&&r&&e.jsx("div",{className:"w-full sm:w-auto bg-blue-50 border border-blue-200 rounded-lg p-3 mb-2 sm:mb-0",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{className:"w-5 h-5 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium text-blue-900",children:c("companies.from_quotation_notification")})]}),e.jsx("button",{onClick:()=>z.get("/companies"),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:c("companies.skip")})]})}),e.jsx("div",{className:"flex gap-3 w-full sm:w-auto",children:m&&e.jsxs("button",{onClick:()=>$(!0),className:"inline-flex items-center rounded-md border border-transparent px-5 py-2.5 text-sm font-medium font-semibold uppercase tracking-widest text-white transition duration-150 ease-in-out bg-[rgb(17,94,89)] hover:bg-[rgb(13,75,71)] focus:bg-[rgb(13,75,71)] focus:outline-none focus:ring-2 focus:ring-[rgb(17,94,89)] focus:ring-offset-2 active:bg-[rgb(10,60,57)] w-full sm:w-auto flex items-center justify-center gap-2 shadow-sm hover:shadow",children:[e.jsx(fe,{className:"h-5 w-5"}),e.jsx("span",{className:"font-semibold",children:c("companies.add_new_client")})]})})]}),Q&&e.jsx(Ee,{isOpen:Q,onClose:()=>$(!1),clientTypes:a,quotationId:r,onSuccess:H}),q&&b&&e.jsx(Le,{isOpen:q,onClose:()=>{_(!1),h(null)},company:b,clientTypes:t||a,onUpdate:o}),O&&e.jsx(De,{isOpen:O,onClose:()=>{P(!1),h(null)},company:b,onDelete:u}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 md:gap-6 my-7",children:U.client_types?.map((s,n)=>{const j=["border-blue-200 bg-blue-100","border-green-200 bg-green-100","border-orange-200 bg-orange-100","border-purple-200 bg-purple-100"],W=j[n%j.length];return e.jsx("div",{className:`rounded-xl p-5 shadow-sm border ${W} transition-transform hover:scale-[1.02] hover:shadow-md min-h-[120px] flex flex-col justify-between`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 uppercase tracking-wide",children:s.name}),e.jsx("p",{className:"text-2xl md:text-3xl font-bold text-gray-900 mt-2",children:s.count})]}),e.jsx("div",{className:"p-3 rounded-full bg-white",children:e.jsx(ee,{className:"w-6 h-6 text-blue-600"})})]})},s.id)})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4 md:p-6 mb-6",children:e.jsx("div",{className:"flex flex-col lg:flex-row items-start lg:items-center justify-between gap-6",children:e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(le,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",placeholder:c("companies.search_placeholder"),value:k,onChange:s=>F(s.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm transition-all duration-200"})]}),e.jsx("div",{className:"w-full sm:w-auto",children:e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:S,onChange:s=>M(s.target.value),className:"w-full sm:w-64 border border-gray-300 rounded-xl px-4 py-3 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent appearance-none bg-white pr-10",children:[e.jsx("option",{value:"",children:c("companies.all_client_types")}),a.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),e.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-3 text-gray-500",children:e.jsx("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})}),(k||S)&&e.jsxs("button",{onClick:B,className:"px-4 py-3 border border-gray-300 text-gray-700 rounded-xl text-sm font-medium hover:bg-gray-50 transition-colors duration-200 flex items-center gap-2 whitespace-nowrap",children:[e.jsx(Y,{className:"h-4 w-4"}),c("companies.clear_filters")]})]}),(k||S)&&e.jsxs("div",{className:"mt-4 flex flex-wrap gap-2",children:[k&&e.jsxs("span",{className:"inline-flex items-center px-3 py-1.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[c("companies.search_label",{search:k}),e.jsx("button",{onClick:()=>F(""),className:"ml-1.5 text-blue-600 hover:text-blue-800",children:"Ã—"})]}),S&&e.jsxs("span",{className:"inline-flex items-center px-3 py-1.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[`${c("companies.type_label")}: ${a.find(s=>s.id===S)?.name||c("companies.selected")}`,e.jsx("button",{onClick:()=>X(""),className:"ml-1.5 text-green-600 hover:text-green-800",children:"Ã—"})]})]})]})})}),e.jsx("div",{className:"py-6",children:e.jsx("div",{className:"overflow-x-auto -mx-4 px-4",children:e.jsx(ie,{columns:N,data:y,onEdit:C?R:null,onDelete:A?ae:null,showAction:C||A,pagination:{currentPage:w.current_page||1,totalPages:w.last_page||1,totalItems:w.total||0,itemsPerPage:w.per_page||10,onPageChange:s=>{z.get("/companies",{page:s,search:k,client_type_id:S},{preserveState:!0,replace:!0})}},onRowClick:v})})})]})]})};export{rt as default};
