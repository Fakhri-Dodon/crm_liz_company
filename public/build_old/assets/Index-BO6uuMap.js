import{r as i,u as ee,b as Q,j as e,a as de,c as E,H as ce}from"./app-Dyd-VK-i.js";import{H as ie}from"./HeaderLayout-Btj1rOYY.js";import{T as me}from"./TableLayout-BIe_S7av.js";import{u as te}from"./useTranslation-C1duoCZq.js";import{F as W}from"./file-text-D0lOMtzR.js";import{X as pe}from"./x-Dg_sVrJD.js";import{L as X}from"./loader-circle-DFyo62iO.js";import{U as xe}from"./users-CaGv18Zi.js";import{C as B}from"./chevron-down-BdiW-nc9.js";import{C as se}from"./calendar-CWDjbzSs.js";import{C as ue}from"./clock-CiSfxGeq.js";import{c as ge}from"./createLucideIcon-CMta4jpe.js";import{D as he}from"./DeleteModal-D-YWhayw.js";import{P as be}from"./plus-B5n9R1EM.js";import{S as je}from"./search-AUTQuBot.js";import{R as Y}from"./refresh-cw-51J-93ua.js";import{F as fe}from"./funnel-BzYyzyFn.js";import"./transition-BVEVT5Dk.js";import"./index-BAWYnhaJ.js";import"./settings-D0070qy7.js";import"./send-C6E11V_I.js";import"./globe-36e_mGF8.js";import"./check-BdTeYIzn.js";import"./user-DGMjLAi-.js";import"./triangle-alert-in_WnGDb.js";const _e=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],ye=ge("message-square",_e),Z=({show:c,onClose:P,projectId:u,companies:F,quotations:T,statusOptions:I,isEdit:h=!1,title:L,onSuccess:s})=>{const{t:o}=te(),[j,M]=i.useState(!1),[D,A]=i.useState([]),[U,z]=i.useState(null),[q,S]=i.useState(!1),[m,C]=i.useState(!1),{data:d,setData:_,post:R,put:H,processing:l,errors:p,reset:J}=ee({quotation_id:"",company_id:"",project_description:"",start_date:"",deadline:"",note:"",status:"in_progress"});i.useEffect(()=>{if(c)if(F&&F.length>0){const r=F.map(n=>({id:n.id,name:n.name||n.full_display||n.display_name,display_name:n.display_name||n.name,full_display:n.full_display||n.display_name||n.name,client_code:n.client_code,city:n.city,has_lead:n.has_lead}));A(r)}else f()},[c,F]),i.useEffect(()=>{c&&h&&u&&(console.log("Fetching project data for edit mode"),G())},[c,h,u]),i.useEffect(()=>{c&&!h&&(console.log("Resetting form for create mode"),$())},[c,h]),i.useEffect(()=>{c||(console.log("Modal closed, resetting form"),$())},[c]);const f=async()=>{S(!0);try{const r=await Q.get("/api/clients");r.data.success&&A(r.data.data)}catch(r){console.error("Error fetching clients:",r),g(o("project_modal.error_fetching_clients"),"error")}finally{S(!1)}},G=async()=>{M(!0);try{const n=(await Q.get(`/projects/${u}/edit`)).data;z(n);const v={quotation_id:n.quotation_id||"",company_id:n.company_id||"",project_description:n.project_description||"",start_date:n.start_date||"",deadline:n.deadline||"",note:n.note||"",status:n.status||"in_progress"};_(v)}catch(r){console.error("Error fetching project data:",r),r.response?.status===404?(g(o("project_modal.project_not_found"),"error"),N()):g(o("project_modal.error_fetching_project"),"error")}finally{M(!1)}},$=()=>{console.log("Resetting form to empty state"),J({quotation_id:"",company_id:"",project_description:"",start_date:"",deadline:"",note:"",status:"in_progress"}),z(null),C(!1)},g=(r,n="success")=>{document.querySelectorAll("[data-toast]").forEach(K=>K.remove());const k=document.createElement("div");k.setAttribute("data-toast","true"),k.className=`fixed top-4 right-4 z-50 px-6 py-4 rounded-lg shadow-lg transform transition-all duration-300 ${n==="success"?"bg-green-500 text-white":"bg-red-500 text-white"}`,k.innerHTML=`
            <div class="flex items-center">
                <span>${r}</span>
                <button onclick="this.parentElement.parentElement.remove()" class="ml-4">
                    ✕
                </button>
            </div>
        `,document.body.appendChild(k),setTimeout(()=>{k.parentElement&&k.remove()},3e3)},b=r=>{if(r.preventDefault(),!d.project_description?.trim()){g(o("project_modal.project_description_required"),"error");return}if(!d.company_id){g(o("project_modal.client_required"),"error");return}if(!d.quotation_id){g(o("project_modal.quotation_required"),"error");return}if(!d.start_date){g(o("project_modal.start_date_required"),"error");return}if(!d.deadline){g(o("project_modal.deadline_required"),"error");return}if(d.start_date&&d.deadline){const n=new Date(d.start_date);if(new Date(d.deadline)<n){g(o("project_modal.deadline_before_start"),"error");return}}if(s&&typeof s=="function"&&(console.log("Calling onSuccess to close modal immediately"),s()),C(!0),h&&u)H(route("projects.update",u),{preserveScroll:!0,preserveState:!0,onSuccess:()=>{console.log("Project updated successfully on server"),g(o("project_modal.project_updated"),"success"),$()},onError:n=>{console.error("Update errors:",n),C(!1),g(o("project_modal.update_error"),"error")},onFinish:()=>{C(!1)}});else{const n={...d,status:"in_progress"};R(route("projects.store"),n,{preserveScroll:!0,preserveState:!0,onSuccess:()=>{console.log("Project created successfully on server"),g(o("project_modal.project_created"),"success"),$()},onError:v=>{console.error("Store errors:",v),C(!1),g(o("project_modal.save_error"),"error")},onFinish:()=>{C(!1)}})}},N=()=>{!l&&!j&&!m&&(console.log("Manual close modal, resetting form"),$(),P&&typeof P=="function"&&P())};if(i.useEffect(()=>{const r=n=>{n.key==="Escape"&&c&&N()};return window.addEventListener("keydown",r),()=>{window.removeEventListener("keydown",r)}},[c,l,j,m]),!c)return null;const y=L||o(h?"project_modal.edit_project_title":"project_modal.add_project_title"),O=o(h?"project_modal.edit_project_description":"project_modal.add_project_description");return e.jsx("div",{className:"fixed inset-0 bg-gray-900/50 backdrop-blur-sm overflow-y-auto h-full w-full z-50",children:e.jsx("div",{className:"relative min-h-screen flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-[#005954]/10 rounded-lg",children:e.jsx(W,{className:"w-6 h-6 text-[#005954]"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:y}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:O})]})]}),e.jsx("button",{onClick:N,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:l||j||m,title:o("project_modal.close_modal"),children:e.jsx(pe,{className:"w-5 h-5"})})]}),j&&h?e.jsxs("div",{className:"p-12 flex flex-col items-center justify-center",children:[e.jsx(X,{className:"w-8 h-8 text-[#005954] animate-spin mb-4"}),e.jsx("p",{className:"text-gray-600",children:o("project_modal.loading_project")})]}):e.jsxs("form",{onSubmit:b,className:"p-6 space-y-6 max-h-[70vh] overflow-y-auto",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center gap-2",children:[e.jsx(W,{className:"w-4 h-4"}),o("project_modal.project_description")," *"]}),e.jsxs("div",{className:"relative",children:[e.jsx("textarea",{value:d.project_description,onChange:r=>_("project_description",r.target.value),className:`w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-[#005954] focus:border-transparent min-h-[100px] resize-none transition-colors ${p.project_description?"border-red-300":"border-gray-300"}`,maxLength:250,required:!0,placeholder:o("project_modal.project_description_placeholder"),disabled:m}),e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[p.project_description?e.jsx("p",{className:"text-sm text-red-600",children:p.project_description}):e.jsx("div",{className:"text-xs text-gray-400",children:o("project_modal.project_description_hint")}),e.jsxs("div",{className:"text-xs text-gray-500",children:[d.project_description?.length||0,"/250"]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center gap-2",children:[e.jsx(xe,{className:"w-4 h-4"}),o("project_modal.client")," *"]}),e.jsx("div",{className:"relative",children:q&&D.length===0?e.jsxs("div",{className:"flex items-center justify-center py-3 border border-gray-300 rounded-xl",children:[e.jsx(X,{className:"w-4 h-4 animate-spin text-gray-500 mr-2"}),e.jsx("span",{className:"text-sm text-gray-500",children:o("project_modal.loading_clients")})]}):e.jsxs(e.Fragment,{children:[e.jsxs("select",{value:d.company_id,onChange:r=>_("company_id",r.target.value),className:`w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-[#005954] focus:border-transparent appearance-none transition-colors ${p.company_id?"border-red-300":"border-gray-300"}`,required:!0,disabled:q||m,children:[e.jsx("option",{value:"",className:"text-gray-400",children:o("project_modal.client_placeholder")}),D.map(r=>e.jsx("option",{value:r.id,children:r.full_display||r.display_name||r.name},r.id))]}),e.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700",children:e.jsx(B,{className:"w-4 h-4"})})]})}),p.company_id&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:p.company_id})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center gap-2",children:[e.jsx(W,{className:"w-4 h-4"}),o("project_modal.quotation")," *"]}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:d.quotation_id,onChange:r=>_("quotation_id",r.target.value),className:`w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-[#005954] focus:border-transparent appearance-none transition-colors ${p.quotation_id?"border-red-300":"border-gray-300"}`,required:!0,disabled:m,children:[e.jsx("option",{value:"",className:"text-gray-400",children:o("project_modal.quotation_placeholder")}),T&&T.map(r=>e.jsx("option",{value:r.id,children:r.display_name||r.name||r.number},r.id))]}),e.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700",children:e.jsx(B,{className:"w-4 h-4"})})]}),p.quotation_id&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:p.quotation_id})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center gap-2",children:[e.jsx(se,{className:"w-4 h-4"}),o("project_modal.start_date")," *"]}),e.jsx("input",{type:"date",value:d.start_date,onChange:r=>_("start_date",r.target.value),className:`w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-[#005954] focus:border-transparent transition-colors ${p.start_date?"border-red-300":"border-gray-300"}`,required:!0,disabled:m}),p.start_date&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:p.start_date})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center gap-2",children:[e.jsx(ue,{className:"w-4 h-4"}),o("project_modal.deadline")," *"]}),e.jsx("input",{type:"date",value:d.deadline,onChange:r=>_("deadline",r.target.value),min:d.start_date,className:`w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-[#005954] focus:border-transparent transition-colors ${p.deadline?"border-red-300":"border-gray-300"}`,required:!0,disabled:m}),p.deadline&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:p.deadline})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center gap-2",children:[e.jsx(ye,{className:"w-4 h-4"}),o("project_modal.note")]}),e.jsx("textarea",{value:d.note,onChange:r=>_("note",r.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-[#005954] focus:border-transparent min-h-[100px] resize-none transition-colors",maxLength:250,placeholder:o("project_modal.note_placeholder"),disabled:m}),e.jsx("div",{className:"text-right text-xs text-gray-500 mt-2",children:o("project_modal.note_character_count",{current:d.note?.length||0})})]}),h&&e.jsxs("div",{className:"p-4 bg-gray-50 rounded-xl border border-gray-200",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:o("project_modal.status")}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:I?.filter(r=>["in_progress","completed","pending","cancelled"].includes(r.value)).map(r=>{const v={in_progress:"bg-blue-50 text-blue-700 border-blue-500",completed:"bg-green-50 text-green-700 border-green-500",pending:"bg-yellow-50 text-yellow-700 border-yellow-500",cancelled:"bg-red-50 text-red-700 border-red-500"}[r.value]||"bg-gray-50 text-gray-700 border-gray-500";return e.jsx("button",{type:"button",onClick:()=>_("status",r.value),className:`p-3 border-2 rounded-lg text-sm font-medium transition-all ${d.status===r.value?`${v} ring-2 ring-offset-1 ring-[#005954]`:`${v} hover:opacity-90`}`,disabled:m,children:r.label},r.value)})}),p.status&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:p.status})]}),e.jsxs("div",{className:"flex flex-col-reverse sm:flex-row gap-3 pt-6 border-t border-gray-100",children:[e.jsx("button",{type:"button",onClick:N,className:"px-6 py-3 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50 transition-colors font-medium flex-1 disabled:opacity-50 disabled:cursor-not-allowed",disabled:j||m,children:o("project_modal.cancel_button")}),e.jsx("button",{type:"submit",className:"px-6 py-3 bg-[#005954] text-white rounded-xl hover:bg-[#004d47] transition-colors font-medium flex-1 disabled:opacity-50 disabled:cursor-not-allowed shadow-sm hover:shadow-md flex items-center justify-center gap-2",disabled:j||m||D.length===0&&q,children:m?e.jsxs(e.Fragment,{children:[e.jsx(X,{className:"w-4 h-4 animate-spin"}),o("project_modal.processing")]}):o(h?"project_modal.update_project_button":"project_modal.create_project_button")})]})]})]})})})};function We({projects:c,summary:P,filters:u,years:F,companies:T,quotations:I,statusOptions:h,auth_permissions:L}){const{t:s}=te(),{props:o}=de(),j=o.flash||{},[M,D]=i.useState(!1),[A,U]=i.useState(!1),[z,q]=i.useState(!1),[S,m]=i.useState(null),[C,d]=i.useState(null);L.can_read;const _=L.can_create===1,R=L.can_update===1,H=L.can_delete===1,{data:l,setData:p,get:J,processing:f,reset:G}=ee({search:u?.search||"",status:u?.status||"all",month:u?.month||"",year:u?.year||""}),$=t=>{switch(t){case"in_progress":return{card:"rounded-xl p-5 shadow-sm border border-blue-200 bg-blue-100 transition-transform hover:scale-[1.02] hover:shadow-md",text:"text-blue-800",count:"text-blue-900",subtext:"text-blue-700"};case"completed":return{card:"rounded-xl p-5 shadow-sm border border-green-200 bg-green-100 transition-transform hover:scale-[1.02] hover:shadow-md",text:"text-green-800",count:"text-green-900",subtext:"text-green-700"};case"pending":return{card:"rounded-xl p-5 shadow-sm border border-yellow-200 bg-yellow-100 transition-transform hover:scale-[1.02] hover:shadow-md",text:"text-yellow-800",count:"text-yellow-900",subtext:"text-yellow-700"};case"cancelled":return{card:"rounded-xl p-5 shadow-sm border border-red-200 bg-red-100 transition-transform hover:scale-[1.02] hover:shadow-md",text:"text-red-800",count:"text-red-900",subtext:"text-red-700"};default:return{card:"rounded-xl p-5 shadow-sm border border-gray-200 bg-gray-100 transition-transform hover:scale-[1.02] hover:shadow-md",text:"text-gray-800",count:"text-gray-900",subtext:"text-gray-700"}}},g={in_progress:{bg:"bg-blue-50",text:"text-blue-700",border:"border-blue-500"},completed:{bg:"bg-green-50",text:"text-green-700",border:"border-green-500"},pending:{bg:"bg-yellow-50",text:"text-yellow-700",border:"border-yellow-500"},cancelled:{bg:"bg-red-50",text:"text-red-700",border:"border-red-500"}};i.useEffect(()=>{console.log("Projects data updated:",{total:c?.total,current_page:c?.current_page,data_length:c?.data?.length,filters_from_props:u})},[c,u]),i.useEffect(()=>{console.log("Filters props changed:",u),u&&p({search:u.search||"",status:u.status||"all",month:u.month||"",year:u.year||""})},[u]),i.useEffect(()=>{if(j.success||j.error){const t=j.success||j.error,a=j.success?"success":"error";b(t,a)}},[j]);const b=(t,a="success")=>{document.querySelectorAll("[data-toast]").forEach(V=>V.remove());const x=document.createElement("div");x.setAttribute("data-toast","true"),x.className=`fixed top-4 right-4 z-50 px-6 py-4 rounded-lg shadow-lg transform transition-all duration-300 ${a==="success"?"bg-green-500 text-white":"bg-red-500 text-white"}`,x.innerHTML=`
            <div class="flex items-center">
                <span>${t}</span>
                <button onclick="this.parentElement.parentElement.remove()" class="ml-4">
                    ✕
                </button>
            </div>
        `,document.body.appendChild(x),setTimeout(()=>{x.parentElement&&x.remove()},3e3)},N=(t,a)=>{console.log(`Filter changed: ${t} = ${a}`),p(t,a)},y=i.useCallback(()=>{console.log("Current filter data:",l);const t=new URLSearchParams;l.search&&l.search.trim()!==""&&t.append("search",l.search),l.status&&l.status!=="all"&&t.append("status",l.status),l.month&&l.month!==""&&t.append("month",l.month),l.year&&l.year!==""&&t.append("year",l.year),t.append("page","1"),console.log("Applying filters with params:",Object.fromEntries(t)),E.get(route("projects.index")+"?"+t.toString(),{},{preserveState:!0,preserveScroll:!0,onSuccess:()=>{console.log("Filters applied successfully - Response data:",{total:c?.total,data_length:c?.data?.length}),b(s("projects_index.filter_applied"),"success")},onError:a=>{console.error("Filter error:",a),b(s("projects_index.filter_failed"),"error")}})},[l,E,c,s]),O=i.useCallback(()=>{console.log("Resetting filters..."),G({search:"",status:"all",month:"",year:""});const a=new URLSearchParams;a.append("page","1"),E.get(route("projects.index")+"?"+a.toString(),{},{preserveState:!0,preserveScroll:!0,onSuccess:()=>{console.log("Filters reset successfully"),b(s("projects_index.filters_reset"),"success")},onError:w=>{console.error("Reset filter error:",w),b(s("projects_index.reset_failed"),"error")}})},[G,E,s]),r=t=>{m(t.id),d(t),U(!0)},n=async(t,a)=>{try{await E.put(route("projects.status.update",t),{status:a},{preserveScroll:!0,onSuccess:()=>{b(s("projects_index.status_updated"),"success"),y()},onError:w=>{console.error("Status update error:",w),b(s("projects_index.status_update_failed"),"error")}})}catch(w){console.error("Error updating status:",w),b(s("projects_index.status_update_failed"),"error")}},v=t=>{m(t.id),d(t),q(!0)},k=()=>{S&&E.delete(route("projects.destroy",S),{preserveScroll:!0,onSuccess:()=>{q(!1),m(null),d(null),b(s("projects_index.project_deleted"),"success"),y()},onError:()=>{b(s("projects_index.delete_failed"),"error")}})},K=i.useCallback(()=>{console.log("Create modal success callback called - CLOSING MODAL AND RESETTING"),D(!1),b(s("projects_index.project_created"),"success"),y()},[y,s]),re=i.useCallback(()=>{console.log("Edit modal success callback called - CLOSING MODAL AND RESETTING"),U(!1),m(null),d(null),b(s("projects_index.project_updated"),"success"),y()},[y,s]),ae=[{value:"",label:s("projects_index.all_months")},{value:"1",label:s("projects_index.jan")},{value:"2",label:s("projects_index.feb")},{value:"3",label:s("projects_index.mar")},{value:"4",label:s("projects_index.apr")},{value:"5",label:s("projects_index.may")},{value:"6",label:s("projects_index.jun")},{value:"7",label:s("projects_index.jul")},{value:"8",label:s("projects_index.aug")},{value:"9",label:s("projects_index.sep")},{value:"10",label:s("projects_index.oct")},{value:"11",label:s("projects_index.nov")},{value:"12",label:s("projects_index.dec")}],oe=["in_progress","completed","pending","cancelled"],le=({project:t})=>{const a=g[t.status]||g.pending,w=h?.find(x=>x.value===t.status)?.label||t.status;return R?e.jsxs("div",{className:"relative min-w-[100px]",children:[e.jsx("select",{value:t.status,onChange:x=>n(t.id,x.target.value),className:`appearance-none text-xs font-bold py-1 px-2 rounded-lg border-2 focus:ring-0 cursor-pointer transition-all truncate w-full ${a.border} ${a.text} ${a.bg}`,style:{backgroundImage:"none",appearance:"none",MozAppearance:"none",WebkitAppearance:"none",paddingRight:"1.5rem"},children:h?.map(x=>{const V=g[x.value]||g.pending;return e.jsx("option",{value:x.value,className:`${V.text} ${V.bg}`,children:x.label.toUpperCase()},x.value)})}),e.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-1",children:e.jsx(B,{className:"w-3 h-3"})})]}):e.jsx("span",{className:`px-2 py-1 rounded text-xs font-bold ${a.bg} ${a.text} border-2 ${a.border} truncate max-w-[120px] inline-block`,children:w.toUpperCase()})},ne=i.useCallback(t=>{console.log("Changing to page:",t);const a=new URLSearchParams;l.search&&l.search.trim()!==""&&a.append("search",l.search),l.status&&l.status!=="all"&&a.append("status",l.status),l.month&&l.month!==""&&a.append("month",l.month),l.year&&l.year!==""&&a.append("year",l.year),a.append("page",t),E.get(route("projects.index")+"?"+a.toString(),{},{preserveScroll:!0,preserveState:!0,onSuccess:()=>{console.log("Page changed successfully")}})},[l,E]);return e.jsx(ie,{children:e.jsxs("div",{className:"px-2 sm:px-4 md:px-8 py-4 sm:py-6",children:[e.jsx(ce,{title:s("projects_index.page_title")}),e.jsx("div",{className:"mb-6 sm:mb-8",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 sm:gap-4",children:[e.jsx("div",{children:e.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-gray-800",children:s("projects_index.header_title")})}),_&&e.jsxs("button",{onClick:()=>D(!0),className:"px-3 sm:px-4 py-2.5 sm:py-3 bg-[#005954] text-white rounded-lg hover:bg-[#004d47] flex items-center gap-1 sm:gap-2 transition-colors shadow-sm hover:shadow-md w-full sm:w-auto justify-center text-sm sm:text-base",disabled:f,children:[e.jsx(be,{className:"w-3 h-3 sm:w-4 sm:h-4"}),e.jsx("span",{className:"font-medium",children:s("projects_index.add_project")})]})]})}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4 md:gap-6 mb-6 sm:mb-8",children:oe.map(t=>{const a=$(t),w=h?.find(x=>x.value===t)?.label||t.split("_").map(x=>x.charAt(0).toUpperCase()+x.slice(1)).join(" ");return e.jsx("div",{className:a.card,children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("p",{className:`text-xs sm:text-sm font-medium ${a.text} uppercase tracking-wide`,children:w}),e.jsx("p",{className:`text-xl sm:text-2xl md:text-3xl font-bold ${a.count} mt-1 sm:mt-2`,children:P[t]||0}),e.jsx("p",{className:`text-xs ${a.subtext} mt-1 sm:mt-2`,children:s("projects_index.total_project")})]})})},t)})}),e.jsx("div",{className:"bg-white rounded-lg sm:rounded-xl shadow-sm border border-gray-200 p-3 sm:p-4 md:p-6 mb-6 sm:mb-8",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-end gap-3 sm:gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2",children:s("projects_index.search_projects")}),e.jsxs("div",{className:"relative",children:[e.jsx(je,{className:"absolute left-2 sm:left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4 sm:w-5 sm:h-5"}),e.jsx("input",{type:"text",placeholder:s("projects_index.search_placeholder"),value:l.search,onChange:t=>N("search",t.target.value),onKeyDown:t=>t.key==="Enter"&&y(),className:"w-full pl-8 sm:pl-10 pr-3 sm:pr-4 py-2 sm:py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#005954] focus:border-transparent transition-colors text-sm",disabled:f})]})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:flex sm:space-x-3 gap-3",children:[e.jsxs("div",{className:"sm:w-32 lg:w-40",children:[e.jsx("label",{className:"block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2",children:s("projects_index.status")}),e.jsxs("select",{value:l.status,onChange:t=>N("status",t.target.value),className:"w-full px-2 sm:px-3 py-2 sm:py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#005954] focus:border-transparent bg-white text-xs sm:text-sm",disabled:f,children:[e.jsx("option",{value:"all",children:s("projects_index.all_status")}),h?.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))]})]}),e.jsxs("div",{className:"sm:w-32 lg:w-40",children:[e.jsx("label",{className:"block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2",children:s("projects_index.month")}),e.jsxs("div",{className:"relative",children:[e.jsx(se,{className:"absolute left-2 sm:left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-3 h-3 sm:w-4 sm:h-4"}),e.jsx("select",{value:l.month,onChange:t=>N("month",t.target.value),className:"w-full pl-7 sm:pl-9 pr-2 sm:pr-3 py-2 sm:py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#005954] focus:border-transparent bg-white text-xs sm:text-sm",disabled:f,children:ae.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))})]})]}),e.jsxs("div",{className:"sm:w-28 lg:w-32",children:[e.jsx("label",{className:"block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2",children:s("projects_index.year")}),e.jsxs("select",{value:l.year,onChange:t=>N("year",t.target.value),className:"w-full px-2 sm:px-3 py-2 sm:py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#005954] focus:border-transparent bg-white text-xs sm:text-sm",disabled:f,children:[e.jsx("option",{value:"",children:s("projects_index.all_years")}),(F||[]).map(t=>e.jsx("option",{value:t,children:t},t))]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3 pt-1 sm:pt-2",children:[e.jsxs("button",{onClick:y,disabled:f,className:"px-3 sm:px-4 py-2 sm:py-2.5 bg-[#005954] text-white rounded-lg hover:bg-[#004d47] flex items-center gap-1 sm:gap-2 transition-colors justify-center text-xs sm:text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed min-w-[80px]",children:[f?e.jsx(Y,{className:"w-3 h-3 sm:w-4 sm:h-4 animate-spin"}):e.jsx(fe,{className:"w-3 h-3 sm:w-4 sm:h-4"}),e.jsx("span",{children:s(f?"projects_index.applying":"projects_index.apply")})]}),e.jsxs("button",{onClick:O,disabled:f,className:"px-3 sm:px-4 py-2 sm:py-2.5 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors flex items-center gap-1 sm:gap-2 justify-center text-xs sm:text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed min-w-[80px]",children:[e.jsx(Y,{className:"w-3 h-3 sm:w-4 sm:h-4"}),e.jsx("span",{children:s("projects_index.reset")})]})]})]})}),e.jsx("div",{className:"bg-white rounded-lg sm:rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsx(me,{columns:[{key:"project_description",label:s("projects_index.description"),className:"min-w-[180px] sm:min-w-[200px]",render:(t,a)=>e.jsxs("div",{className:"min-w-[180px] sm:min-w-[200px] max-w-[250px]",children:[e.jsx("div",{className:"font-medium text-gray-900 truncate text-sm",children:t||"-"}),a.note&&e.jsx("div",{className:"text-xs text-gray-500 truncate mt-0.5",children:a.note})]})},{key:"client",label:s("projects_index.client"),className:"min-w-[140px] sm:min-w-[160px]",render:(t,a)=>e.jsx("div",{className:"min-w-[140px] sm:min-w-[160px] max-w-[200px]",children:a.company?.lead?.company_name?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"font-medium text-gray-900 text-sm truncate",children:a.company.lead.company_name}),a.company?.client_code&&e.jsxs("div",{className:"text-xs text-gray-500 truncate",children:[s("projects_index.code"),": ",a.company.client_code]})]}):a.company?.client_code?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"font-medium text-gray-900 text-sm truncate",children:a.company.client_code}),e.jsx("div",{className:"text-xs text-gray-400 italic truncate",children:s("projects_index.no_company_name")})]}):e.jsx("div",{className:"text-gray-400 italic text-sm",children:s("projects_index.not_available")})})},{key:"start_date",label:s("projects_index.start_date"),className:"min-w-[100px] sm:min-w-[110px]",render:t=>t?new Date(t).toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric"}):"-"},{key:"deadline",label:s("projects_index.deadline"),className:"min-w-[100px] sm:min-w-[110px]",render:t=>t?new Date(t).toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric"}):"-"},{key:"status",label:s("projects_index.status"),className:"min-w-[100px] sm:min-w-[120px]",render:(t,a)=>e.jsx(le,{project:a})},{key:"quotation",label:s("projects_index.quotation"),className:"min-w-[90px] sm:min-w-[100px]",render:(t,a)=>e.jsx("div",{className:"min-w-[90px] sm:min-w-[100px] max-w-[120px]",children:a.quotation?.quotation_number?e.jsx("span",{className:"text-xs sm:text-sm text-gray-700 truncate block",children:a.quotation.quotation_number}):e.jsx("span",{className:"text-xs sm:text-sm text-gray-400 truncate block",children:s("projects_index.no_quotation")})})}],data:c.data||[],onEdit:R?r:null,onDelete:H?v:null,showAction:R||H,pagination:{currentPage:c.current_page,totalPages:c.last_page,totalItems:c.total,itemsPerPage:c.per_page,onPageChange:ne},emptyStateMessage:s("projects_index.no_data")})})}),e.jsx(Z,{show:M,onClose:()=>{console.log("Closing create modal"),D(!1)},companies:T||[],quotations:I||[],statusOptions:h||[],title:s("projects_index.add_project"),onSuccess:K},M?"create-modal":"create-modal-closed"),S&&e.jsxs(e.Fragment,{children:[e.jsx(Z,{show:A,onClose:()=>{console.log("Closing edit modal"),U(!1),m(null),d(null)},projectId:S,companies:T||[],quotations:I||[],statusOptions:h||[],isEdit:!0,title:s("projects_index.edit_project"),onSuccess:re},`edit-modal-${S}-${A}`),e.jsx(he,{show:z,onClose:()=>{q(!1),m(null),d(null)},onConfirm:k,title:s("projects_index.delete_confirm_title"),message:s("projects_index.delete_confirm_message",{projectName:C?.project_description})})]})]})})}export{We as default};
