import{a as v,r as x,u as I,j as e,c as w}from"./app-D-CXuYp-.js";import{H as z}from"./HeaderLayout-DNM94YMu.js";import{P}from"./PrimaryButton-B2jsRKzA.js";import{M as k}from"./ModalAdd-CP0WQobk.js";import{T as W}from"./TableLayout-DegOKxQR.js";import{n as i}from"./index-Dml3iHVq.js";import"./Table-CVqFnP0M.js";import"./Label-1noeBRz4.js";import"./Button-CKm56AAs.js";import{u as F}from"./useTranslation-C5DOJpQ8.js";import{B as _}from"./book-open-Ci_dgBUG.js";import{T as R}from"./trash-2-C428PtZi.js";import"./transition-Dd6dQS9p.js";import"./settings--wXcYxvN.js";import"./createLucideIcon-Da68c0mB.js";import"./send-WSU91zWN.js";import"./globe-Ct8OYrI2.js";import"./chevron-down-D5S3ga3K.js";import"./check-BdhqU_fL.js";import"./user-FnYjhWZf.js";import"./file-text-cCH1Ukzd.js";import"./x-7oBENnvo.js";function xe({auth_permissions:o}){const{templates:L}=v().props,{emailLogs:r=[]}=v().props,[C,n]=x.useState(!1),[a,M]=x.useState(null),[S,h]=x.useState(!1),[c,b]=x.useState(null),{t}=F(),{data:p,setData:d,post:H,put:T,processing:g,errors:l,reset:f}=I({name:"",subject:"",content:""}),j=o.can_read===1,A=o.can_create===1,y=o.can_update===1,m=o.can_delete===1,N=(s=null)=>{s?(b(s.id),d({name:s.name,subject:s.subject,content:s.content})):(b(null),f()),n(!0)},E=s=>{s.preventDefault(),c?T(route("email.update",c),{onSuccess:()=>{i.success("Template berhasil diperbarui!"),n(!1)}}):H(route("email.store"),{onSuccess:()=>{i.success("Template berhasil ditambahkan!"),f(),n(!1)}})},D=s=>{confirm("Apakah Anda yakin ingin menghapus template ini?")&&w.delete(route("email.destroy",s),{onSuccess:()=>i.success("Template berhasil dihapus"),onError:()=>i.error("Gagal menghapus template")})},O=s=>{s&&(M(s),h(!0))},V=s=>{s&&confirm("Apakah Anda yakin ingin menghapus log ini?")&&w.delete(`/setting/email/destroy-log/${s}`,{onSuccess:()=>{i.success("Log deleted successfully!")},onError:u=>{console.error(u)}})},B=[{key:"name",label:t("emails.table.name")||"Name"},{key:"subject",label:t("emails.table.subject")||"Subject"}];return e.jsxs(z,{title:"Email Management",children:[e.jsxs("div",{className:"px-4 sm:px-8 py-6",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row items-start lg:items-center justify-between gap-4 mb-8",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:t("emails.title")||"Email Templates"}),A&&e.jsxs(P,{onClick:()=>N(),className:"w-full sm:w-auto px-5 py-2.5 text-white text-sm font-medium rounded-lg hover:bg-[#004d47] transition-all duration-200 flex items-center justify-center gap-2 shadow-sm hover:shadow focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:[e.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),e.jsx("span",{children:t("emails.button_add")||"Add New Template"})]})]}),e.jsx(W,{data:L,columns:B,onEdit:y?s=>N(s):null,onDelete:m?s=>D(s.id):null,showAction:y||m}),e.jsx("h1",{className:"text-xl font-bold text-gray-800 pt-10",children:t("emails.title_history")||"Email Templates"}),e.jsxs("div",{className:"overflow-hidden bg-white rounded-xl border border-gray-200 shadow-sm mt-6",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-[#c8e1b5] border-b border-blue-200",children:[e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-black uppercase tracking-wider",children:t("emails.table.date")}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-black uppercase tracking-wider",children:t("emails.table.to")}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-black uppercase tracking-wider",children:t("emails.table.subject")}),(j||m)&&e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-black uppercase tracking-wider",children:t("users.table.actions")||"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:Array.isArray(r)&&r.length>0?r.map((s,u)=>s?e.jsxs("tr",{className:"hover:bg-blue-50 transition-colors duration-150 group",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:s?.sent_date?s.sent_date.split(" ")[0]:"-"}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:s?.to||"-"}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:s?.subject||"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center gap-2",children:[j&&e.jsx("button",{onClick:()=>O(s),className:"p-2 text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded-lg border border-blue-200 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1 group-hover:border-blue-300",title:"View Detail",children:e.jsx(_,{className:"w-4 h-4"})}),m&&e.jsx("button",{onClick:()=>s?.id&&V(s.id),className:"p-2 text-red-600 hover:text-red-800 hover:bg-red-50 rounded-lg border border-red-200 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-1 group-hover:border-red-300",title:"Delete Log",children:e.jsx(R,{className:"w-4 h-4"})})]})})]},s?.id||u):null):e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"px-6 py-12 text-center",children:e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsx("div",{className:"h-12 w-12 text-gray-300 mb-4",children:e.jsx("svg",{fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 002.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 00-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 00.75-.75 2.25 2.25 0 00-.1-.664m-5.801 0A2.251 2.251 0 0113.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.801 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m0 0H4.875c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V9.375c0-.621-.504-1.125-1.125-1.125H8.25zM6.75 12h.008v.008H6.75V12zm0 3h.008v.008H6.75V15zm0 3h.008v.008H6.75V18z"})})}),e.jsx("p",{className:"text-gray-500 font-medium",children:"No email history found"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Sent emails will appear here"})]})})})})]})}),r&&r.length>0&&e.jsx("div",{className:"px-6 py-3 border-t border-gray-200 bg-gray-50",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"text-xs text-gray-500",children:["Total logs: ",e.jsx("span",{className:"font-medium",children:r.length})]})})})]})]}),e.jsx(k,{isOpen:C,onClose:()=>n(!1),title:t(c?"emails.modals.edit_title":"emails.modals.add_title"),subtitle:t("emails.modals.subtitle"),footer:e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",onClick:()=>n(!1),className:"px-6 py-3 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50 transition-colors font-medium flex-1",children:t("emails.modals.btn_cancel")}),e.jsxs("button",{onClick:E,disabled:g,className:"px-6 py-3 bg-[#005954] text-white rounded-xl hover:bg-[#004d47] transition-colors font-medium flex-1 disabled:opacity-50 flex items-center justify-center gap-2",children:[g?e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}):e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),e.jsx("span",{children:t(c?"emails.modals.btn_update":"emails.modals.btn_add")})]})]}),children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2 uppercase tracking-wider",children:t("emails.modals.internal_name")}),e.jsx("input",{type:"text",className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-[#005954] focus:border-transparent bg-gray-50/50 transition-all text-sm",value:p.name,onChange:s=>d("name",s.target.value),placeholder:t("emails.modals.placeholder_name")}),l.name&&e.jsxs("p",{className:"text-red-500 text-xs mt-1.5 italic flex items-center gap-1",children:[e.jsx("span",{className:"not-italic",children:"⚠️"})," ",l.name]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2 uppercase tracking-wider",children:t("emails.modals.subject")}),e.jsx("input",{type:"text",className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-[#005954] focus:border-transparent bg-gray-50/50 transition-all text-sm",value:p.subject,onChange:s=>d("subject",s.target.value),placeholder:t("emails.modals.placeholder_subject")}),l.subject&&e.jsxs("p",{className:"text-red-500 text-xs mt-1.5 italic flex items-center gap-1",children:[e.jsx("span",{className:"not-italic",children:"⚠️"})," ",l.subject]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-end mb-2",children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-700 uppercase tracking-wider",children:[t("emails.modals.content_email")," (HTML)"]}),e.jsxs("span",{className:"text-[10px] text-gray-400 font-mono bg-gray-100 px-2 py-1 rounded",children:[t("emails.modals.placeholder_content"),": ","{name}"]})]}),e.jsx("textarea",{rows:"8",className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-[#005954] focus:border-transparent bg-gray-50/50 transition-all text-sm font-mono leading-relaxed",value:p.content,onChange:s=>d("content",s.target.value),placeholder:"<html>...</html>"}),l.content&&e.jsxs("p",{className:"text-red-500 text-xs mt-1.5 italic flex items-center gap-1",children:[e.jsx("span",{className:"not-italic",children:"⚠️"})," ",l.content]})]})]})}),e.jsx(k,{isOpen:S,onClose:()=>h(!1),title:t("emails.modal_histories.title"),subtitle:t("emails.modal_histories.subtitle"),icon:_,footer:null,children:a&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg border border-gray-100",children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider block mb-1",children:t("emails.modal_histories.recipient")}),e.jsx("span",{className:"text-gray-900 font-medium break-all",children:a?.to||"-"})]}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg border border-gray-100",children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider block mb-1",children:t("emails.modal_histories.sent_at")}),e.jsx("span",{className:"text-gray-900 font-medium",children:a?.sent_date||a?.created_at||"-"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"sm:col-span-2 bg-gray-50 p-3 rounded-lg border border-gray-100",children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider block mb-1",children:t("emails.modal_histories.subject")}),e.jsx("span",{className:"text-gray-900 font-medium",children:a?.subject||"-"})]}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg border border-gray-100",children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider block mb-1",children:t("emails.modal_histories.status")}),e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${a?.status==="success"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:a?.status||"-"})]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider block mb-2",children:t("emails.modal_histories.body_log")}),e.jsx("div",{className:"bg-slate-50 p-4 rounded-xl border border-gray-200 max-h-60 overflow-y-auto text-sm text-gray-700 font-mono whitespace-pre-wrap leading-relaxed shadow-inner",children:a?.body||t("emails.modal_histories.no_content")})]})]})})]})}export{xe as default};
