import{a as ae,r as i,b as k,j as e,c as A}from"./app-Dyd-VK-i.js";import{H as le}from"./HeaderLayout-Btj1rOYY.js";import{T as oe}from"./TableLayout-BIe_S7av.js";import{u as J}from"./useTranslation-C1duoCZq.js";import{X as G}from"./x-Dg_sVrJD.js";import{F as Y}from"./file-text-D0lOMtzR.js";import{T as B}from"./triangle-alert-in_WnGDb.js";import{C as H}from"./circle-alert-C3TtVEnV.js";import{S as ne}from"./search-AUTQuBot.js";import{C as ce}from"./chevron-down-BdiW-nc9.js";import{B as Z}from"./building-DpHZTUnz.js";import{U as se}from"./user-DGMjLAi-.js";import{C as ie}from"./check-BdTeYIzn.js";import{B as de}from"./briefcase-L_GldUNp.js";import{M as me}from"./mail-BkQVmhWp.js";import{P as pe}from"./phone-BFp8ONkp.js";import{c as ee}from"./createLucideIcon-CMta4jpe.js";import{M as xe}from"./map-pin-CstW7RZX.js";import{T as re}from"./trash-2-xd5U0av9.js";import{I as ue}from"./info-DDaJRL86.js";import{C as he}from"./circle-check-big-BEvmm_V7.js";import{C as ge}from"./chevron-right-CkR_1ISW.js";import{P as _e}from"./plus-B5n9R1EM.js";import"./transition-BVEVT5Dk.js";import"./index-BAWYnhaJ.js";import"./settings-D0070qy7.js";import"./send-C6E11V_I.js";import"./globe-36e_mGF8.js";const be=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],fe=ee("lock",be);const je=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]],ye=ee("shield-alert",je);const ve=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],Ne=ee("smartphone",ve);const we=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Ce=ee("upload",we),ke=({isOpen:v,onClose:M,clientTypes:n,quotationId:m,onSuccess:w})=>{const{flash:r}=ae().props,{t:s}=J(),[a,p]=i.useState({company_name:"",client_type_id:"",contact_person:"",contact_email:"",contact_phone:"",contact_position:"",city:"",province:"",country:"",postal_code:"",vat_number:"",nib:"",website:"",logo:null,status:"active",quotation_id:m||"",lead_id:""}),[d,f]=i.useState({}),[R,q]=i.useState(!1),[T,O]=i.useState(null),[z,X]=i.useState([]),[$,S]=i.useState(!1),[g,P]=i.useState(null),[Q,N]=i.useState(""),[j,E]=i.useState(null),[K,y]=i.useState(!1),[c,x]=i.useState(null),_=()=>{const l=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content");return console.log("CSRF Token found:",l?"Yes":"No"),l};i.useEffect(()=>{const l=_();k.defaults.headers.common["X-Requested-With"]="XMLHttpRequest",k.defaults.withCredentials=!0,l?(k.defaults.headers.common["X-CSRF-TOKEN"]=l,console.log("CSRF Token set for axios")):console.warn("CSRF Token not found!"),k.defaults.headers.common.Accept="application/json"},[]),i.useEffect(()=>{v&&(console.log("Modal opened..."),p({company_name:"",client_type_id:"",contact_person:"",contact_email:"",contact_phone:"",contact_position:"",city:"",province:"",country:"",postal_code:"",vat_number:"",nib:"",website:"",logo:null,status:"active",quotation_id:m||"",lead_id:""}),P(null),E(null),N(""),O(null),f({}),x(null),m?F(m):C())},[v,m]);const C=async()=>{S(!0);try{const l=_(),t=await k.get("/companies/get-accepted-quotations",{headers:{"X-CSRF-TOKEN":l,Accept:"application/json"}});t&&t.data&&t.data.success?(X(t.data.data||[]),t.data.data&&t.data.data.length===0&&x({type:"info",message:s("companies_create.no_available_quotations")})):X([])}catch(l){console.error("Error fetching quotations:",l),X([])}finally{S(!1)}},I=async l=>{x(null),P(l),E(null),p(t=>({...t,quotation_id:l.id,lead_id:l.lead?.id||"",company_name:l.lead?.company_name||t.company_name,contact_person:l.lead?.contact_person||t.contact_person,contact_email:l.lead?.email||t.contact_email,contact_phone:l.lead?.phone||t.contact_phone,contact_position:l.lead?.position||s("companies_create.contact_person"),vat_number:l.lead?.vat_number||"",nib:l.lead?.nib||"",website:l.lead?.website||""})),l.lead&&E(l.lead)},F=async l=>{if(l){y(!0),x(null);try{const t=_(),o=await k.get(`/companies/get-lead-from-quotation/${l}`,{headers:{"X-CSRF-TOKEN":t,Accept:"application/json"}});if(o&&o.data)if(o.data.success){const h=o.data.data;E(h),p(b=>({...b,quotation_id:l,lead_id:h.id||"",company_name:h.company_name||b.company_name,contact_person:h.contact_person||b.contact_person,contact_email:h.email||b.contact_email,contact_phone:h.phone||b.contact_phone,contact_position:h.position||s("companies_create.contact_person"),city:h.city||b.city,province:h.province||b.province,country:h.country||b.country,postal_code:h.postal_code||b.postal_code,vat_number:h.vat_number||"",nib:h.nib||"",website:h.website||""}))}else o.data.message&&(o.data.message.includes("sudah digunakan")||o.data.message.includes("already used"))?(x({type:"error",message:o.data.message,company_name:o.data.company_name,company_id:o.data.company_id}),p(h=>({...h,quotation_id:"",lead_id:""}))):alert(o.data.message||s("companies_create.error_fetching_lead"))}catch(t){console.error("Error fetching lead:",t),t.response?.status===400&&t.response?.data?.message?(t.response.data.message.includes("sudah digunakan")||t.response.data.message.includes("already used"))&&(x({type:"error",message:t.response.data.message,company_name:t.response.data.company_name,company_id:t.response.data.company_id}),p(o=>({...o,quotation_id:"",lead_id:""}))):alert(s("companies_create.error_fetching_lead"))}finally{y(!1)}}},V=()=>{P(null),E(null),x(null),p(l=>({...l,quotation_id:"",lead_id:"",company_name:"",contact_person:"",contact_email:"",contact_phone:"",vat_number:"",nib:"",website:"",city:"",province:"",country:"",postal_code:""})),N("")},W=z.filter(l=>{if(!Q)return!0;const t=Q.toLowerCase();return l.quotation_number?.toLowerCase().includes(t)||l.subject?.toLowerCase().includes(t)||l.lead?.company_name?.toLowerCase().includes(t)||l.lead?.contact_person?.toLowerCase().includes(t)}),L=l=>{const{name:t,value:o,type:h,files:b}=l.target;if(h==="file"){const D=b[0];if(p(u=>({...u,[t]:D})),D){const u=new FileReader;u.onloadend=()=>{O(u.result)},u.readAsDataURL(D)}else O(null)}else p(D=>({...D,[t]:o}));d[t]&&f(D=>({...D,[t]:null}))},te=async l=>{l.preventDefault(),q(!0),f({}),console.log("=== FORM SUBMISSION STARTED ==="),console.log("Form data before submit:",a);const t=["company_name","client_type_id","contact_person","contact_email","contact_phone","status"];let o=!1;const h={};if(t.forEach(u=>{a[u]||(h[u]=s("companies_create.field_required",{field:u.replace("_"," ")}),o=!0)}),o){f(h),q(!1);return}const b=new FormData,D=_();D&&b.append("_token",D),Object.entries(a).forEach(([u,U])=>{U!=null&&U!==""&&(u==="logo"&&U instanceof File?b.append("logo",U):b.append(u,U.toString()))}),a.contact_person&&b.append("name",a.contact_person),m&&!a.quotation_id&&b.append("quotation_id",m);try{console.log("Sending form data..."),console.log("CSRF Token to send:",D);const u=await k.post("/companies",b,{headers:{"Content-Type":"multipart/form-data"}});console.log("Server response:",u),u&&u.data&&u.data.success?(alert(u.data.message||s("companies_create.client_created_successfully")),M(),p({company_name:"",client_type_id:"",contact_person:"",contact_email:"",contact_phone:"",contact_position:"",city:"",province:"",country:"",postal_code:"",vat_number:"",nib:"",website:"",logo:null,status:"active",quotation_id:"",lead_id:""}),P(null),E(null),x(null),O(null),w&&w(),A.reload({only:["companies","statistics"],preserveScroll:!0})):(f(u?.data?.errors||{}),alert(u?.data?.message||s("companies_create.failed_to_create_client")))}catch(u){if(console.error("Error creating client:",u),console.error("Error details:",u.response?.data),u.response?.status===419){const U=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content");console.log("Current CSRF token:",U),alert("CSRF token expired. Please refresh the page and try again."),window.location.reload()}else if(u.response?.status===422){f(u.response.data.errors||{});const U=Object.values(u.response.data.errors||{}).flat().join(`
`);U&&alert(s("companies_create.validation_errors")+`
`+U)}else u.response?.status===400&&u.response?.data?.message?u.response.data.message.includes("already used")||u.response.data.message.includes("sudah digunakan")?(x({type:"error",message:u.response.data.message,company_name:u.response.data.company_name,company_id:u.response.data.company_id}),alert(s("companies_create.quotation_already_used"))):alert(u.response.data.message||s("companies_create.error_creating_client")):alert(`${s("companies_create.error_creating_client")}: ${u.response?.data?.message||u.message}`)}finally{q(!1)}};return v?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-hidden",children:[e.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:s("companies_create.title")}),e.jsx("p",{className:"text-gray-600 mt-1",children:s("companies_create.subtitle")}),m&&e.jsxs("div",{className:"mt-1 text-sm text-blue-600",children:[s("companies_create.creating_from_quotation"),": ",e.jsx("strong",{children:m})]})]}),e.jsx("button",{onClick:M,className:"p-2 hover:bg-gray-100 rounded-lg transition",children:e.jsx(G,{className:"w-6 h-6 text-gray-500"})})]}),e.jsxs("form",{onSubmit:te,className:"overflow-y-auto max-h-[calc(90vh-200px)]",children:[e.jsxs("div",{className:"p-6 space-y-6",children:[!m&&e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsxs("h3",{className:"font-medium text-blue-900 mb-3 flex items-center gap-2",children:[e.jsx(Y,{className:"w-5 h-5"}),s("companies_create.select_from_quotation")]}),c&&e.jsxs("div",{className:`mb-4 p-3 rounded-lg flex items-start gap-2 ${c.type==="error"?"bg-red-100 border border-red-300 text-red-800":"bg-yellow-100 border border-yellow-300 text-yellow-800"}`,children:[c.type==="error"?e.jsx(B,{className:"w-5 h-5 flex-shrink-0 mt-0.5"}):e.jsx(H,{className:"w-5 h-5 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium",children:c.message}),c.company_name&&e.jsxs("p",{className:"text-sm mt-1",children:[s("companies_create.already_has_company"),":",e.jsx("strong",{className:"ml-1",children:c.company_name}),c.company_id&&e.jsxs("span",{className:"ml-2 text-xs",children:["(ID: ",c.company_id,")"]})]})]})]}),$?e.jsxs("div",{className:"text-center py-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:s("companies_create.loading_quotations")})]}):e.jsx("div",{className:"space-y-3",children:g?e.jsx("div",{className:"bg-white border border-green-300 rounded-lg p-4",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-green-700",children:g.quotation_number}),e.jsx("span",{className:"px-2 py-1 text-xs bg-green-100 text-green-800 rounded",children:s("companies_create.accepted")}),e.jsx("span",{className:"px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded",children:s("companies_create.unused")})]}),e.jsx("div",{className:"text-sm text-gray-600 mt-1",children:g.subject}),g.lead&&e.jsx("div",{className:"mt-2 text-sm",children:e.jsx("div",{className:"font-medium text-gray-700",children:g.lead.company_name})})]}),e.jsx("button",{type:"button",onClick:V,className:"text-gray-400 hover:text-gray-600 p-1",children:e.jsx(G,{className:"w-5 h-5"})})]})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative",children:[e.jsx(ne,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:s("companies_create.search_quotations"),value:Q,onChange:l=>N(l.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsx("div",{className:"max-h-60 overflow-y-auto border border-gray-200 rounded-lg",children:W.length>0?W.map(l=>e.jsx("div",{onClick:()=>I(l),className:"p-3 border-b border-gray-100 hover:bg-gray-50 cursor-pointer transition last:border-b-0",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-medium text-gray-900",children:l.quotation_number}),e.jsx("span",{className:"px-2 py-0.5 text-xs bg-green-100 text-green-800 rounded",children:s("companies_create.accepted")}),e.jsx("span",{className:"px-2 py-0.5 text-xs bg-blue-100 text-blue-800 rounded",children:s("companies_create.unused")})]}),e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:l.subject}),l.lead&&e.jsxs("div",{className:"text-xs text-gray-500",children:[l.lead.company_name," â€¢ ",l.lead.contact_person]})]}),e.jsx(ce,{className:"w-5 h-5 text-gray-400"})]})},l.id)):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-12 h-12 rounded-full bg-gray-100 mb-3",children:e.jsx(Y,{className:"w-6 h-6 text-gray-400"})}),e.jsx("p",{className:"text-sm text-gray-600 font-medium",children:s(Q?"companies_create.no_quotations_found_search":"companies_create.no_available_quotations")}),!Q&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:s("companies_create.all_quotations_used")})]})}),e.jsxs("div",{className:"mt-3 p-2 bg-gray-50 border border-gray-200 rounded text-xs text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500"}),e.jsx("span",{children:s("companies_create.available_quotations")})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-gray-400"}),e.jsx("span",{children:s("companies_create.used_quotations_hidden")})]})]}),e.jsx("p",{className:"mt-1",children:s("companies_create.only_unused_quotations_shown")})]})]})})]}),m&&c&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(B,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-red-800",children:s("companies_create.quotation_unavailable")}),e.jsx("p",{className:"text-sm text-red-700 mt-1",children:c.message}),c.company_name&&e.jsxs("div",{className:"mt-2 p-2 bg-red-100 rounded",children:[e.jsx("p",{className:"text-sm font-medium",children:s("companies_create.quotation_already_used_by")}),e.jsxs("p",{className:"text-sm",children:[c.company_name,c.company_id&&e.jsxs("span",{className:"ml-2 text-xs",children:["(ID: ",c.company_id,")"]})]})]})]})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(Z,{className:"w-5 h-5"}),s("companies_create.company_information")]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s("companies_create.company_name")," ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{type:"text",name:"company_name",value:a.company_name,onChange:L,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 ${d.company_name?"border-red-300":"border-gray-300"}`,required:!0,placeholder:s("companies_create.company_name_placeholder"),disabled:!m&&!g}),d.company_name&&e.jsx("p",{className:"text-xs text-red-600 mt-1",children:d.company_name})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s("companies_create.client_type")," ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsxs("select",{name:"client_type_id",value:a.client_type_id,onChange:L,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 ${d.client_type_id?"border-red-300":"border-gray-300"}`,required:!0,disabled:!m&&!g,children:[e.jsx("option",{value:"",children:s("companies_create.select_client_type")}),n&&n.map(l=>e.jsx("option",{value:l.id,children:l.name},l.id))]}),d.client_type_id&&e.jsx("p",{className:"text-xs text-red-600 mt-1",children:d.client_type_id})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s("companies_create.city")," ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{type:"text",name:"city",value:a.city,onChange:L,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 ${d.city?"border-red-300":"border-gray-300"}`,required:!0,placeholder:s("companies_create.city_placeholder"),disabled:!m&&!g}),d.city&&e.jsx("p",{className:"text-xs text-red-600 mt-1",children:d.city})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s("companies_create.province")," ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{type:"text",name:"province",value:a.province,onChange:L,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 ${d.province?"border-red-300":"border-gray-300"}`,required:!0,placeholder:s("companies_create.province_placeholder"),disabled:!m&&!g}),d.province&&e.jsx("p",{className:"text-xs text-red-600 mt-1",children:d.province})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s("companies_create.country")," ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{type:"text",name:"country",value:a.country,onChange:L,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 ${d.country?"border-red-300":"border-gray-300"}`,required:!0,placeholder:s("companies_create.country_placeholder"),disabled:!m&&!g}),d.country&&e.jsx("p",{className:"text-xs text-red-600 mt-1",children:d.country})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s("companies_create.postal_code")," ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{type:"text",name:"postal_code",value:a.postal_code,onChange:L,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 ${d.postal_code?"border-red-300":"border-gray-300"}`,required:!0,placeholder:s("companies_create.postal_code_placeholder"),disabled:!m&&!g}),d.postal_code&&e.jsx("p",{className:"text-xs text-red-600 mt-1",children:d.postal_code})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:s("companies_create.vat_number")}),e.jsx("input",{type:"text",name:"vat_number",value:a.vat_number,onChange:L,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500",placeholder:s("companies_create.vat_number_placeholder"),disabled:!m&&!g})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:s("companies_create.nib")}),e.jsx("input",{type:"text",name:"nib",value:a.nib,onChange:L,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500",placeholder:s("companies_create.nib_placeholder"),disabled:!m&&!g})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:s("companies_create.website")}),e.jsx("input",{type:"url",name:"website",value:a.website,onChange:L,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500",placeholder:s("companies_create.website_placeholder"),disabled:!m&&!g})]})]})]}),e.jsxs("div",{className:"border-t pt-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2 mb-4",children:[e.jsx(se,{className:"w-5 h-5"}),s("companies_create.contact_information")]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s("companies_create.contact_person")," ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{type:"text",name:"contact_person",value:a.contact_person,onChange:L,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 ${d.contact_person?"border-red-300":"border-gray-300"}`,required:!0,placeholder:s("companies_create.contact_person_placeholder"),disabled:!m&&!g}),d.contact_person&&e.jsx("p",{className:"text-xs text-red-600 mt-1",children:d.contact_person})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s("companies_create.position")," ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{type:"text",name:"contact_position",value:a.contact_position,onChange:L,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 ${d.contact_position?"border-red-300":"border-gray-300"}`,required:!0,placeholder:s("companies_create.position_placeholder"),disabled:!m&&!g}),d.contact_position&&e.jsx("p",{className:"text-xs text-red-600 mt-1",children:d.contact_position})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s("companies_create.email")," ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{type:"email",name:"contact_email",value:a.contact_email,onChange:L,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 ${d.contact_email?"border-red-300":"border-gray-300"}`,required:!0,placeholder:s("companies_create.email_placeholder"),disabled:!m&&!g}),d.contact_email&&e.jsx("p",{className:"text-xs text-red-600 mt-1",children:d.contact_email})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s("companies_create.phone")," ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{type:"tel",name:"contact_phone",value:a.contact_phone,onChange:L,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 ${d.contact_phone?"border-red-300":"border-gray-300"}`,required:!0,placeholder:s("companies_create.phone_placeholder"),disabled:!m&&!g}),d.contact_phone&&e.jsx("p",{className:"text-xs text-red-600 mt-1",children:d.contact_phone})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 pt-6 border-t",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:s("companies_create.company_logo")}),e.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4 hover:border-teal-500 transition",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("input",{type:"file",name:"logo",onChange:L,accept:"image/*",className:"w-full border border-gray-300 rounded-lg px-3 py-2.5 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:!m&&!g}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:s("companies_create.file_requirements")})]}),T&&e.jsx("div",{className:"w-16 h-16",children:e.jsx("img",{src:T,alt:s("companies_create.logo_preview"),className:"w-full h-full object-cover rounded-lg border border-gray-300"})})]})})]})})]}),e.jsxs("div",{className:"bg-gray-50 px-6 py-4 border-t flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:M,disabled:R,className:"px-4 py-2 text-gray-700 hover:text-gray-900 font-medium",children:s("companies_create.cancel")}),e.jsx("button",{type:"submit",disabled:R||!m&&!g||c,className:`px-6 py-2 font-medium rounded-lg flex items-center gap-2 ${R||!m&&!g||c?"bg-gray-400 text-white cursor-not-allowed":"bg-teal-700 hover:bg-teal-800 text-white"}`,children:R?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),s("companies_create.creating")]}):s("companies_create.create_client")})]})]})]})}):null},Se=({isOpen:v,onClose:M,company:n,clientTypes:m,onUpdate:w})=>{const{t:r}=J(),[s,a]=i.useState({company_name:"",client_type_id:"",status:"active",city:"",province:"",country:"",postal_code:"",vat_number:"",nib:"",website:"",logo:null,logo_preview:"",delete_logo:!1,contact_person:"",contact_email:"",contact_phone:"",contact_position:""}),[p,d]=i.useState({}),[f,R]=i.useState(!1),[q,T]=i.useState(null),[O,z]=i.useState(!1),[X,$]=i.useState(!1),[S,g]=i.useState(!1),P=i.useRef(!1);i.useEffect(()=>{k.defaults.headers.common["X-Requested-With"]="XMLHttpRequest",k.defaults.withCredentials=!0;const y=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content");y&&(k.defaults.headers.common["X-CSRF-TOKEN"]=y)},[]),i.useEffect(()=>((async()=>{if(!(!v||!n||m.length===0||P.current)){P.current=!0,g(!1),console.log("=== EDIT MODAL INITIALIZATION ==="),console.log("Full company data received:",n),console.log("Lead data:",n.lead),console.log("Primary contact:",n.primary_contact),console.log("Client Types available:",m);try{const c=n.company_name||n.lead?.company_name||n.client_code||n.name||"",x={contact_person:n.contact_person||n.primary_contact?.name||n.lead?.contact_person||"",contact_email:n.contact_email||n.email||n.primary_contact?.email||n.lead?.email||"",contact_phone:n.contact_phone||n.phone||n.primary_contact?.phone||n.lead?.phone||"",contact_position:n.contact_position||n.primary_contact?.position||n.lead?.position||""};console.log("Company Name resolved:",{fromProp:n.company_name,fromLead:n.lead?.company_name,fromClientCode:n.client_code,fromName:n.name,finalValue:c}),console.log("Contact data resolved:",x);const _={company_name:c,client_type_id:n.client_type_id||(m.length>0?m[0].id:""),status:n.is_active?"active":"inactive",city:n.city||"",province:n.province||"",country:n.country||"",postal_code:n.postal_code?.toString()||"",vat_number:n.vat_number?.toString()||"",nib:n.nib||"",website:n.website||"",logo:null,logo_preview:n.logo_url||"",delete_logo:!1,contact_person:x.contact_person,contact_email:x.contact_email,contact_phone:x.contact_phone,contact_position:x.contact_position};console.log("Form data to be set:",_),a(_);const C=x.contact_person||x.contact_email||x.contact_phone;$(!!C),!C&&n.id&&await Q(n.id,_),console.log("=== FORM INITIALIZED SUCCESSFULLY ===")}catch(c){console.error("Error during form initialization:",c)}finally{g(!0),P.current=!1}}})(),()=>{s.logo_preview&&s.logo_preview.startsWith("blob:")&&URL.revokeObjectURL(s.logo_preview)}),[v,n,m]);const Q=async(y,c)=>{z(!0);try{console.log("Fetching contact data from API for company:",y);const x=await k.get(`/api/companies/${y}/primary-contact`);if(x.data.success&&x.data.data){const _=x.data.data;console.log("Contact API data received:",_),a(C=>({...C,contact_person:_.name||"",contact_email:_.email||"",contact_phone:_.phone||"",contact_position:_.position||""})),$(!0)}else console.log("No contact data from API"),$(!1)}catch(x){console.error("Error fetching contact data:",x),$(!1)}finally{z(!1)}},N=y=>{const{name:c,value:x,type:_,checked:C,files:I}=y.target;if(c==="company_name"){console.log("Company name is read-only, ignoring change attempt");return}if(_==="radio")a(F=>({...F,[c]:x}));else if(_==="file"){const F=I[0];if(F){T(F);const V=URL.createObjectURL(F);a(W=>({...W,logo:F,logo_preview:V,delete_logo:!1}))}}else a(F=>({...F,[c]:x}));p[c]&&d(F=>({...F,[c]:null}))},j=()=>{s.logo_preview&&s.logo_preview.startsWith("blob:")&&URL.revokeObjectURL(s.logo_preview),a(y=>({...y,logo:null,logo_preview:"",delete_logo:!0})),T(null)},E=async y=>{y.preventDefault(),R(!0),d({});try{const c={company_name:s.company_name||"",client_type_id:s.client_type_id||"",status:s.status||"active",city:s.city||"",province:s.province||"",country:s.country||"",postal_code:s.postal_code&&parseInt(s.postal_code)||null,vat_number:s.vat_number&&parseInt(s.vat_number)||null,nib:s.nib||"",website:s.website||"",contact_person:s.contact_person||"",contact_email:s.contact_email||"",contact_phone:s.contact_phone||"",contact_position:s.contact_position||"",delete_logo:s.delete_logo?"1":"0"};console.log("=== SUBMITTING UPDATE DATA ==="),console.log("Company ID:",n.id),console.log("Company Name (read-only, for validation):",c.company_name),console.log("Client Code (will remain unchanged):",n.client_code),console.log("Full request data:",c);const x=new FormData;Object.keys(c).forEach(C=>{c[C]!==null&&c[C]!==void 0&&x.append(C,c[C])}),s.logo&&(x.append("logo",s.logo),console.log("Logo file appended:",s.logo.name));const _=await k.post(`/companies/${n.id}`,x,{headers:{"Content-Type":"multipart/form-data",Accept:"application/json"},params:{_method:"PUT"}});console.log("Server response:",_.data),_.data.success?(alert(_.data.message||r("companies_edit.client_updated_successfully")),s.logo_preview&&s.logo_preview.startsWith("blob:")&&URL.revokeObjectURL(s.logo_preview),w&&w(_.data.data||n.id),A.reload({only:["companies","statistics"],preserveScroll:!0}),M()):(console.error("Update failed:",_.data),d(_.data.errors||{}),alert(_.data.message||r("companies_edit.failed_to_update_client")))}catch(c){if(console.error("Error updating client:",c),c.response?.status===422){const x=c.response.data.errors||{};d(x),console.log("Validation errors:",x);const _=Object.entries(x).map(([C,I])=>Array.isArray(I)?`${C}: ${I.join(", ")}`:`${C}: ${I}`);_.length>0?alert(`${r("companies_edit.validation_errors")}:
${_.join(`
`)}`):alert(r("companies_edit.check_form_errors"))}else{const x=c.response?.data?.message||c.message||r("companies_edit.error_occurred");d(_=>({..._,submit:x})),alert(`${r("companies_edit.error_updating_client")}: ${x}`)}}finally{R(!1)}},K=()=>{s.logo_preview&&s.logo_preview.startsWith("blob:")&&URL.revokeObjectURL(s.logo_preview),M()};return!v||!n||!S?null:e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-6xl max-h-[95vh] overflow-hidden",children:[e.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:r("companies_edit.title")}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsxs("p",{className:"text-gray-600",children:[r("companies_edit.editing"),": ",e.jsx("span",{className:"font-medium",children:n.client_code})]}),n.id&&e.jsxs("span",{className:"text-xs bg-gray-100 px-2 py-1 rounded text-gray-500",children:["ID: ",n.id]})]}),e.jsxs("div",{className:"mt-1 text-sm",children:[e.jsx("span",{className:"text-gray-700 font-medium",children:"Company Name: "}),e.jsx("span",{className:"text-blue-600 font-semibold",children:s.company_name}),e.jsx("span",{className:"ml-2 text-xs text-gray-500",children:"(Read Only - from Leads)"})]}),O?e.jsxs("p",{className:"text-sm text-blue-600 mt-1 flex items-center gap-1",children:[e.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-blue-600"}),r("companies_edit.loading_contact_data")]}):X?e.jsxs("p",{className:"text-sm text-green-600 mt-1 flex items-center gap-1",children:[e.jsx(ie,{className:"w-3 h-3"}),r("companies_edit.contact_data_loaded")]}):e.jsxs("p",{className:"text-sm text-yellow-600 mt-1 flex items-center gap-1",children:[e.jsx(H,{className:"w-3 h-3"}),r("companies_edit.no_contact_data")]})]}),e.jsx("button",{onClick:K,className:"p-2 hover:bg-gray-100 rounded-lg transition",disabled:f,children:e.jsx(G,{className:"w-6 h-6 text-gray-500"})})]}),e.jsxs("form",{onSubmit:E,className:"overflow-y-auto max-h-[calc(95vh-180px)]",children:[e.jsxs("div",{className:"p-6 space-y-8",children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-xl p-6",children:[e.jsxs("h3",{className:"text-xl font-bold text-blue-900 mb-4 flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(se,{className:"w-6 h-6 text-blue-600"})}),r("companies_edit.contact_person_information")]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2",children:[e.jsx(se,{className:"w-4 h-4 text-blue-500"}),r("companies_edit.contact_person_name")," *"]}),e.jsx("input",{type:"text",name:"contact_person",value:s.contact_person,onChange:N,className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition ${p.contact_person?"border-red-300 bg-red-50":"border-blue-200"}`,placeholder:r("companies_edit.contact_person_placeholder"),required:!0}),p.contact_person&&e.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[e.jsx(H,{className:"w-3 h-3"}),p.contact_person]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2",children:[e.jsx(de,{className:"w-4 h-4 text-blue-500"}),r("companies_edit.position")]}),e.jsx("input",{type:"text",name:"contact_position",value:s.contact_position,onChange:N,className:"w-full px-4 py-3 border border-blue-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",placeholder:r("companies_edit.position_placeholder")})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2",children:[e.jsx(me,{className:"w-4 h-4 text-blue-500"}),r("companies_edit.email_address")," *"]}),e.jsx("input",{type:"email",name:"contact_email",value:s.contact_email,onChange:N,className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition ${p.contact_email?"border-red-300 bg-red-50":"border-blue-200"}`,placeholder:r("companies_edit.email_placeholder"),required:!0}),p.contact_email&&e.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[e.jsx(H,{className:"w-3 h-3"}),p.contact_email]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2",children:[e.jsx(pe,{className:"w-4 h-4 text-blue-500"}),r("companies_edit.phone_number")," *"]}),e.jsx("input",{type:"tel",name:"contact_phone",value:s.contact_phone,onChange:N,className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition ${p.contact_phone?"border-red-300 bg-red-50":"border-blue-200"}`,placeholder:r("companies_edit.phone_placeholder"),required:!0}),p.contact_phone&&e.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[e.jsx(H,{className:"w-3 h-3"}),p.contact_phone]}),e.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[e.jsx(Ne,{className:"w-3 h-3"}),r("companies_edit.phone_format")]})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-teal-50 to-emerald-50 border border-teal-200 rounded-xl p-6",children:[e.jsxs("h3",{className:"text-xl font-bold text-teal-900 mb-4 flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-teal-100 rounded-lg",children:e.jsx(Z,{className:"w-6 h-6 text-teal-600"})}),r("companies_edit.company_information")]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2",children:[e.jsx(Z,{className:"w-4 h-4 text-teal-500"}),r("companies_edit.company_name")," ",e.jsx("span",{className:"text-red-600",children:"*"}),e.jsx("span",{className:"ml-2 text-xs text-blue-600 font-normal bg-blue-50 px-2 py-0.5 rounded",children:"Read Only"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"w-full px-4 py-3 border border-teal-200 rounded-lg bg-gray-50 text-gray-800 flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center",children:e.jsx("div",{className:"font-medium",children:s.company_name})}),e.jsxs("div",{className:"flex items-center text-gray-500",children:[e.jsx(fe,{className:"w-4 h-4 mr-1"}),e.jsx("span",{className:"text-xs",children:"Locked"})]})]}),e.jsx("input",{type:"hidden",name:"company_name",value:s.company_name,required:!0})]}),e.jsxs("div",{className:"mt-2 flex items-start text-xs text-gray-500",children:[e.jsx(H,{className:"w-3 h-3 mr-1 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Company name is retrieved from the associated Lead record and cannot be edited here. To change the company name, please update the corresponding Lead in the Leads section."})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:[r("companies_edit.client_type")," ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsxs("select",{name:"client_type_id",value:s.client_type_id,onChange:N,className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition ${p.client_type_id?"border-red-300 bg-red-50":"border-teal-200"}`,required:!0,children:[e.jsx("option",{value:"",children:r("companies_edit.select_client_type")}),m.map(y=>e.jsxs("option",{value:y.id,children:[y.name," ",y.information?`- ${y.information}`:""]},y.id))]}),p.client_type_id&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:p.client_type_id})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("h4",{className:"text-lg font-semibold text-gray-800 mb-3 flex items-center gap-2",children:[e.jsx(xe,{className:"w-5 h-5 text-teal-600"}),r("companies_edit.location_information")]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r("companies_edit.city")," ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{type:"text",name:"city",value:s.city,onChange:N,className:"w-full px-3 py-2 border border-teal-200 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500",placeholder:r("companies_edit.city_placeholder"),required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r("companies_edit.province")," ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{type:"text",name:"province",value:s.province,onChange:N,className:"w-full px-3 py-2 border border-teal-200 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500",placeholder:r("companies_edit.province_placeholder"),required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r("companies_edit.country")," ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{type:"text",name:"country",value:s.country,onChange:N,className:"w-full px-3 py-2 border border-teal-200 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500",placeholder:r("companies_edit.country_placeholder"),required:!0})]})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("h4",{className:"text-lg font-semibold text-gray-800 mb-3 flex items-center gap-2",children:[e.jsx(Y,{className:"w-5 h-5 text-teal-600"}),r("companies_edit.business_details")]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r("companies_edit.postal_code")," ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{type:"text",name:"postal_code",value:s.postal_code,onChange:N,className:"w-full px-3 py-2 border border-teal-200 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500",placeholder:r("companies_edit.postal_code_placeholder"),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:r("companies_edit.vat_number")}),e.jsx("input",{type:"text",name:"vat_number",value:s.vat_number,onChange:N,className:"w-full px-3 py-2 border border-teal-200 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500",placeholder:r("companies_edit.vat_number_placeholder")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:r("companies_edit.nib_number")}),e.jsx("input",{type:"text",name:"nib",value:s.nib,onChange:N,className:"w-full px-3 py-2 border border-teal-200 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500",placeholder:r("companies_edit.nib_placeholder")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:r("companies_edit.website")}),e.jsx("input",{type:"url",name:"website",value:s.website,onChange:N,className:"w-full px-3 py-2 border border-teal-200 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500",placeholder:r("companies_edit.website_placeholder")})]})]})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:r("companies_edit.company_logo")}),s.logo_preview?e.jsx("div",{className:"relative",children:e.jsx("div",{className:"border-2 border-dashed border-teal-300 rounded-xl p-4 bg-gradient-to-br from-teal-50 to-white",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("div",{className:"relative mb-4",children:[e.jsx("img",{src:s.logo_preview,alt:r("companies_edit.logo_preview"),className:"w-40 h-40 object-contain rounded-xl shadow-md"}),e.jsx("button",{type:"button",onClick:j,className:"absolute -top-2 -right-2 bg-red-500 text-white p-2 rounded-full hover:bg-red-600 transition shadow-lg",title:r("companies_edit.remove_logo"),children:e.jsx(re,{className:"w-4 h-4"})})]}),e.jsx("p",{className:"text-sm text-gray-500 text-center",children:r("companies_edit.current_logo")})]})})}):e.jsxs("div",{className:"border-2 border-dashed border-teal-300 rounded-xl p-6 text-center bg-gradient-to-br from-teal-50 to-white hover:border-teal-400 transition cursor-pointer",children:[e.jsx("input",{type:"file",id:"logo-upload",name:"logo",onChange:N,className:"hidden",accept:"image/*"}),e.jsxs("label",{htmlFor:"logo-upload",className:"cursor-pointer",children:[e.jsx(Ce,{className:"w-12 h-12 text-teal-400 mx-auto mb-3"}),e.jsx("div",{className:"font-medium text-teal-700 hover:text-teal-800",children:r("companies_edit.upload_new_logo")}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:r("companies_edit.file_requirements")}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:r("companies_edit.recommended_size")})]})]})]})})]}),e.jsxs("div",{className:"bg-gradient-to-r from-gray-50 to-gray-100 px-6 py-4 border-t flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm text-gray-600",children:[r("companies_edit.editing_client"),": ",e.jsx("span",{className:"font-semibold",children:n.client_code})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsxs("p",{className:"text-xs text-gray-500",children:["Company Name: ",e.jsx("span",{className:"font-medium text-blue-600",children:s.company_name})]}),e.jsx("span",{className:"text-xs bg-gray-200 text-gray-700 px-2 py-0.5 rounded",children:"Read Only"})]}),O&&e.jsx("p",{className:"text-xs text-blue-600 mt-1",children:r("companies_edit.loading_contact_information")})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"button",onClick:K,disabled:f,className:"px-5 py-2.5 text-gray-700 hover:text-gray-900 font-medium disabled:opacity-50 hover:bg-gray-200 rounded-lg transition",children:r("companies_edit.cancel")}),e.jsx("button",{type:"submit",disabled:f,className:"px-6 py-2.5 bg-gradient-to-r from-teal-600 to-teal-700 hover:from-teal-700 hover:to-teal-800 text-white font-medium rounded-lg disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 transition-all shadow-md hover:shadow-lg",children:f?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),r("companies_edit.updating")]}):r("companies_edit.update_client_contact")})]})]})]})]})})},Ee=({isOpen:v,onClose:M,company:n,onDelete:m,isBulk:w=!1,selectedCount:r=0,selectedIds:s=[]})=>{const{t:a}=J(),[p,d]=i.useState(!1),[f,R]=i.useState(""),[q,T]=i.useState(""),[O,z]=i.useState(!1);if(i.useEffect(()=>{k.defaults.headers.common["X-Requested-With"]="XMLHttpRequest",k.defaults.withCredentials=!0;const j=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content");j&&(k.defaults.headers.common["X-CSRF-TOKEN"]=j)},[]),i.useEffect(()=>{const j=()=>{z(window.innerWidth<640)};return j(),window.addEventListener("resize",j),()=>window.removeEventListener("resize",j)},[]),i.useEffect(()=>{const j=E=>{E.key==="Escape"&&v&&S()};return document.addEventListener("keydown",j),()=>document.removeEventListener("keydown",j)},[v]),!v)return null;const X=async()=>{d(!0),T("");try{let j;if(w&&s.length>0){const E=s.map(c=>k.delete(`/companies/${c}`)),y=(await Promise.all(E)).filter(c=>c.data?.success).length;if(y>0)j={data:{success:!0,message:a("companies_delete.bulk_delete_success",{count:y})}};else throw new Error(a("companies_delete.bulk_delete_failed"))}else if(n)j=await k.delete(`/companies/${n.id}`);else throw new Error(a("companies_delete.no_company_selected"));j.data.success?(alert(j.data.message||a("companies_delete.delete_success")),m&&m(),A.reload({only:["companies","statistics"],preserveScroll:!0}),M(),$()):(T(j.data.message||a("companies_delete.delete_failed")),alert(j.data.message||a("companies_delete.delete_failed")))}catch(j){console.error("Delete error:",j);const E=j.response?.data?.message||j.message||a("companies_delete.delete_error_try_again");T(E),alert(`${a("companies_delete.error")}: ${E}`)}finally{d(!1)}},$=()=>{R(""),T("")},S=()=>{$(),M()},g=()=>w?a("companies_delete.bulk_delete_title",{count:r}):a("companies_delete.delete_client"),P=()=>w?a("companies_delete.bulk_delete_message",{count:r}):a("companies_delete.delete_message",{name:n?.client_code||n?.name}),Q=()=>w?a("companies_delete.bulk_confirmation",{count:r}):a("companies_delete.confirmation",{name:n?.client_code||n?.name});return(w?s.length>0:n)?e.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[e.jsx("div",{className:"fixed inset-0 bg-black/50",onClick:S}),e.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-auto relative",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 sm:p-6 border-b",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:e.jsx(B,{className:"w-5 h-5 sm:w-6 sm:h-6 text-red-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg sm:text-xl font-bold text-gray-900",children:g()}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-600 mt-1",children:a("companies_delete.can_be_restored")})]})]}),e.jsx("button",{onClick:S,className:"p-2 hover:bg-gray-100 rounded-lg transition",disabled:p,children:e.jsx(G,{className:"w-5 h-5 text-gray-500"})})]}),e.jsxs("div",{className:"p-4 sm:p-6 space-y-4 max-h-[70vh] overflow-y-auto",children:[q&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(B,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),e.jsx("div",{children:e.jsx("p",{className:"text-sm text-red-800 font-medium",children:q})})]})}),e.jsx("div",{className:"border rounded-lg p-4 bg-yellow-50 border-yellow-200",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ye,{className:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-yellow-800",children:P()}),!w&&n&&e.jsxs("div",{className:"mt-2 space-y-1",children:[n.client_code&&e.jsxs("p",{className:"text-sm text-yellow-700",children:[e.jsxs("span",{className:"font-semibold",children:[a("companies_delete.client_code"),":"]})," ",e.jsx("span",{className:"font-mono bg-white px-1 py-0.5 rounded text-xs",children:n.client_code})]}),n.email&&e.jsxs("p",{className:"text-xs text-yellow-600",children:[e.jsxs("span",{className:"font-semibold",children:[a("companies_delete.email"),":"]})," ",n.email]})]}),w&&s.length>0&&e.jsxs("p",{className:"text-xs mt-2 text-yellow-600",children:["ðŸ“‹ ",s.length," ",a("companies_delete.clients_selected")]})]})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:[e.jsx(ue,{className:"w-4 h-4 text-red-500 flex-shrink-0"}),e.jsxs("span",{className:"font-medium",children:[a("companies_delete.type_to_confirm"),":"]})]}),e.jsx("input",{type:"text",value:f,onChange:j=>R(j.target.value.toUpperCase()),placeholder:a("companies_delete.type_placeholder").toUpperCase(),className:"w-full px-3 py-2 border border-red-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 font-mono text-center text-base sm:text-lg font-bold uppercase tracking-wider",disabled:p,autoComplete:"off"}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${f==="DELETE"?"bg-green-500":"bg-red-500"}`}),e.jsx("span",{children:a(f==="DELETE"?"companies_delete.confirmation_matches":"companies_delete.type_exactly")})]})]}),e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-gray-50 rounded-lg border border-gray-200",children:[e.jsx(he,{className:"w-5 h-5 text-gray-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm text-gray-700 font-medium mb-1",children:Q()}),e.jsx("p",{className:"text-xs text-gray-500",children:a("companies_delete.can_be_restored_later")})]})]})]}),e.jsxs("div",{className:"bg-gray-50 px-4 sm:px-6 py-4 border-t flex flex-col sm:flex-row gap-3",children:[e.jsx("button",{type:"button",onClick:S,disabled:p,className:"px-4 py-2.5 text-gray-700 hover:text-gray-900 font-medium disabled:opacity-50 transition-colors rounded-lg order-2 sm:order-1",children:a("companies_delete.cancel")}),e.jsx("button",{type:"button",onClick:X,disabled:p||f!=="DELETE",className:"px-6 py-2.5 font-medium rounded-lg disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 transition-colors order-1 sm:order-2 bg-red-600 hover:bg-red-700 text-white",children:p?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),a("companies_delete.deleting")]}):e.jsxs(e.Fragment,{children:[e.jsx(re,{className:"w-4 h-4"}),a("companies_delete.delete_button")]})})]})]})})]}):e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-auto",children:e.jsxs("div",{className:"p-6 text-center",children:[e.jsx(B,{className:"w-12 h-12 text-yellow-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:a("companies_delete.no_data_selected")}),e.jsx("p",{className:"text-gray-600",children:a("companies_delete.select_client_to_delete")}),e.jsx("button",{onClick:M,className:"mt-4 px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-800 rounded-lg transition-colors",children:a("companies_delete.close")})]})})})},at=()=>{const{companies:v,statistics:M,types:n,filters:m,fromQuotation:w,quotationId:r,clientTypes:s}=ae().props,{t:a}=J();console.log("DEBUG: Props Received:",{companiesCount:v?.data?.length,clientTypesCount:s?.length||n?.length,typesCount:n?.length,companySample:v?.data?.[0]});const[p,d]=i.useState(m.search||""),[f,R]=i.useState(m.client_type_id||""),[q,T]=i.useState(!1),[O,z]=i.useState(!1),[X,$]=i.useState(!1),[S,g]=i.useState(null),[P,Q]=i.useState([]),[N,j]=i.useState(null),[E,K]=i.useState(null),y=i.useRef(null);i.useEffect(()=>{w&&r&&T(!0)},[w,r]),i.useEffect(()=>{const t=o=>{y.current&&!y.current.contains(o.target)&&j(null)};return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[]);const c=i.useCallback(t=>{A.get("/companies",{search:t,client_type_id:f},{preserveState:!0,replace:!0,only:["companies","filters","statistics"]})},[f]),x=i.useCallback(t=>{const o=t===f?"":t;R(o),A.get("/companies",{search:p,client_type_id:o},{preserveState:!0,replace:!0,only:["companies","filters","statistics"]})},[p,f]),_=()=>{d(""),R(""),A.get("/companies",{},{preserveState:!0,replace:!0,only:["companies","filters","statistics"]})},C=()=>{T(!1),A.reload({only:["companies","statistics"],preserveScroll:!0})},I=t=>{console.log("=== EDIT CLICKED ==="),console.log("Original company data:",t),console.log("Lead data:",t.lead),console.log("Primary contact:",t.primary_contact);const o={id:t.id,client_code:t.client_code||"",company_name:t.company_name||t.lead?.company_name||t.client_code||t.name||"",contact_person:t.contact_person||t.primary_contact?.name||t.lead?.contact_person||"",contact_email:t.email||t.primary_contact?.email||t.lead?.email||"",contact_phone:t.phone||t.primary_contact?.phone||t.lead?.phone||"",contact_position:t.contact_position||t.primary_contact?.position||t.lead?.position||"",client_type_id:t.client_type_id||"",city:t.city||"",province:t.province||"",country:t.country||"",postal_code:t.postal_code?.toString()||"",vat_number:t.vat_number?.toString()||"",nib:t.nib||"",website:t.website||"",logo_url:t.logo_url||"",is_active:t.is_active||!1,primary_contact:t.primary_contact,lead:t.lead,name:t.name};console.log("Prepared company data for edit:",o),console.log("Company Name source:",{fromCompanyProp:t.company_name,fromLead:t.lead?.company_name,fromClientCode:t.client_code,finalValue:o.company_name}),g(o),z(!0)},F=t=>{console.log("Delete clicked for:",t.id),g(t),$(!0)},V=t=>{console.log("Update successful:",t),z(!1),g(null),A.reload({only:["companies","statistics"],preserveScroll:!0})},W=async t=>{if(S)try{const o=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content");let h=`/companies/${S.id}`;t==="permanent"&&(h=`/companies/force-delete/${S.id}`);const b=await fetch(h,{method:t==="permanent"?"DELETE":"POST",headers:{"X-CSRF-TOKEN":o,"X-Requested-With":"XMLHttpRequest",Accept:"application/json"}}),D=await b.json();if(!b.ok)throw new Error(D.message||a("companies.delete_failed"));alert(D.message||a("companies.client_deleted_successfully")),$(!1),g(null),A.reload({only:["companies","statistics"],preserveScroll:!0})}catch(o){console.error("Delete error:",o),alert(a("companies.delete_failed_try_again"))}};i.useEffect(()=>{const t=setTimeout(()=>{p!==m.search&&c(p)},500);return()=>clearTimeout(t)},[p]);const L=[{key:"client_name",label:a("companies.table.client_name"),render:(t,o)=>{const h=o.company_name||o.lead?.company_name||o.name||"-";return e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("button",{onClick:b=>{b.stopPropagation(),l(o)},className:"font-medium text-blue-600 hover:text-blue-800 hover:underline flex items-center gap-1 transition-colors",children:[h,e.jsx(ge,{className:"w-3 h-3 opacity-0 group-hover:opacity-100 transition-opacity"})]}),e.jsx("span",{className:"text-xs text-gray-500 mt-1",children:o.client_code})]})}},{key:"address",label:a("companies.table.address"),render:(t,o)=>{const h=o.is_active,b=[o.city,o.province,o.country].filter(Boolean),D=b.length>0?b.join(", "):o.address||"-";return e.jsxs("div",{children:[e.jsx("span",{className:`font-medium ${h?"text-gray-900":"text-gray-500"}`,children:D}),!h&&e.jsx("div",{className:"text-xs text-gray-400 mt-0.5",children:a("companies.inactive")})]})}},{key:"contact_person",label:a("companies.table.contact_person"),render:(t,o)=>e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium text-gray-900",children:t||"-"}),e.jsx("span",{className:"text-xs text-gray-500 font-normal",children:o.contact_position||"-"})]})},{key:"contact_info",label:a("companies.table.contact"),render:(t,o)=>e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-medium text-gray-900",children:o.email||"-"}),e.jsx("span",{className:"text-xs text-gray-500 font-normal",children:o.phone||"-"})]})},{key:"client_type_name",label:a("companies.table.status"),render:t=>e.jsx("span",{className:"font-semibold text-green-700 bg-green-50 rounded px-2 py-1 text-xs",children:t||"-"})},{key:"client_since",label:a("companies.table.client_since"),render:t=>e.jsx("div",{className:"text-sm text-gray-600",children:t?new Date(t).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric"}):"-"})}],te=v.data?.map((t,o)=>{const h=t.company_name||t.lead?.company_name||t.client_code||t.name||"-";return{id:t.id,client_name:h,company_name:h,address:t.address||"-",city:t.city||"",province:t.province||"",country:t.country||"",contact_person:t.contact_person||"-",email:t.email||"-",phone:t.phone||"-",contact_position:t.contact_position||"",client_code:t.client_code||"",client_type_name:t.client_type_name||a("companies.unknown"),client_type_id:t.client_type_id||"",is_active:t.is_active||!1,client_since:t.client_since||"-",created_at:t.created_at||"",postal_code:t.postal_code||"",vat_number:t.vat_number||"",nib:t.nib||"",website:t.website||"",logo_url:t.logo_url||"",primary_contact:t.primary_contact,lead:t.lead,name:t.name}})||[],l=t=>{A.visit(`/companies/${t.id}`)};return e.jsxs(e.Fragment,{children:[e.jsx(le,{title:a("companies.title")}),e.jsxs("div",{className:"px-8 py-6",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row items-start lg:items-center justify-between gap-4 mb-6",children:[e.jsx("div",{children:e.jsx("h1",{className:"text-xl font-black uppercase tracking-widest text-gray-800",children:a("companies.title")})}),w&&r&&e.jsx("div",{className:"w-full sm:w-auto bg-blue-50 border border-blue-200 rounded-lg p-3 mb-2 sm:mb-0",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Y,{className:"w-5 h-5 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium text-blue-900",children:a("companies.from_quotation_notification")})]}),e.jsx("button",{onClick:()=>A.get("/companies"),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:a("companies.skip")})]})}),e.jsx("div",{className:"flex gap-3 w-full sm:w-auto",children:e.jsxs("button",{onClick:()=>T(!0),className:"inline-flex items-center rounded-md border border-transparent px-5 py-2.5 text-sm font-medium font-semibold uppercase tracking-widest text-white transition duration-150 ease-in-out bg-[rgb(17,94,89)] hover:bg-[rgb(13,75,71)] focus:bg-[rgb(13,75,71)] focus:outline-none focus:ring-2 focus:ring-[rgb(17,94,89)] focus:ring-offset-2 active:bg-[rgb(10,60,57)] w-full sm:w-auto flex items-center justify-center gap-2 shadow-sm hover:shadow",children:[e.jsx(_e,{className:"h-5 w-5"}),e.jsx("span",{className:"font-semibold",children:a("companies.add_new_client")})]})})]}),q&&e.jsx(ke,{isOpen:q,onClose:()=>T(!1),clientTypes:n,quotationId:r,onSuccess:C}),O&&S&&e.jsx(Se,{isOpen:O,onClose:()=>{z(!1),g(null)},company:S,clientTypes:s||n,onUpdate:V}),X&&e.jsx(Ee,{isOpen:X,onClose:()=>{$(!1),g(null)},company:S,onDelete:W}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 md:gap-6 my-7",children:M.client_types?.map((t,o)=>{const h=["border-blue-200 bg-blue-100","border-green-200 bg-green-100","border-orange-200 bg-orange-100","border-purple-200 bg-purple-100"],b=h[o%h.length];return e.jsx("div",{className:`rounded-xl p-5 shadow-sm border ${b} transition-transform hover:scale-[1.02] hover:shadow-md min-h-[120px] flex flex-col justify-between`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 uppercase tracking-wide",children:t.name}),e.jsx("p",{className:"text-2xl md:text-3xl font-bold text-gray-900 mt-2",children:t.count})]}),e.jsx("div",{className:"p-3 rounded-full bg-white",children:e.jsx(Z,{className:"w-6 h-6 text-blue-600"})})]})},t.id)})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4 md:p-6 mb-6",children:e.jsx("div",{className:"flex flex-col lg:flex-row items-start lg:items-center justify-between gap-6",children:e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(ne,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",placeholder:a("companies.search_placeholder"),value:p,onChange:t=>d(t.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm transition-all duration-200"})]}),e.jsx("div",{className:"w-full sm:w-auto",children:e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:f,onChange:t=>x(t.target.value),className:"w-full sm:w-64 border border-gray-300 rounded-xl px-4 py-3 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent appearance-none bg-white pr-10",children:[e.jsx("option",{value:"",children:a("companies.all_client_types")}),n.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),e.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-3 text-gray-500",children:e.jsx("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})}),(p||f)&&e.jsxs("button",{onClick:_,className:"px-4 py-3 border border-gray-300 text-gray-700 rounded-xl text-sm font-medium hover:bg-gray-50 transition-colors duration-200 flex items-center gap-2 whitespace-nowrap",children:[e.jsx(G,{className:"h-4 w-4"}),a("companies.clear_filters")]})]}),(p||f)&&e.jsxs("div",{className:"mt-4 flex flex-wrap gap-2",children:[p&&e.jsxs("span",{className:"inline-flex items-center px-3 py-1.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[a("companies.search_label",{search:p}),e.jsx("button",{onClick:()=>d(""),className:"ml-1.5 text-blue-600 hover:text-blue-800",children:"Ã—"})]}),f&&e.jsxs("span",{className:"inline-flex items-center px-3 py-1.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[`${a("companies.type_label")}: ${n.find(t=>t.id===f)?.name||a("companies.selected")}`,e.jsx("button",{onClick:()=>R(""),className:"ml-1.5 text-green-600 hover:text-green-800",children:"Ã—"})]})]})]})})}),e.jsx("div",{className:"py-6",children:e.jsx("div",{className:"overflow-x-auto -mx-4 px-4",children:e.jsx(oe,{columns:L,data:te,onEdit:I,onDelete:F,showAction:!0,pagination:{currentPage:v.current_page||1,totalPages:v.last_page||1,totalItems:v.total||0,itemsPerPage:v.per_page||10,onPageChange:t=>{A.get("/companies",{page:t,search:p,client_type_id:f},{preserveState:!0,replace:!0})}},onRowClick:l})})})]})]})};export{at as default};
